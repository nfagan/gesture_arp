{"version":3,"sources":["webpack:///static/js/app.610535faafd7da876798.js","webpack:///./src/eventbus.js","webpack:///./src/audio/webaudio.js","webpack:///./src/util.js","webpack:///./src/geometry/vertices.js","webpack:///./src/audio/instruments.js","webpack:///./src/audio/constraints.js","webpack:///./src/geometry/shape.js","webpack:///./src/world.js","webpack:///./src/audio/setup.js","webpack:///./src/interface/setup.js","webpack:///./src/router/index.js","webpack:///./src/App.vue?35a7","webpack:///App.vue","webpack:///Arrangement.vue","webpack:///Cell.vue","webpack:///Hello.vue","webpack:///Instrument.vue","webpack:///Sequencer.vue","webpack:///./src/animation/animator.js","webpack:///./src/animation/ease.js","webpack:///./src/audio/sequence.js","webpack:///./src/audio/sequenceset.js","webpack:///./src/audio/sequencesets.js","webpack:///./src/geometry/detector.js","webpack:///./src/interaction.js","webpack:///./src/main.js","webpack:///./src/components/Arrangement.vue?da8a","webpack:///./src/components/Cell.vue?a360","webpack:///./src/components/Hello.vue?2a6f","webpack:///./src/components/Instrument.vue?9454","webpack:///./src/components/Sequencer.vue?24db","webpack:///./src/components/Arrangement.vue?216b","webpack:///./src/components/Hello.vue?e10f","webpack:///./src/components/Cell.vue?d791","webpack:///./src/components/Instrument.vue?0c18","webpack:///./src/App.vue?a3de","webpack:///./src/components/Sequencer.vue?d465"],"names":["webpackJsonp","module","__webpack_exports__","__webpack_require__","EventBus","this","topics","topicMap","modeChange","canvasResize","canvasResizeEnd","newShapeReady","endOfSequence","newSequenceSetCreated","newSequenceCreated","newActiveSequence","newEditedSequence","newActiveSequenceSet","newNoteTimesReady","clearShape","newSurface","deletedColumn","soundsLoaded","d","eventBus","prototype","constructor","subscribe","topic","listener","id","push","method","publish","data","to","Error","length","forEach","WebAudio","properties","bpm","interval","currentBeat","context","initContext","tuna","__WEBPACK_IMPORTED_MODULE_5_tunajs___default","a","impulse","undefined","buffers","filenames","defaultPlayProperties","audible","pitch","min","max","validate","playedDummySound","webAudio","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default","n","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default","__WEBPACK_IMPORTED_MODULE_4__instruments_js__","__WEBPACK_IMPORTED_MODULE_5_tunajs__","audioContext","window","AudioContext","webkitAudioContext","requestAnimationFrame","loadTestSounds","that","map","name","fullfile","request","XMLHttpRequest","open","responseType","onload","decodeAudioData","response","buffer","filename","send","loadImpulse","self","loadSound","then","sound","resolve","reject","onerror","err","loadSounds","promises","file","all","sounds","i","catch","console","log","getBufferByFilename","oneBuffer","filter","getCurrentBeat","totalElapsedTime","currentTime","Math","floor","schedulePlay","props","noteLength","coordinates","scheduledTime","beatsToSchedule","duration","scheduledTimes","sequence","sources","playTime","playProps","when","play","noteTimes","noteDuration","coord","source","createBufferSource","pitchMatrix","constraint","pitchIndex","xModulation","identity","y","x","radius","sign","adjustedY","random","octaveSemitone","semitone","bitcrusher","Bitcrusher","bits","normfreq","bufferSize","convolver","PingPongDelay","wetLevel","feedback","delayTimeLeft","delayTimeRight","playbackRate","value","pow","connect","destination","start","playDummySound","createBuffer","Util","contains","arr","val","unique","newArr","resample","N","factor","ceil","resampled","stp","findMin","ind","minimum","Infinity","findMax","maximum","sum","cumulative","mean","combs","getCombinations","array","size","initialStuff","output","concat","logicalKeep","randId","append","toString","substring","indexOf","Vertices","pts","points","pointsSansAnchor","anchorPoint","firstPoint","hull","area","signedArea","perimeter","centroid","perimeterEfficiency","hullAreaRatio","hullNRatio","addPoints","Point","index","addPoint","addPointsWithIndex","ap","point","pushFirstPoint","removeLastPoint","splice","copyPoints","pt","copyPoint","repPoint","arrayAdd","b","plus","arrayMinus","minus","arrayTimes","times","arrayDivide","divide","_sortPointsByPolarAngle","sort","polarA","_findPolarAngle","polarB","deltaX","deltaY","angle","atan2","reverse","_ccw","p0","p1","p2","cwAngle","ccwAngle","getHull","pointsLength","hullPoints","every","unshift","shift","p","some","updateMost","updatePerimeter","updateArea","updatePerimeterEfficiency","updateCentroid","updateAll","updateHull","updateHullAreaRatio","updateHullNRatio","updateAllExceptHull","getCentroid","getPerimeter","getArea","abs","perim","getPerimeterEfficiency","x1","x2","y1","y2","xsq","ysq","sqrt","PI","xs","ys","Cx","Cy","x0","y0","B","getDistances","dist","getDistance","getPerpendicularDistance","v","w","sqr","dist2","l2","t","getConsecutiveDistances","D","getSlope","getLineEquationY","m","getLineEquationX","getXAlongLineAtY","getYAlongLineAtX","getAngle","p3","p12","p13","p23","A1","A2","A3","acos","isNearVertex","bounds","isNearVertices","M","doesIntersect","copy","Instruments","piano_g.mp3","color","celeste_g.mp3","808_hi.mp3","perc_kick.mp3","key","rgbString","join","matrixMaker","semitones","octaves","reduce","combined","octave","getSequenceConstraints","style","rgb","Shape","vertices","canvas","previousCanvasWidth","previousCanvasHeight","getCenter","Line","Circle","center","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create___default","__WEBPACK_IMPORTED_MODULE_1__util_js__","__WEBPACK_IMPORTED_MODULE_2__vertices_js__","getRescaledVertices","oldWidth","oldHeight","newWidth","newHeight","verts","scaleVecA","scaleVecB","points_","rescale","pwidth","pheight","nwidth","nheight","newVertices","update","centerOn","getVerticesNear","isNearCenter","drawLine","doClear","ctx","getContext","clearRect","width","height","beginPath","moveTo","lineTo","strokeStyle","lineWidth","stroke","drawDots","r","arc","closePath","fillStyle","fill","radiusScale","World","shapes","editedSequenceId","activeSequenceIds","activeSequenceSetId","mode","arrangementCanvases","world","__WEBPACK_IMPORTED_MODULE_0__eventbus_js__","newShapeReadyTopic","newSequenceSetCreatedTopic","newSequenceCreatedTopic","newActiveSequenceTopic","newActiveSequenceSetTopic","modeChangeTopic","canvasResizeTopic","clearShapeTopic","newSurfaceTopic","registerSequenceSet","bind","registerSequence","registerShape","updateActiveSequence","updateActiveSequenceSet","updateMode","updateShapeSizes","handleNewSurface","element","values","type","canvasIndex","getIndexOfSurface","sequenceSetId","canvasObject","sequenceId","shape","updateEditedSequence","findActiveSequenceIdBySequenceSetId","setId","isShapeWithSequenceId","findShapeBySequenceId","updateShapeSize","prevWidth","prevHeight","canvasWidth","canvasHeight","getShapesBySequenceSetId","getShapeBySequenceId","getEditedShape","canvasSet","sequenceSetManager","__WEBPACK_IMPORTED_MODULE_0__audio_webaudio_js__","__WEBPACK_IMPORTED_MODULE_1__eventbus_js__","__WEBPACK_IMPORTED_MODULE_2__audio_sequencesets_js__","set","createSet","j","createSequence","postCanvasRetrieval","animator","__WEBPACK_IMPORTED_MODULE_4__animation_animator_js__","__WEBPACK_IMPORTED_MODULE_3__world_js__","__WEBPACK_IMPORTED_MODULE_5__interaction_js__","handleTouch","sizeCanvas","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default","__WEBPACK_IMPORTED_MODULE_0_vue__","__WEBPACK_IMPORTED_MODULE_1_vue_router__","__WEBPACK_IMPORTED_MODULE_2__components_Hello__","__WEBPACK_IMPORTED_MODULE_2__components_Hello___default","use","routes","path","component","exports","injectStyle","ssrContext","Component","Object","defineProperty","__WEBPACK_IMPORTED_MODULE_0__components_Sequencer__","__WEBPACK_IMPORTED_MODULE_0__components_Sequencer___default","components","Sequencer","methods","soundsAreLoaded","$store","state","__WEBPACK_IMPORTED_MODULE_1__Cell_vue__","__WEBPACK_IMPORTED_MODULE_1__Cell_vue___default","Cell","computed","sequenceSets","getContainerStyle","manager","addExtraHeight","canAddColumn","canDeleteColumn","maxHeight","maxWidth","sequences","createColumn","maxNColumns","commit","createNextColumn","$forceUpdate","deleteColumn","deleteLastColumn","didShowPlus","canAddMoreColumns","shapesExist","allShapesExist","shapeExists","cellClass","className","sequenceExists","switchToSequence","handleClickedSequence","switchToInstrument","mounted","$el","children","msg","__WEBPACK_IMPORTED_MODULE_2__audio_instruments_js__","__WEBPACK_IMPORTED_MODULE_3__audio_constraints_js__","constraints","switchToArrangement","toggleLoop","updateFilename","f","updateConstraint","c","getRgbString","getInstrumentStyle","backgroundColor","getInstrumentClassNames","editedSequence","getConstraintStyle","getConstraintClass","getTransportClass","isLooping","directives","captureCanvas","binding","addEventListener","evt","keyCode","__WEBPACK_IMPORTED_MODULE_0__Instrument__","__WEBPACK_IMPORTED_MODULE_0__Instrument___default","__WEBPACK_IMPORTED_MODULE_1__Arrangement__","__WEBPACK_IMPORTED_MODULE_1__Arrangement___default","Instrument","Arrangement","resizer","el","innerWidth","innerHeight","modeIsInstrument","Animator","activeCanvas","instrumentCanvas","shouldAnimateInstrument","shouldAnimateArrangement","shouldDrawActiveNotes","isRecording","editedVertices","blipIncrement","drawCentroidArrangement","drawCentroidInstrument","ratio","devicePixelRatio","pendingNotes","activeNotes","noteTimeTolerance","__WEBPACK_IMPORTED_MODULE_1__audio_webaudio_js__","__WEBPACK_IMPORTED_MODULE_3__ease_js__","__WEBPACK_IMPORTED_MODULE_3__ease_js___default","newNoteTimesTopic","newEditedSequenceTopic","deletedColumnTopic","handleNewNoteTimes","handleCanvasResize","handleNewEditedSequence","handleDeletedColumn","sequenceIndex","noteTime","coordinate","loopIndex","clearArrangementCanvases","animateArrangement","animateInstrument","drawCircle","dotSize","drawArc","drawRectTriLineRand","linePoints","vertPoints","drawShape","updateActiveNotes","note","getArrangementCanvas","now","Date","currentSize","canvasCenter","canvasSize","outQuad","scale","editedShape","needResize","centerPoint","centerPointSize","expired","expiredRemover","globalAlpha","alpha","rect","getBoundingClientRect","h","clearActiveCanvas","linear","inQuad","inOutQuad","inCube","outCube","inOutCube","inQuart","outQuart","inOutQuart","inQuint","outQuint","inOutQuint","inSine","cos","outSine","sin","inOutSine","inExpo","outExpo","inOutExpo","inCirc","outCirc","inOutCirc","inBack","s","outBack","inOutBack","inBounce","outBounce","inOutBounce","inElastic","asin","outElastic","inOutElastic","Sequence","sequenceSet","__WEBPACK_IMPORTED_MODULE_2__util_js__","shouldLoop","isActive","nBeats","__WEBPACK_IMPORTED_MODULE_3__constraints__","__WEBPACK_IMPORTED_MODULE_0__webaudio_js__","previousWidth","previousHeight","animationFrameId","__WEBPACK_IMPORTED_MODULE_4__geometry_vertices_js__","handleModeChange","stopSources","cancelLoop","cancelAnimationFrame","stop","warn","getPercentageCoordinates","bounder","coords","loop","looper","newNotesReadyTopic","schedule","SequenceSet","hasEditedSequence","editedSequenceIndex","activeSequenceIndex","activeSequenceId","__WEBPACK_IMPORTED_MODULE_3__sequence_js__","topicNextSequence","topicModeChange","topicEditedSequence","nextSequence","changeMode","resetLoopIndices","forceCancelLoop","getNonEditedSequences","seq","forceCancelAllLoops","getLoopingSequences","currentSequence","switchToColumn","shouldResumeLoop","definedSequences","getIndexOfSequenceId","getSequenceIds","ids","getDefinedSequences","getSequenceById","deleteLastSequence","wasLooping","SequenceSets","sequenceSetIndex","__WEBPACK_IMPORTED_MODULE_1__sequenceset_js__","__WEBPACK_IMPORTED_MODULE_2__world_js__","newSequenceSetTopicName","_toggleSequences","sequenceSetIds","currentId","getSequenceSetById","currentSet","sequenceExistsAtIndex","createSequencesAtIndex","store","markActiveSet","markEditedSequence","newActiveSetTopic","getEditedSequence","Detector","criteria","rectangle","axisRatioThreshold","circle","globalThreshold","triangle","line","distanceThreshold","perpDistanceThreshold","estimatedVertices","__WEBPACK_IMPORTED_MODULE_0__vertices_js__","__WEBPACK_IMPORTED_MODULE_1__shape_js__","updateEstimatedVertices","getEstimatedRectVertices","getEstimatedTriangleVertices","getEstimatedCircleVertices","getEstimatedLineVertices","inds","largestSet","A","C","tri","currentArea","topLeftFunc","topRightFunc","btmLeftFunc","btmRightFunc","topLeftPts","topRightPts","btmLeftPts","btmRightPts","nTopLeft","nTopRight","nBtmLeft","nBtmRight","topLeftDistances","topRightDistances","btmLeftDistances","btmRightDistances","topLeftInd","topRightInd","btmLeftInd","btmRightInd","distances","summed","getLikelihoodRect","getSlopeRatio","slopeA","slopeB","slopeAB","rectVertices","topLeftPt","topRightPt","btmLeftPt","btmRightPt","axis1Ratio","axis2Ratio","getLikelihoodCircle","nSamples","nHull","nRatio","realArea","hullArea","areaRatio","getLikelihoodTriangle","triangleVertices","getLikelihoodLine","pDistance","pFirst","pLast","perpDistanceRatios","lastDistance","distanceRatio","perpDistanceRatio","apply","getLikelihoodRandom","isRectangle","estimate","thresh","isCircle","isTriangle","isLine","estimates","perpRatio","distanceThresh","perpDistanceThresh","isRandom","getAdjustedRectVertices","rectPoints","rectVerts","L","midPoint","recombinedVerts","getAdjustedTriangleVertices","triPoints","meanDist","newVerts","getLine","getRectangle","getTriangle","getCircle","getRandom","getDetectedShape","identify","Interaction","__WEBPACK_IMPORTED_MODULE_0__util_js__","__WEBPACK_IMPORTED_MODULE_1__geometry_detector_js__","__WEBPACK_IMPORTED_MODULE_3__geometry_vertices_js__","__WEBPACK_IMPORTED_MODULE_4__eventbus_js__","__WEBPACK_IMPORTED_MODULE_5__audio_webaudio_js__","__WEBPACK_IMPORTED_MODULE_6_interact_js__","__WEBPACK_IMPORTED_MODULE_6_interact_js___default","move","e","preventDefault","position","correctPosition","clientX","clientY","down","shouldContinue","sequenceIdOnDown","sequenceIdCurrent","record","nearbyVertices","publishNewShape","vertex","modifyVertex","modifyCenter","updateCurrentSequenceId","pos","round","left","right","top","bottom","up","handleNewStroke","on","newShapeTopic","detector","__WEBPACK_IMPORTED_MODULE_1_vuex__","__WEBPACK_IMPORTED_MODULE_2__App__","__WEBPACK_IMPORTED_MODULE_2__App___default","__WEBPACK_IMPORTED_MODULE_3__router__","__WEBPACK_IMPORTED_MODULE_7__audio_setup_js__","Store","mutations","switchMode","markSoundsAreLoaded","updateDidShowPlus","updateColumnAdding","updateColumnDelete","updatedEditedSequence","config","productionTip","router","template","App","render","_vm","_h","$createElement","_c","_self","staticClass","click","$event","_e","_v","_l","attrs","staticRenderFns","_s","_m","href","target","class","pattern","rawName","expression"],"mappings":"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","file":"static/js/app.610535faafd7da876798.js","sourcesContent":["webpackJsonp([1],[\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return eventBus; });\n// http://dev.housetrip.com/2014/09/15/decoupling-javascript-apps-using-pub-sub-pattern/\n\nfunction EventBus() {\n\t\tthis.topics = {};\n\t\tthis.topicMap = {\n\t\t\t\tmodeChange: 'modeChange',\n\t\t\t\tcanvasResize: 'canvasResize',\n\t\t\t\tcanvasResizeEnd: 'canvasResizeEnd',\n\t\t\t\tnewShapeReady: 'newShapeReady',\n\t\t\t\tendOfSequence: 'endOfSequence',\n\t\t\t\tnewSequenceSetCreated: 'newSequenceSetCreated',\n\t\t\t\tnewSequenceCreated: 'newSequenceCreated',\n\t\t\t\tnewActiveSequence: 'newActiveSequence',\n\t\t\t\tnewEditedSequence: 'newEditedSequence',\n\t\t\t\tnewActiveSequenceSet: 'newActiveSequenceSet',\n\t\t\t\tnewNoteTimesReady: 'newNoteTimesReady',\n\t\t\t\tclearShape: 'clearShape',\n\t\t\t\tnewSurface: 'newSurface',\n\t\t\t\tdeletedColumn: 'deletedColumn',\n\t\t\t\tsoundsLoaded: 'soundsLoaded'\n\t\t};\n}\n\nEventBus.prototype.constructor = EventBus;\n\nEventBus.prototype.subscribe = function (topic, listener, id) {\n\t\tif (!this.topics[topic]) this.topics[topic] = [];\n\n\t\tthis.topics[topic].push({ method: listener, id: id });\n};\n\nEventBus.prototype.publish = function (topic, data, to) {\n\t\tif (!this.topics[topic]) {\n\t\t\t\tthrow new Error('No ' + topic + ' exists');\n\t\t}\n\t\tif (this.topics.length < 1) return;\n\t\tthis.topics[topic].forEach(function (listener) {\n\t\t\t\tif (typeof to == 'undefined') {\n\t\t\t\t\t\tlistener.method(data || {});\n\t\t\t\t} else {\n\t\t\t\t\t\tif (to === listener.id) {\n\t\t\t\t\t\t\t\tlistener.method(data || {});\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t});\n};\n\nvar eventBus = new EventBus();\n\n\n\n/***/ }),\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return webAudio; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__ = __webpack_require__(66);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__ = __webpack_require__(34);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__util_js__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__instruments_js__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_tunajs__ = __webpack_require__(117);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_tunajs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_tunajs__);\n\n\n\n\n\n\n\n/*\n\tconstructor\n*/\n\nfunction WebAudio(properties) {\n\tthis.bpm = properties.bpm;\n\n\tthis.interval = 60 / this.bpm;\n\n\tthis.currentBeat = 1;\n\n\t//\tinitialize the AudioContext, or return -1\n\t//\tif initialization fails\n\n\tthis.context = this.initContext();\n\n\tthis.tuna = new __WEBPACK_IMPORTED_MODULE_5_tunajs___default.a(this.context);\n\tthis.impulse = undefined;\n\n\t//\tarray of buffer objects with <buffer> and <filename>\n\t//\tproperties\n\n\tthis.buffers = [];\n\tthis.filenames = properties.filenames;\n\n\t//\tdefine default playing properties\n\n\tthis.defaultPlayProperties = {\n\t\taudible: true,\n\t\tpitch: { min: 0, max: 0 }\n\n\t\t//\tmake sure the object was instantiated correctly\n\n\t};this.validate();\n\n\t//\tfor proper safari playback\n\n\tthis.playedDummySound = false;\n}\n\n/*\n\tprototype\n*/\n\nWebAudio.prototype.constructor = WebAudio;\n\n//\tinitialize the audio context, or return -1 if init fails\n\nWebAudio.prototype.initContext = function () {\n\tvar audioContext = window.AudioContext || window.webkitAudioContext || -1;\n\tif (audioContext === -1) return audioContext;\n\treturn new audioContext();\n};\n\n//\tmake sure we can properly instantiate a new WebAudio\n\nWebAudio.prototype.validate = function () {\n\t//\tmake sure we have window.requestAnimationFrame\n\tif (typeof window.requestAnimationFrame == 'undefined') {\n\t\tthrow new Error('requestAnimationFrame is not supported in this browser');\n\t}\n\t//\tmake sure the audio context is valid\n\tif (this.context === -1) {\n\t\tthrow new Error('Web audio is not supported in this browser');\n\t}\n};\n\nWebAudio.prototype.loadTestSounds = function () {\n\tvar filenames = this.filenames,\n\t    that = this,\n\t    buffers = this.buffers;\n\tfilenames.map(function (name) {\n\t\tvar fullfile = 'https://dl.dropboxusercontent.com/s/mt0s5oj4tx1lre2/' + name,\n\t\t    request = new XMLHttpRequest();\n\t\trequest.open('GET', fullfile, true);\n\t\trequest.responseType = 'arraybuffer';\n\t\trequest.onload = function () {\n\t\t\tthat.context.decodeAudioData(request.response, function (buffer) {\n\t\t\t\tbuffers.push({\n\t\t\t\t\tfilename: name,\n\t\t\t\t\tbuffer: buffer\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t\trequest.send();\n\t});\n};\n\nWebAudio.prototype.loadImpulse = function () {\n\tvar self = this;\n\tvar promise = this.loadSound('impulse_rev.wav').then(function (sound) {\n\t\tself.impulse = sound;\n\t});\n};\n\nWebAudio.prototype.loadSound = function (filename) {\n\n\t//\treturn a promise to load the given <filename>\n\n\tvar that = this;\n\n\treturn new __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a(function (resolve, reject) {\n\t\tvar request = new XMLHttpRequest(),\n\t\t    fullfile = '/sounds/' + filename;\n\n\t\trequest.open('GET', fullfile);\n\t\trequest.responseType = 'arraybuffer';\n\n\t\trequest.onload = function () {\n\t\t\tthat.context.decodeAudioData(request.response, function (buffer) {\n\t\t\t\tresolve(buffer);\n\t\t\t});\n\t\t};\n\n\t\trequest.onerror = function (err) {\n\t\t\treject(err);\n\t\t};\n\n\t\trequest.send();\n\t});\n};\n\nWebAudio.prototype.loadSounds = function () {\n\n\t//\tgiven the array of stored filenames in <this>,\n\t//\tresolve each promise to load the corresponding buffer, and\n\t//\tpush each buffer to the <buffers> array in <this>\n\n\tvar promises = [],\n\t    buffers = this.buffers,\n\t    filenames = this.filenames,\n\t    that = this;\n\n\tfilenames.map(function (file) {\n\t\tpromises.push(that.loadSound(file));\n\t});\n\n\tvar promise = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a.all(promises).then(function (sounds) {\n\t\tfor (var i = 0; i < sounds.length; i++) {\n\t\t\tbuffers.push({\n\t\t\t\tfilename: filenames[i],\n\t\t\t\tbuffer: sounds[i]\n\t\t\t});\n\t\t}\n\t}).catch(function (err) {\n\t\tconsole.log('An error occurred while loading sounds');\n\t});\n\n\treturn promise;\n};\n\n//\tfrom the array of buffer objects in this.buffers,\n//\treturn the buffer that matches <filename>\n\nWebAudio.prototype.getBufferByFilename = function (filename) {\n\tvar oneBuffer = this.buffers.filter(function (buffer) {\n\t\treturn buffer.filename === filename;\n\t});\n\tif (oneBuffer.length === 0) return -1;\n\tif (oneBuffer.length > 1) {\n\t\tthrow new Error('More than one buffer found for' + filename);\n\t}\n\treturn oneBuffer[0].buffer;\n};\n\nWebAudio.prototype.getCurrentBeat = function () {\n\tvar totalElapsedTime = this.context.currentTime,\n\t    interval = this.interval;\n\treturn Math.floor(totalElapsedTime / interval);\n};\n\n//\tschedule the playing of N number of notes, where N corresponds\n//\tto the note length specified in <props.noteLength>\n\nWebAudio.prototype.schedulePlay = function (filename, props) {\n\tvar interval = this.interval,\n\t    currentBeat = this.getCurrentBeat(),\n\t    noteLength = props.noteLength,\n\t    coordinates = props.coordinates,\n\t    scheduledTime = void 0,\n\t    beatsToSchedule = void 0,\n\t    duration = void 0,\n\t    scheduledTimes = [];\n\n\tswitch (noteLength) {\n\t\tcase 'quarter':\n\t\t\tbeatsToSchedule = 1;\n\t\t\tbreak;\n\t\tcase 'eighth':\n\t\t\tbeatsToSchedule = 2;\n\t\t\tbreak;\n\t\tcase 'eighthTriplet':\n\t\t\tbeatsToSchedule = 3;\n\t\t\tbreak;\n\t\tcase 'sixteenth':\n\t\t\tbeatsToSchedule = 4;\n\t\t\tbreak;\n\t\tcase 'sixteenthTriplet':\n\t\t\tbeatsToSchedule = 6;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthrow new Error('Unrecognized noteLength ' + noteLength);\n\t}\n\n\t//\tfirst scheduled time\n\n\t// scheduledTime = (currentBeat * interval) + interval/beatsToSchedule;\n\t// scheduledTime = (currentBeat * interval) + interval/6;\n\t// scheduledTime = (currentBeat * interval) + interval/2\n\tscheduledTime = currentBeat * interval + interval / 2;\n\n\t//\tnote length\n\n\tduration = interval / beatsToSchedule;\n\n\t//\tupdate the current beat\n\n\tthis.currentBeat = currentBeat;\n\n\t//\tremove the sources from the sequence\n\n\tprops.sequence.sources = [];\n\n\tfor (var i = 0; i < beatsToSchedule; i++) {\n\t\tvar playTime = scheduledTime + interval / beatsToSchedule * i,\n\t\t    playProps = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default()(props, { when: playTime });\n\n\t\t//\tplay each note at time <playTime>\n\n\t\tthis.play(filename, playProps, coordinates[i]);\n\n\t\t//\tfor output\n\n\t\tscheduledTimes.push(playTime);\n\t}\n\n\treturn { noteTimes: scheduledTimes, noteDuration: duration };\n};\n\nWebAudio.prototype.play = function (filename, props, coord) {\n\tvar source = this.context.createBufferSource(),\n\t    buffer = this.getBufferByFilename(filename),\n\t    defaultPlayProperties = this.defaultPlayProperties,\n\t    when = props.when || 0;\n\n\tif (buffer === -1) throw new Error('Could not find ' + filename);\n\n\tprops = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default()({}, defaultPlayProperties, props);\n\n\tprops.sequence.sources.push(source);\n\n\t//\tif this set of beats is set to be silent, return\n\n\tif (!props.audible) return;\n\n\tvar pitchMatrix = props.sequence.constraint.pitchMatrix,\n\t    pitchIndex = void 0,\n\t    xModulation = void 0;\n\tif (props.identity !== 'circle') {\n\t\tpitchIndex = Math.floor((1 - coord.y) * (pitchMatrix.length - 1));\n\t\txModulation = coord.x;\n\t} else {\n\t\tvar radius = (props.radius[0].x + props.radius[0].y) / 2,\n\t\t    sign = 1,\n\t\t    adjustedY = void 0;\n\t\tif (Math.random() > .5) sign = -1;\n\t\tadjustedY = coord.y + Math.random() * radius * sign;\n\t\tif (adjustedY > 1) adjustedY = 1;\n\t\tif (adjustedY < 0) adjustedY = 0;\n\t\tpitchIndex = Math.floor((1 - adjustedY) * (pitchMatrix.length - 1));\n\t\txModulation = 1 - adjustedY;\n\t}\n\n\tvar octaveSemitone = pitchMatrix[pitchIndex],\n\t    semitone = octaveSemitone[0] * 12 + octaveSemitone[1];\n\n\tvar bitcrusher = props.sequence.bitcrusher || new this.tuna.Bitcrusher({\n\t\tbits: 8,\n\t\tnormfreq: xModulation,\n\t\tbufferSize: 4096\n\t});\n\n\tbitcrusher.normfreq = xModulation * .1 + .1;\n\n\tvar convolver = props.sequence.convolver || new this.tuna.PingPongDelay({\n\t\twetLevel: 0.5, //0 to 1\n\t\tfeedback: 0, //0 to 1\n\t\tdelayTimeLeft: 200, //1 to 10000 (milliseconds)\n\t\tdelayTimeRight: 350 //1 to 10000 (milliseconds)\n\t});\n\n\tconvolver.wetLevel = xModulation;\n\n\tprops.sequence.bitcrusher = bitcrusher;\n\tprops.sequence.convolver = convolver;\n\n\tsource.playbackRate.value = Math.pow(2, semitone / 12);\n\tsource.buffer = buffer;\n\n\tsource.connect(bitcrusher);\n\tbitcrusher.connect(convolver);\n\tconvolver.connect(this.context.destination);\n\tsource.start(when);\n};\n\nWebAudio.prototype.playDummySound = function () {\n\tif (this.playedDummySound) return;\n\n\tvar buffer = this.context.createBuffer(1, 22050, 44100),\n\t    source = this.context.createBufferSource();\n\n\tsource.buffer = buffer;\n\tsource.connect(this.context.destination);\n\tsource.start(0);\n\n\tthis.playedDummySound = true;\n};\n\n/*\n\tinstantiate\n*/\n\nvar filenames = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(__WEBPACK_IMPORTED_MODULE_4__instruments_js__[\"a\" /* default */]);\n\nvar webAudio = new WebAudio({\n\tbpm: 85,\n\tfilenames: filenames\n});\n\n// webAudio.loadSounds();\n// webAudio.loadImpulse();\n\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Util; });\nvar Util = {};\n\nUtil.contains = function (arr, val) {\n\tfor (var i = 0; i < arr.length; i++) {\n\t\tif (arr[i] === val) return true;\n\t}\n\treturn false;\n};\n\nUtil.unique = function (arr) {\n\tvar newArr = [arr[0]];\n\tfor (var i = 1; i < arr.length; i++) {\n\t\tif (this.contains(newArr, arr[i])) continue;\n\t\tnewArr.push(arr[i]);\n\t}\n\treturn newArr;\n};\n\nUtil.resample = function (arr, N) {\n\tif (arr.length <= N) return arr;\n\tvar factor = Math.ceil(arr.length / N),\n\t    resampled = [],\n\t    stp = 0;\n\twhile (stp < arr.length) {\n\t\tresampled.push(arr[stp]);\n\t\tstp += factor;\n\t}\n\treturn resampled;\n};\n\nUtil.findMin = function (arr) {\n\tvar ind = -1,\n\t    minimum = Infinity;\n\tfor (var i = 0; i < arr.length; i++) {\n\t\tif (arr[i] < minimum) {\n\t\t\tind = i;\n\t\t\tminimum = arr[i];\n\t\t}\n\t}\n\treturn ind;\n};\n\nUtil.findMax = function (arr) {\n\tvar ind = -1,\n\t    maximum = -Infinity;\n\tfor (var i = 0; i < arr.length; i++) {\n\t\tif (arr[i] > maximum) {\n\t\t\tind = i;\n\t\t\tmaximum = arr[i];\n\t\t}\n\t}\n\treturn ind;\n};\n\nUtil.sum = function (arr) {\n\tvar cumulative = 0;\n\tfor (var i = 0; i < arr.length; i++) {\n\t\tcumulative += arr[i];\n\t}\n\treturn cumulative;\n};\n\nUtil.mean = function (arr) {\n\treturn this.sum(arr) / arr.length;\n};\n\nUtil.combs = function (arr, N) {\n\tvar output = [];\n\tgetAllPossibleCombinations(arr, N, output);\n\treturn output;\n\tfunction getCombinations(array, size, start, initialStuff, output) {\n\t\tif (initialStuff.length >= size) {\n\t\t\toutput.push(initialStuff);\n\t\t} else {\n\t\t\tvar i;\n\t\t\tfor (i = start; i < array.length; ++i) {\n\t\t\t\tgetCombinations(array, size, i + 1, initialStuff.concat(array[i]), output);\n\t\t\t}\n\t\t}\n\t}\n\tfunction getAllPossibleCombinations(array, size, output) {\n\t\tgetCombinations(array, size, 0, [], output);\n\t}\n};\n\nUtil.logicalKeep = function (arr, ind) {\n\tvar newArr = [];\n\tfor (var i = 0; i < arr.length; i++) {\n\t\tif (!ind[i]) continue;\n\t\tnewArr.push(arr[i]);\n\t}\n\treturn newArr;\n};\n\nUtil.randId = function (append) {\n\tvar id = Math.random().toString(36).substring(7);\n\tif (append == null) return id;\n\treturn append + id;\n};\n\nUtil.indexOf = function (arr, val) {\n\tfor (var i = 0; i < arr.length; i++) {\n\t\tif (arr[i] === val) return i;\n\t}\n\treturn -1;\n};\n\n\n\n/***/ }),\n/* 6 */,\n/* 7 */,\n/* 8 */,\n/* 9 */,\n/* 10 */,\n/* 11 */,\n/* 12 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return Vertices; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Point; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__util_js__ = __webpack_require__(5);\n\n\n/*\n\tVERTICES\n*/\n\nfunction Vertices(pts) {\n\n\tthis.points = [];\n\tthis.pointsSansAnchor = [];\n\tthis.anchorPoint = undefined;\n\tthis.firstPoint = undefined;\n\tthis.hull = undefined;\n\tthis.area = undefined;\n\tthis.signedArea = undefined;\n\tthis.perimeter = undefined;\n\tthis.centroid = undefined;\n\tthis.perimeterEfficiency = undefined;\n\tthis.hullAreaRatio = 0;\n\tthis.hullNRatio = 0;\n\n\tif (pts !== undefined) {\n\t\tthis.addPoints(pts);\n\t}\n}\n\n/*\n\tINIT\n*/\n\nVertices.prototype.constructor = Vertices;\n\nVertices.prototype.addPoints = function (pts) {\n\tfor (var i = 0; i < pts.length; i++) {\n\t\tthis.addPoint(pts[i].x, pts[i].y, i);\n\t}\n};\n\nVertices.prototype.addPointsWithIndex = function (pts) {\n\tfor (var i = 0; i < pts.length; i++) {\n\t\tthis.addPoint(pts[i].x, pts[i].y, pts[i].index);\n\t}\n};\n\nVertices.prototype.addPoint = function (x, y, index) {\n\tvar ap = this.anchorPoint,\n\t    point = new Point(x, y, index);\n\n\tif (ap === undefined) {\n\t\tthis.anchorPoint = point;\n\t\tthis.firstPoint = point;\n\t\tthis.points.push(point);\n\t\treturn;\n\t} else if (ap.y > y && ap.x > x || ap.y === y && ap.x > x || ap.y > y && ap.x === x) {\n\t\tthis.pointsSansAnchor.push(ap);\n\t\tthis.anchorPoint = point;\n\t} else {\n\t\tthis.pointsSansAnchor.push(point);\n\t}\n\tthis.points.push(point);\n\tif (this.firstPoint.index > point.index) {\n\t\tthis.firstPoint = point;\n\t}\n};\n\n/*\n\tUTIL\n*/\n\nVertices.prototype.pushFirstPoint = function () {\n\tthis.points.push(this.points[0]);\n};\n\nVertices.prototype.removeLastPoint = function () {\n\tthis.points.splice(this.points.length - 1, 1);\n};\n\nVertices.prototype.copyPoints = function (arr) {\n\treturn arr.map(function (pt) {\n\t\treturn new Point(pt.x, pt.y, pt.index);\n\t});\n};\n\nVertices.prototype.copyPoint = function (pt) {\n\treturn new Point(pt.x, pt.y, pt.index);\n};\n\nVertices.prototype.repPoint = function (point, N) {\n\tvar points = [];\n\tfor (var i = 0; i < N; i++) {\n\t\tpoints.push(point);\n\t}\n\treturn points;\n};\n\n/*\n\tOPERATIONS\n*/\n\nVertices.prototype.arrayAdd = function (points, b) {\n\tfor (var i = 0; i < points.length; i++) {\n\t\tpoints[i].plus(b);\n\t}\n};\n\nVertices.prototype.arrayMinus = function (points, b) {\n\tfor (var i = 0; i < points.length; i++) {\n\t\tpoints[i].minus(b);\n\t}\n};\n\nVertices.prototype.arrayTimes = function (points, b) {\n\tfor (var i = 0; i < points.length; i++) {\n\t\tpoints[i].times(b);\n\t}\n};\n\nVertices.prototype.arrayDivide = function (points, b) {\n\tfor (var i = 0; i < points.length; i++) {\n\t\tpoints[i].divide(b);\n\t}\n};\n\n/*\n\tCONVEX HULL\n*/\n\nVertices.prototype._sortPointsByPolarAngle = function () {\n\tvar self = this;\n\n\treturn this.pointsSansAnchor.sort(function (a, b) {\n\t\tvar polarA = self._findPolarAngle(self.anchorPoint, a);\n\t\tvar polarB = self._findPolarAngle(self.anchorPoint, b);\n\n\t\tif (polarA < polarB) return -1;\n\t\tif (polarA > polarB) return 1;\n\t\treturn 0;\n\t});\n};\nVertices.prototype._findPolarAngle = function (a, b) {\n\tvar ONE_RADIAN = 57.295779513082;\n\tvar deltaX, deltaY;\n\n\tif (!a || !b) return 0;\n\n\tdeltaX = b.x - a.x;\n\tdeltaY = b.y - a.y;\n\n\tif (deltaX == 0 && deltaY == 0) return 0;\n\n\tvar angle = Math.atan2(deltaY, deltaX) * ONE_RADIAN;\n\n\tif (this.reverse) {\n\t\tif (angle <= 0) {\n\t\t\tangle += 360;\n\t\t}\n\t} else {\n\t\tif (angle >= 0) {\n\t\t\tangle += 360;\n\t\t}\n\t}\n\treturn angle;\n};\nVertices.prototype._ccw = function (p0, p1, p2) {\n\tvar difAngle;\n\tvar cwAngle = this._findPolarAngle(p0, p1);\n\tvar ccwAngle = this._findPolarAngle(p0, p2);\n\n\tif (cwAngle > ccwAngle) {\n\t\tdifAngle = cwAngle - ccwAngle;\n\t\treturn !(difAngle > 180);\n\t} else if (cwAngle < ccwAngle) {\n\t\tdifAngle = ccwAngle - cwAngle;\n\t\treturn difAngle > 180;\n\t}\n\treturn true;\n};\nVertices.prototype.getHull = function () {\n\tvar hullPoints = [],\n\t    points,\n\t    pointsLength;\n\n\tthis.reverse = this.pointsSansAnchor.every(function (point) {\n\t\treturn point.x < 0 && point.y < 0;\n\t});\n\n\tpoints = this._sortPointsByPolarAngle();\n\tpointsLength = points.length;\n\n\tif (pointsLength < 3) {\n\t\tpoints.unshift(this.anchorPoint);\n\t\treturn points;\n\t}\n\n\thullPoints.push(points.shift(), points.shift());\n\n\twhile (true) {\n\t\tvar p0, p1, p2;\n\n\t\thullPoints.push(points.shift());\n\n\t\tp0 = hullPoints[hullPoints.length - 3];\n\t\tp1 = hullPoints[hullPoints.length - 2];\n\t\tp2 = hullPoints[hullPoints.length - 1];\n\n\t\tif (this._ccw(p0, p1, p2)) {\n\t\t\thullPoints.splice(hullPoints.length - 2, 1);\n\t\t}\n\n\t\tif (points.length == 0) {\n\t\t\tif (pointsLength == hullPoints.length) {\n\t\t\t\tvar ap = this.anchorPoint;\n\t\t\t\thullPoints = hullPoints.filter(function (p) {\n\t\t\t\t\treturn !!p;\n\t\t\t\t});\n\t\t\t\tif (!hullPoints.some(function (p) {\n\t\t\t\t\treturn p.x == ap.x && p.y == ap.y;\n\t\t\t\t})) {\n\t\t\t\t\thullPoints.unshift(this.anchorPoint);\n\t\t\t\t}\n\t\t\t\treturn hullPoints;\n\t\t\t}\n\t\t\tpoints = hullPoints;\n\t\t\tpointsLength = points.length;\n\t\t\thullPoints = [];\n\t\t\thullPoints.push(points.shift(), points.shift());\n\t\t}\n\t}\n};\n\n/*\n\tUPDATES\n*/\n\nVertices.prototype.updateMost = function () {\n\tthis.updatePerimeter();\n\tthis.updateArea();\n\tthis.updatePerimeterEfficiency();\n\tthis.updateCentroid();\n};\n\nVertices.prototype.updateAll = function () {\n\tthis.updateMost();\n\tthis.updateHull();\n\tthis.updateHullAreaRatio();\n\tthis.updateHullNRatio();\n};\n\nVertices.prototype.updateAllExceptHull = function () {\n\tthis.updateMost();\n};\n\nVertices.prototype.updateHull = function () {\n\tvar hullPoints = this.getHull(),\n\t    hull = new Vertices();\n\thull.addPointsWithIndex(hullPoints);\n\thull.updateAllExceptHull();\n\thull.hull = hull;\n\tthis.hull = hull;\n};\n\nVertices.prototype.updateCentroid = function () {\n\tif (this.area === undefined) this.updateArea();\n\tthis.pushFirstPoint();\n\tthis.centroid = this.getCentroid(this.points, this.signedArea);\n\tthis.removeLastPoint();\n};\n\nVertices.prototype.updatePerimeter = function () {\n\tthis.pushFirstPoint();\n\tthis.perimeter = this.getPerimeter(this.points);\n\tthis.removeLastPoint();\n};\n\nVertices.prototype.updateArea = function () {\n\tthis.pushFirstPoint();\n\tvar area = this.getArea(this.points);\n\tthis.area = Math.abs(area);\n\tthis.signedArea = area;\n\tthis.removeLastPoint();\n};\n\nVertices.prototype.updatePerimeterEfficiency = function () {\n\tif (this.area === undefined || this.perimeter === undefined) {\n\t\tthis.updateArea();\n\t\tthis.updatePerimeter();\n\t}\n\tvar area = this.area,\n\t    perim = this.perimeter;\n\tthis.perimeterEfficiency = this.getPerimeterEfficiency(area, perim);\n};\n\nVertices.prototype.updateHullAreaRatio = function () {\n\tif (this.area === undefined || this.hull === undefined) return;\n\tthis.hullAreaRatio = this.hull.area / this.area;\n};\n\nVertices.prototype.updateHullNRatio = function () {\n\tif (this.hull === undefined) return;\n\tthis.hullNRatio = this.hull.points.length / this.points.length;\n};\n\n/*\n\tBASIC GEOMETRY\n*/\n\nVertices.prototype.getPerimeter = function (points) {\n\tvar perim = 0,\n\t    x1,\n\t    x2,\n\t    y1,\n\t    y2;\n\tfor (var i = 1; i < points.length; i++) {\n\t\tx1 = points[i - 1].x;\n\t\tx2 = points[i].x;\n\t\ty1 = points[i - 1].y;\n\t\ty2 = points[i].y;\n\t\tvar xsq = Math.pow(x2 - x1, 2),\n\t\t    ysq = Math.pow(y2 - y1, 2);\n\t\tperim += Math.sqrt(xsq + ysq);\n\t}\n\treturn perim;\n};\n\nVertices.prototype.getArea = function (points) {\n\tvar x1,\n\t    y1,\n\t    x2,\n\t    y2,\n\t    sum = 0;\n\tfor (var i = 0; i < points.length - 1; i++) {\n\t\tx1 = points[i].x;\n\t\tx2 = points[i + 1].x;\n\t\ty1 = points[i].y;\n\t\ty2 = points[i + 1].y;\n\t\tsum += x1 * y2 - y1 * x2;\n\t}\n\treturn sum / 2;\n};\n\nVertices.prototype.getPerimeterEfficiency = function (area, perim) {\n\treturn 2 * Math.sqrt(Math.PI * area) / perim;\n};\n\nVertices.prototype.getCentroid = function (points, area) {\n\tif (area === undefined) {\n\t\tarea = getArea(points);\n\t}\n\tvar xs = points.map(function (point) {\n\t\treturn point.x;\n\t}),\n\t    ys = points.map(function (point) {\n\t\treturn point.y;\n\t});\n\n\tvar Cx = 0,\n\t    Cy = 0;\n\n\tfor (var i = 0; i < xs.length - 1; i++) {\n\t\tvar x0 = xs[i],\n\t\t    x1 = xs[i + 1],\n\t\t    y0 = ys[i],\n\t\t    y1 = ys[i + 1],\n\t\t    B = x0 * y1 - x1 * y0;\n\t\tCx += (x0 + x1) * B;\n\t\tCy += (y0 + y1) * B;\n\t}\n\n\tCx /= 6 * area;\n\tCy /= 6 * area;\n\n\treturn new Point(Cx, Cy, 0);\n};\n\nVertices.prototype.getDistances = function (point, points) {\n\tvar dist = [];\n\tfor (var i = 0; i < points.length; i++) {\n\t\tdist.push(this.getDistance(point, points[i]));\n\t}\n\treturn dist;\n};\n\nVertices.prototype.getDistance = function (a, b) {\n\treturn Math.sqrt(Math.pow(b.x - a.x, 2) + Math.pow(b.y - a.y, 2));\n};\n\nVertices.prototype.getPerpendicularDistance = function (p, v, w) {\n\tfunction sqr(x) {\n\t\treturn x * x;\n\t}\n\tfunction dist2(v, w) {\n\t\treturn sqr(v.x - w.x) + sqr(v.y - w.y);\n\t}\n\tfunction distToSegmentSquared(p, v, w) {\n\t\tvar l2 = dist2(v, w);\n\t\tif (l2 == 0) return dist2(p, v);\n\t\tvar t = ((p.x - v.x) * (w.x - v.x) + (p.y - v.y) * (w.y - v.y)) / l2;\n\t\tt = Math.max(0, Math.min(1, t));\n\t\treturn dist2(p, { x: v.x + t * (w.x - v.x),\n\t\t\ty: v.y + t * (w.y - v.y) });\n\t}\n\treturn Math.sqrt(distToSegmentSquared(p, v, w));\n};\n\nVertices.prototype.getConsecutiveDistances = function (points) {\n\tvar D = [],\n\t    a,\n\t    b;\n\tfor (var i = 0; i < points.length - 1; i++) {\n\t\ta = points[i];\n\t\tb = points[i + 1];\n\t\tD.push(this.getDistance(a, b));\n\t}\n\treturn D;\n};\n\nVertices.prototype.getSlope = function (p1, p2) {\n\treturn (p2.y - p1.y) / (p2.x - p1.x);\n};\n\nVertices.prototype.getLineEquationY = function (p1, p2) {\n\tvar m = this.getSlope(p1, p2),\n\t    b = p2.y - m * p2.x,\n\t    func = function func(x) {\n\t\treturn m * x + b;\n\t};\n\treturn func;\n};\n\nVertices.prototype.getLineEquationX = function (p1, p2) {\n\tvar m = this.getSlope(p1, p2),\n\t    b = p2.y - m * p2.x,\n\t    func = function func(y) {\n\t\treturn (y - b) / m;\n\t};\n\treturn func;\n};\n\nVertices.prototype.getXAlongLineAtY = function (y, p1, p2) {\n\tvar func = this.getLineEquationX(p1, p2);\n\treturn func(y);\n};\n\nVertices.prototype.getYAlongLineAtX = function (x, p1, p2) {\n\tvar func = this.getLineEquationY(p1, p2);\n\treturn func(x);\n};\n\nVertices.prototype.getAngle = function (p1, p2, p3) {\n\tvar p12 = this.getDistance(p1, p2),\n\t    p13 = this.getDistance(p1, p3),\n\t    p23 = this.getDistance(p2, p3),\n\t    A1 = Math.pow(p12, 2),\n\t    A2 = Math.pow(p13, 2),\n\t    A3 = Math.pow(p23, 2);\n\treturn Math.acos((A1 + A2 - A3) / (2 * p12 * p13));\n};\n\n/*\n\tCONDITIONS\n*/\n\nVertices.prototype.isNearVertex = function (p1, p2, bounds) {\n\treturn this.getDistance(p1, p2) <= bounds;\n};\n\nVertices.prototype.isNearVertices = function (points, p2, bounds) {\n\tvar M = [];\n\tfor (var i = 0; i < points.length; i++) {\n\t\tM.push(this.isNearVertex(points[i], p2, bounds));\n\t}\n\treturn M;\n};\n\nVertices.prototype.doesIntersect = function (p1, p2, p3, bounds) {\n\tvar m = this.getSlope(p2, p3),\n\t    b = p2.y - m * p2.x,\n\t    y = m * p1.x + b;\n\treturn Math.abs(y - p1.y) <= bounds;\n};\n\n/*\n\tPOINT\n*/\n\nfunction Point(x, y, index) {\n\tthis.x = x;\n\tthis.y = y;\n\tthis.index = index;\n}\n\nPoint.prototype.constructor = Point;\n\nPoint.prototype.copy = function () {\n\treturn new Point(this.x, this.y, this.index);\n};\n\nPoint.prototype.minus = function (b) {\n\tif (b instanceof Point) {\n\t\tthis.x -= b.x;\n\t\tthis.y -= b.y;\n\t} else {\n\t\tthis.x -= b;\n\t\tthis.y -= b;\n\t}\n};\n\nPoint.prototype.plus = function (b) {\n\tif (b instanceof Point) {\n\t\tthis.x += b.x;\n\t\tthis.y += b.y;\n\t} else {\n\t\tthis.x += b;\n\t\tthis.y += b;\n\t}\n};\n\nPoint.prototype.times = function (b) {\n\tif (b instanceof Point) {\n\t\tthis.x *= b.x;\n\t\tthis.y *= b.y;\n\t} else {\n\t\tthis.x *= b;\n\t\tthis.y *= b;\n\t}\n};\n\nPoint.prototype.divide = function (b) {\n\tif (b instanceof Point) {\n\t\tthis.x /= b.x;\n\t\tthis.y /= b.y;\n\t} else {\n\t\tthis.x /= b;\n\t\tthis.y /= b;\n\t}\n};\n\n\n\n/***/ }),\n/* 13 */,\n/* 14 */,\n/* 15 */,\n/* 16 */,\n/* 17 */,\n/* 18 */,\n/* 19 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__);\n\nvar Instruments = {\n\t'piano_g.mp3': {\n\t\tcolor: [255, 0, 255]\n\t},\n\t'celeste_g.mp3': {\n\t\tcolor: [66, 244, 134]\n\t},\n\t'808_hi.mp3': {\n\t\tcolor: [0, 255, 255]\n\t},\n\t'perc_kick.mp3': {\n\t\tcolor: [255, 165, 0]\n\t}\n};\n\nvar keys = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(Instruments);\nkeys.map(function (key) {\n\tvar color = Instruments[key].color,\n\t    rgbString = 'rgb(' + color.join(',') + ')';\n\tInstruments[key].rgbString = rgbString;\n});\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Instruments);\n\n/***/ }),\n/* 20 */,\n/* 21 */,\n/* 22 */,\n/* 23 */,\n/* 24 */,\n/* 25 */,\n/* 26 */,\n/* 27 */,\n/* 28 */,\n/* 29 */,\n/* 30 */,\n/* 31 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return getSequenceConstraints; });\n//\tdefine sequence templates here\n\nvar getSequenceConstraints = function getSequenceConstraints() {\n\tvar semitones = [];\n\tfor (var i = 1; i < 13; i++) {\n\t\tsemitones.push(i);\n\t}\n\treturn [\n\t// {\n\t// \tname: 'major1',\n\t// \tsemitones: [ 0, 7, 9 ],\n\t// \toctaves: [ -2, -1, 0, 1, 2 ],\n\t// \tstyle: 'random',\n\t// \tcolor: 'blue',\n\t// \trgb: [ 255, 40, 255 ]\n\t// },\n\t{\n\t\tname: 'minor1',\n\t\tsemitones: [2, 5, 10],\n\t\toctaves: [-2, -1, 0, 1, 2],\n\t\tstyle: 'random',\n\t\tcolor: 'red',\n\t\trgb: [255, 255, 200]\n\t}, {\n\t\tname: 'minor2',\n\t\tsemitones: [3, 7],\n\t\toctaves: [-2, -1, 0, 1, 2],\n\t\tstyle: 'random',\n\t\tcolor: 'green',\n\t\trgb: [255, 200, 255]\n\t}, {\n\t\tname: 'minor3',\n\t\tsemitones: [3, 5, 7, 9, 10],\n\t\toctaves: [-2, -1, 0, 1, 2],\n\t\tstyle: 'random',\n\t\tcolor: 'blue',\n\t\trgb: [255, 200, 255]\n\t}, {\n\t\tname: 'full',\n\t\tsemitones: semitones,\n\t\toctaves: [-2, -1, 0, 1, 2],\n\t\tstyle: 'random',\n\t\tcolor: 'black',\n\t\trgb: [255, 40, 255]\n\n\t}].map(function (sequence) {\n\t\tsequence.pitchMatrix = matrixMaker(sequence);\n\t\treturn sequence;\n\t});\n};\n\n//\tcombine into a matrix of [octave, semitone] pairs\n\nfunction matrixMaker(sequence) {\n\tvar semitones = sequence.semitones,\n\t    octaves = sequence.octaves;\n\n\treturn octaves.reduce(function (combined, octave) {\n\t\tfor (var i = 0; i < semitones.length; i++) {\n\t\t\tcombined.push([octave, semitones[i]]);\n\t\t}\n\t\treturn combined;\n\t}, []);\n}\n\n\n\n/***/ }),\n/* 32 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return Shape; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Line; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return Circle; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create__ = __webpack_require__(67);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__util_js__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__vertices_js__ = __webpack_require__(12);\n\n\n\n\n/*\n\tSHAPE -- Rectangle, Triangle, Random ...\n*/\n\nfunction Shape(vertices, identity) {\n\tthis.vertices = vertices;\n\tthis.points = vertices.points;\n\tthis.identity = identity;\n\tthis.canvas = undefined;\n\tthis.previousCanvasWidth = undefined;\n\tthis.previousCanvasHeight = undefined;\n\tthis.getCenter();\n}\n\nShape.prototype.constructor = Shape;\n\nShape.prototype.getRescaledVertices = function (oldWidth, oldHeight, newWidth, newHeight) {\n\tif (oldWidth === newWidth && oldHeight === newHeight) return;\n\tvar verts = this.vertices,\n\t    scaleVecA = new __WEBPACK_IMPORTED_MODULE_2__vertices_js__[\"a\" /* Point */](oldWidth, oldHeight, 0),\n\t    scaleVecB = new __WEBPACK_IMPORTED_MODULE_2__vertices_js__[\"a\" /* Point */](newWidth / oldWidth, newHeight / oldHeight, 0),\n\t    center = void 0,\n\t    points_ = void 0;\n\tif (this.points.length > 1) {\n\t\tcenter = verts.copyPoint(this.center);\n\t} else {\n\t\tcenter = this.points[0];\n\t}\n\n\tcenter.divide(scaleVecA);\n\tcenter.times(new __WEBPACK_IMPORTED_MODULE_2__vertices_js__[\"a\" /* Point */](newWidth, newHeight, 0));\n\n\tif (this.points.length > 1) {\n\t\tpoints_ = verts.copyPoints(this.points);\n\t\tverts.arrayMinus(points_, this.center);\n\t\tverts.arrayTimes(points_, scaleVecB);\n\t\tverts.arrayAdd(points_, center);\n\t} else {\n\t\tpoints_ = [center];\n\t}\n\n\treturn new __WEBPACK_IMPORTED_MODULE_2__vertices_js__[\"b\" /* Vertices */](points_);\n};\n\nShape.prototype.rescale = function (pwidth, pheight, nwidth, nheight) {\n\tvar newVertices = this.getRescaledVertices(pwidth, pheight, nwidth, nheight);\n\tthis.vertices = newVertices;\n\tthis.points = newVertices.points;\n\tthis.update();\n};\n\nShape.prototype.update = function () {\n\tthis.vertices.updateAllExceptHull();\n\tthis.getCenter();\n};\n\nShape.prototype.getCenter = function () {\n\tthis.center = this.vertices.centroid;\n};\n\nShape.prototype.centerOn = function (pt) {\n\tpt.minus(this.center);\n\tthis.vertices.arrayAdd(this.points, pt);\n\tthis.update();\n};\n\nShape.prototype.isNearVertices = function (coord, bounds) {\n\treturn this.vertices.isNearVertices(this.points, coord, bounds);\n};\n\nShape.prototype.getVerticesNear = function (coord, bounds) {\n\tvar index = this.isNearVertices(coord, bounds);\n\treturn __WEBPACK_IMPORTED_MODULE_1__util_js__[\"a\" /* Util */].logicalKeep(this.points, index);\n};\n\nShape.prototype.isNearCenter = function (coord, bounds) {\n\treturn this.vertices.isNearVertices([this.center], coord, bounds)[0];\n};\n\n/*\n\tDISPLAY\n*/\n\nShape.prototype.drawLine = function (canvas, doClear) {\n\tif (typeof doClear == 'undefined') doClear = true;\n\tvar ctx = canvas.getContext('2d'),\n\t    points = this.vertices.copyPoints(this.points);\n\tpoints.push(points[0]);\n\tif (doClear) ctx.clearRect(0, 0, canvas.width, canvas.height);\n\tfor (var i = 0; i < points.length - 1; i++) {\n\t\tctx.beginPath();\n\t\tctx.moveTo(points[i].x, points[i].y);\n\t\tctx.lineTo(points[i + 1].x, points[i + 1].y);\n\t\t// ctx.moveTo(points[i].x*canvas.width/2, points[i].y*canvas.height/2);\n\t\t// ctx.lineTo(points[i+1].x*canvas.width/2, points[i+1].y*canvas.height/2);\n\t\tctx.strokeStyle = 'gray';\n\t\tctx.lineWidth = 5;\n\t\tctx.stroke();\n\t}\n};\n\nShape.prototype.drawDots = function (canvas, width, doClear) {\n\tif (typeof doClear == 'undefined') doClear = true;\n\tvar ctx = canvas.getContext('2d'),\n\t    points = this.vertices.copyPoints(this.points);\n\tpoints.push(this.center);\n\tif (doClear) ctx.clearRect(0, 0, canvas.width, canvas.height);\n\tvar canvasWidth = canvas.width / 2,\n\t    canvasHeight = canvas.height / 2;\n\tfor (var i = 0; i < points.length; i++) {\n\t\t// var x = points[i].x - width/2;\n\t\t// var y = points[i].y - width/2;\n\t\t// ctx.fillRect(x, y, width, width);\n\t\tvar x = points[i].x,\n\t\t    y = points[i].y,\n\t\t    r = width / 2;\n\t\tctx.beginPath();\n\t\tctx.arc(x, y, r, 0, Math.PI * 2);\n\t\tctx.closePath();\n\t\tctx.fillStyle = 'gray';\n\t\tctx.fill();\n\t}\n};\n\n/*\n\tLINE\n*/\n\nfunction Line(vertices) {\n\tvar N = vertices.points.length - 1;\n\tthis.vertices = vertices;\n\tthis.points = [vertices.points[0], vertices.points[N]];\n\tthis.identity = 'line';\n\tthis.getCenter();\n}\n\nLine.prototype = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create___default()(Shape.prototype);\n\nLine.prototype.constructor = Line;\n\nLine.prototype.getCenter = function () {\n\tvar points = this.points,\n\t    verts = this.vertices,\n\t    x = (points[1].x - points[0].x) / 2 + points[0].x,\n\t    y = verts.getYAlongLineAtX(x, points[0], points[1]);\n\tthis.center = new __WEBPACK_IMPORTED_MODULE_2__vertices_js__[\"a\" /* Point */](x, y, 0);\n};\n\nLine.prototype.rescale = function (pwidth, pheight, nwidth, nheight) {\n\tvar newVertices = this.getRescaledVertices(pwidth, pheight, nwidth, nheight),\n\t    N = newVertices.points.length - 1;\n\tthis.vertices = newVertices;\n\tthis.points = [newVertices.points[0], newVertices.points[N]];\n\tthis.update();\n};\n\n/*\n\tCIRCLE\n*/\n\nfunction Circle(vertices, center, radius) {\n\tthis.vertices = vertices;\n\tthis.center = center;\n\tthis.radius = radius;\n\tthis.points = [center];\n\tthis.identity = 'circle';\n}\n\nCircle.prototype = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create___default()(Shape.prototype);\n\nCircle.prototype.constructor = Circle;\n\nCircle.prototype.rescale = function (oldWidth, oldHeight, newWidth, newHeight) {\n\tif (oldWidth === newWidth && oldHeight === newHeight) return;\n\tvar verts = this.vertices,\n\t    scaleVecA = new __WEBPACK_IMPORTED_MODULE_2__vertices_js__[\"a\" /* Point */](oldWidth, oldHeight, 0),\n\t    scaleVecB = new __WEBPACK_IMPORTED_MODULE_2__vertices_js__[\"a\" /* Point */](newWidth / oldWidth, newHeight / oldHeight, 0),\n\t    center = this.center,\n\t    radiusScale = (newWidth / oldWidth + newHeight / oldHeight) / 2;\n\n\tcenter.divide(scaleVecA);\n\tcenter.times(new __WEBPACK_IMPORTED_MODULE_2__vertices_js__[\"a\" /* Point */](newWidth, newHeight, 0));\n\tthis.radius *= radiusScale;\n};\n\nCircle.prototype.update = function () {\n\tthis.vertices.updateAllExceptHull();\n};\n\nCircle.prototype.drawLine = function (canvas, doClear) {\n\tif (typeof doClear == 'undefined') doClear = true;\n\tvar ctx = canvas.getContext('2d'),\n\t    point = this.points[0],\n\t    r = this.radius;\n\tif (doClear) ctx.clearRect(0, 0, canvas.width, canvas.height);\n\tctx.beginPath();\n\tctx.arc(point.x, point.y, r, 0, Math.PI * 2);\n\tctx.strokeStyle = 'gray';\n\tctx.lineWidth = 5;\n\tctx.stroke();\n};\n\n\n\n/***/ }),\n/* 33 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return world; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__eventbus_js__ = __webpack_require__(0);\n\n\nfunction World() {\n\tthis.shapes = [];\n\tthis.subscribe();\n\tthis.editedSequenceId = undefined;\n\tthis.activeSequenceIds = [];\n\tthis.activeSequenceSetId = undefined;\n\tthis.mode = undefined;\n\tthis.canvas = undefined;\n\tthis.arrangementCanvases = [];\n}\n\nWorld.prototype.constructor = World;\n\nWorld.prototype.subscribe = function () {\n\tvar newShapeReadyTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newShapeReady,\n\t    newSequenceSetCreatedTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newSequenceSetCreated,\n\t    newSequenceCreatedTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newSequenceCreated,\n\t    newActiveSequenceTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newActiveSequence,\n\t    newActiveSequenceSetTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newActiveSequenceSet,\n\t    modeChangeTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.modeChange,\n\t    canvasResizeTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.canvasResize,\n\t    clearShapeTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.clearShape,\n\t    newSurfaceTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newSurface;\n\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(newSequenceSetCreatedTopic, this.registerSequenceSet.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(newSequenceCreatedTopic, this.registerSequence.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(newShapeReadyTopic, this.registerShape.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(newActiveSequenceTopic, this.updateActiveSequence.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(newActiveSequenceSetTopic, this.updateActiveSequenceSet.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(modeChangeTopic, this.updateMode.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(canvasResizeTopic, this.updateShapeSizes.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(clearShapeTopic, this.clearShape.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(newSurfaceTopic, this.handleNewSurface.bind(this));\n};\n\nWorld.prototype.handleNewSurface = function (data) {\n\tvar element = data.element,\n\t    values = data.values,\n\t    type = values.type;\n\tif (type === 'INSTRUMENT') {\n\t\tthis.canvas = element;\n\t\treturn;\n\t}\n\tvar canvasIndex = this.getIndexOfSurface(values.index, values.sequenceSetId),\n\t    canvasObject = {\n\t\tindex: values.index,\n\t\tsequenceSetId: values.sequenceSetId,\n\t\tcanvas: element\n\t};\n\tif (canvasIndex === -1) {\n\t\tthis.arrangementCanvases.push(canvasObject);\n\t} else {\n\t\tthis.arrangementCanvases[canvasIndex].canvas = element;\n\t}\n};\n\nWorld.prototype.updateMode = function (data) {\n\tthis.mode = data;\n};\n\nWorld.prototype.clearShape = function (data) {\n\tvar newShapeReadyTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newShapeReady,\n\t    sequenceId = this.editedSequenceId,\n\t    sequenceSetId = this.activeSequenceSetId;\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].publish(newShapeReadyTopic, {\n\t\tshape: undefined,\n\t\tsequenceId: sequenceId,\n\t\tsequenceSetId: sequenceSetId\n\t});\n};\n\nWorld.prototype.updateEditedSequence = function () {\n\tvar index = this.findActiveSequenceIdBySequenceSetId(this.activeSequenceSetId);\n\tthis.editedSequenceId = this.activeSequenceIds[index].sequenceId;\n};\n\nWorld.prototype.updateActiveSequence = function (data) {\n\tvar sequenceSetId = data.sequenceSetId,\n\t    setId = data.sequenceId,\n\t    index = this.findActiveSequenceIdBySequenceSetId(sequenceSetId);\n\tthis.activeSequenceIds[index].sequenceId = setId;\n\tthis.updateEditedSequence();\n};\n\nWorld.prototype.updateActiveSequenceSet = function (data) {\n\tthis.activeSequenceSetId = data.sequenceSetId;\n\tthis.updateEditedSequence();\n};\n\nWorld.prototype.registerSequenceSet = function (data) {\n\tthis.activeSequenceIds.push({\n\t\tsequenceSetId: data.sequenceSetId,\n\t\tsequenceId: undefined\n\t});\n};\n\nWorld.prototype.registerSequence = function (data) {\n\tdata.shape = undefined;\n\tthis.registerShape(data);\n};\n\nWorld.prototype.registerShape = function (data) {\n\tvar shape = data.shape,\n\t    sequenceId = data.sequenceId,\n\t    sequenceSetId = data.sequenceSetId;\n\tif (this.isShapeWithSequenceId(sequenceId)) {\n\t\tvar ind = this.findShapeBySequenceId(sequenceId);\n\t\tthis.shapes[ind].shape = shape;\n\t} else {\n\t\tthis.shapes.push({\n\t\t\tshape: shape,\n\t\t\tsequenceId: sequenceId,\n\t\t\tsequenceSetId: sequenceSetId\n\t\t});\n\t}\n};\n\nWorld.prototype.updateShapeSize = function (shape, newWidth, newHeight) {\n\tvar prevWidth = shape.previousCanvasWidth,\n\t    prevHeight = shape.previousCanvasHeight;\n\tif (prevWidth === undefined) {\n\t\tshape.previousCanvasWidth = newWidth, shape.previousCanvasHeight = newHeight;\n\t\treturn;\n\t} else if (shape === undefined || newWidth === prevWidth && newHeight === prevHeight) {\n\t\treturn;\n\t}\n\tif (this.mode === 'ARRANGEMENT') return;\n\tif (newWidth === 0 && newHeight === 0) return;\n\tshape.rescale(prevWidth, prevHeight, newWidth, newHeight);\n\tshape.previousCanvasWidth = newWidth;\n\tshape.previousCanvasHeight = newHeight;\n};\n\nWorld.prototype.updateShapeSizes = function (data) {\n\tfor (var i = 0; i < this.shapes.length; i++) {\n\t\tvar shape = this.shapes[i].shape;\n\t\tif (shape === undefined) continue;\n\t\tthis.updateShapeSize(shape, data.canvasWidth, data.canvasHeight);\n\t}\n};\n\nWorld.prototype.findActiveSequenceIdBySequenceSetId = function (id) {\n\tfor (var i = 0; i < this.activeSequenceIds.length; i++) {\n\t\tif (this.activeSequenceIds[i].sequenceSetId === id) return i;\n\t}\n\treturn -1;\n};\n\nWorld.prototype.getShapesBySequenceSetId = function (id) {\n\treturn this.shapes.filter(function (shape) {\n\t\treturn shape.sequenceSetId === id;\n\t}).shape;\n};\n\nWorld.prototype.getShapeBySequenceId = function (id) {\n\tvar ind = this.findShapeBySequenceId(id);\n\tif (ind === -1) return undefined;\n\treturn this.shapes[ind].shape;\n};\n\nWorld.prototype.getEditedShape = function () {\n\treturn this.getShapeBySequenceId(this.editedSequenceId);\n};\n\nWorld.prototype.findShapeBySequenceId = function (id) {\n\tfor (var i = 0; i < this.shapes.length; i++) {\n\t\tif (this.shapes[i].sequenceId === id) return i;\n\t}\n\treturn -1;\n};\n\nWorld.prototype.isShapeWithSequenceId = function (id) {\n\treturn this.findShapeBySequenceId(id) !== -1;\n};\n\nWorld.prototype.getIndexOfSurface = function (index, setId) {\n\tfor (var i = 0; i < this.arrangementCanvases.length; i++) {\n\t\tvar canvasSet = this.arrangementCanvases[i];\n\t\tif (canvasSet.index === index && canvasSet.sequenceSetId === setId) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n};\n\nvar world = new World();\n\n\n\n/***/ }),\n/* 34 */,\n/* 35 */,\n/* 36 */,\n/* 37 */,\n/* 38 */,\n/* 39 */,\n/* 40 */,\n/* 41 */,\n/* 42 */,\n/* 43 */,\n/* 44 */,\n/* 45 */,\n/* 46 */,\n/* 47 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return sequenceSetManager; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__audio_webaudio_js__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__eventbus_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__audio_sequencesets_js__ = __webpack_require__(62);\n\n\n\n\nvar sequenceSetManager = new __WEBPACK_IMPORTED_MODULE_2__audio_sequencesets_js__[\"a\" /* SequenceSets */](),\n    NSETS = 4,\n    NSEQUENCES = 1,\n    filenames = __WEBPACK_IMPORTED_MODULE_0__audio_webaudio_js__[\"a\" /* webAudio */].filenames;\n\nfor (var i = 0; i < NSETS; i++) {\n\tvar set = sequenceSetManager.createSet(filenames[i]),\n\t    topic = __WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].topicMap.newActiveSequenceSet;\n\t__WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].publish(topic, { sequenceSetId: set.id });\n\tfor (var j = 0; j < NSEQUENCES; j++) {\n\t\tset.createSequence(set.filename, j);\n\t}\n}\n\n\n\n/***/ }),\n/* 48 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise__ = __webpack_require__(34);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__eventbus_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__audio_webaudio_js__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__world_js__ = __webpack_require__(33);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__animation_animator_js__ = __webpack_require__(58);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__interaction_js__ = __webpack_require__(64);\n\n\n\n\n\n\n\nvar awaitCanvas = new __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default.a(function (resolve, reject) {\n\t__WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].subscribe('newSurface', function (data) {\n\t\tresolve(data);\n\t});\n});\n\nawaitCanvas.then(postCanvasRetrieval);\n\nfunction postCanvasRetrieval(data) {\n\tvar canvas = data.element,\n\t    animator = new __WEBPACK_IMPORTED_MODULE_4__animation_animator_js__[\"a\" /* Animator */](__WEBPACK_IMPORTED_MODULE_3__world_js__[\"a\" /* world */], canvas),\n\t    interaction = new __WEBPACK_IMPORTED_MODULE_5__interaction_js__[\"a\" /* Interaction */](__WEBPACK_IMPORTED_MODULE_3__world_js__[\"a\" /* world */], animator);\n\n\tinteraction.handleTouch();\n\tanimator.sizeCanvas();\n}\n\n/***/ }),\n/* 49 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vue_router__ = __webpack_require__(129);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__components_Hello__ = __webpack_require__(120);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__components_Hello___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__components_Hello__);\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */].use(__WEBPACK_IMPORTED_MODULE_1_vue_router__[\"a\" /* default */]);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (new __WEBPACK_IMPORTED_MODULE_1_vue_router__[\"a\" /* default */]({\n  routes: [{\n    path: '/',\n    name: 'Hello',\n    component: __WEBPACK_IMPORTED_MODULE_2__components_Hello___default.a\n  }]\n}));\n\n/***/ }),\n/* 50 */\n/***/ (function(module, exports, __webpack_require__) {\n\nfunction injectStyle (ssrContext) {\n  __webpack_require__(114)\n}\nvar Component = __webpack_require__(8)(\n  /* script */\n  __webpack_require__(52),\n  /* template */\n  __webpack_require__(127),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  null,\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 51 */,\n/* 52 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__components_Sequencer__ = __webpack_require__(122);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__components_Sequencer___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__components_Sequencer__);\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n\tname: 'app',\n\tcomponents: { Sequencer: __WEBPACK_IMPORTED_MODULE_0__components_Sequencer___default.a },\n\tmethods: {\n\t\tsoundsAreLoaded: function soundsAreLoaded() {\n\t\t\treturn this.$store.state.soundsAreLoaded;\n\t\t}\n\t}\n});\n\n/***/ }),\n/* 53 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__eventbus_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Cell_vue__ = __webpack_require__(119);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Cell_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__Cell_vue__);\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n\tname: 'arrangement',\n\tcomponents: { Cell: __WEBPACK_IMPORTED_MODULE_1__Cell_vue___default.a },\n\tcomputed: {\n\t\tsequenceSets: function sequenceSets() {\n\t\t\treturn this.$store.state.sequenceSetManager.sequenceSets;\n\t\t}\n\t},\n\tmethods: {\n\t\tgetContainerStyle: function getContainerStyle() {\n\t\t\tvar manager = this.$store.state.sequenceSetManager,\n\t\t\t    addExtraHeight = this.canAddColumn() || this.canDeleteColumn(),\n\t\t\t    maxHeight = manager.sequenceSets.length * 50;\n\t\t\tif (addExtraHeight) maxHeight += 50;\n\t\t\tmaxHeight = maxHeight.toString() + 'px';\n\t\t\tvar maxWidth = manager.sequenceSets[0].sequences.length * 50 + 'px';\n\t\t\treturn {\n\t\t\t\tmaxWidth: maxWidth,\n\t\t\t\tmaxHeight: maxHeight\n\t\t\t};\n\t\t},\n\t\tcreateColumn: function createColumn() {\n\t\t\tvar manager = this.$store.state.sequenceSetManager,\n\t\t\t    nColumns = manager.sequenceSets[0].sequences.length,\n\t\t\t    maxNColumns = manager.maxNColumns;\n\t\t\tif (nColumns === maxNColumns - 1) {\n\t\t\t\tthis.$store.commit('updateColumnAdding', false);\n\t\t\t}\n\t\t\tmanager.createNextColumn();\n\t\t\tthis.$forceUpdate();\n\t\t},\n\t\tdeleteColumn: function deleteColumn() {\n\t\t\tvar manager = this.$store.state.sequenceSetManager,\n\t\t\t    nColumns = manager.sequenceSets[0].sequences.length;\n\t\t\tif (nColumns === 1) {\n\t\t\t\tthis.$store.commit('updateColumnDelete', false);\n\t\t\t} else {\n\t\t\t\tmanager.deleteLastColumn();\n\t\t\t}\n\t\t\tthis.$forceUpdate();\n\t\t},\n\t\tcanAddColumn: function canAddColumn() {\n\t\t\tvar manager = this.$store.state.sequenceSetManager,\n\t\t\t    didShowPlus = this.$store.state.didShowPlus,\n\t\t\t    canAddColumn = manager.canAddMoreColumns(),\n\t\t\t    shapesExist = manager.allShapesExist(0);\n\n\t\t\tif (!canAddColumn) return false;\n\t\t\tif (!didShowPlus && !shapesExist) return false;\n\t\t\tif (!didShowPlus && shapesExist) {\n\t\t\t\tthis.$store.commit('updateDidShowPlus', true);\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tcanDeleteColumn: function canDeleteColumn() {\n\t\t\tvar manager = this.$store.state.sequenceSetManager;\n\t\t\treturn manager.sequenceSets[0].sequences.length > 1;\n\t\t}\n\t}\n});\n\n/***/ }),\n/* 54 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__eventbus_js__ = __webpack_require__(0);\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n\tname: 'cell',\n\tprops: ['index', 'sequenceSetId', 'sequenceId'],\n\tdata: function data() {\n\t\treturn {\n\t\t\tshapeExists: false\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tcellClass: function cellClass() {\n\t\t\tvar className = 'circle';\n\t\t\tif (this.shapeExists) {\n\t\t\t\tclassName += ' circle--active';\n\t\t\t}\n\t\t\treturn className;\n\t\t}\n\t},\n\tmethods: {\n\t\tsequenceExists: function sequenceExists() {\n\t\t\tvar manager = this.$store.state.sequenceSetManager;\n\t\t\treturn manager.sequenceExists(this.sequenceSetId, this.index);\n\t\t},\n\t\tshapeExists: function shapeExists() {\n\t\t\tvar manager = this.$store.state.sequenceSetManager;\n\t\t\treturn manager.shapeExists(this.sequenceSetId, this.index);\n\t\t},\n\t\tswitchToSequence: function switchToSequence() {\n\t\t\tvar manager = this.$store.state.sequenceSetManager;\n\t\t\tmanager.handleClickedSequence(this.sequenceSetId, this.index, this.$store);\n\t\t\tthis.switchToInstrument();\n\t\t},\n\t\tswitchToInstrument: function switchToInstrument() {\n\t\t\tthis.$store.commit('switchMode', 'INSTRUMENT');\n\t\t}\n\t},\n\tmounted: function mounted() {\n\t\tvar canvas = this.$el.children[0].children[0],\n\t\t    topic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newSurface,\n\t\t    index = this.index,\n\t\t    sequenceSetId = this.sequenceSetId,\n\t\t    self = this;\n\t\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].publish(topic, {\n\t\t\telement: canvas,\n\t\t\tvalues: {\n\t\t\t\ttype: 'ARRANGEMENT',\n\t\t\t\tindex: index,\n\t\t\t\tsequenceSetId: sequenceSetId\n\t\t\t}\n\t\t});\n\t\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newShapeReady, function (data) {\n\t\t\tif (data.sequenceId !== self.sequenceId) return;\n\t\t\tif (data.shape === undefined) {\n\t\t\t\tself.shapeExists = false;\n\t\t\t} else {\n\t\t\t\tself.shapeExists = true;\n\t\t\t}\n\t\t});\n\t}\n});\n\n/***/ }),\n/* 55 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  name: 'hello',\n  data: function data() {\n    return {\n      msg: 'Welcome to Your Vue.js App'\n    };\n  }\n});\n\n/***/ }),\n/* 56 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__eventbus_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__audio_instruments_js__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__audio_constraints_js__ = __webpack_require__(31);\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n\n\nvar filenames = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(__WEBPACK_IMPORTED_MODULE_2__audio_instruments_js__[\"a\" /* default */]),\n    constraints = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__audio_constraints_js__[\"a\" /* getSequenceConstraints */])();\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n\tname: 'instrument',\n\tdata: function data() {\n\t\treturn {\n\t\t\tfilenames: filenames,\n\t\t\tconstraints: constraints\n\t\t};\n\t},\n\n\tmethods: {\n\t\tswitchToArrangement: function switchToArrangement() {\n\t\t\tthis.$store.commit('switchMode', 'ARRANGEMENT');\n\t\t\tvar manager = this.$store.state.sequenceSetManager,\n\t\t\t    canAddMore = manager.canAddMoreColumns();\n\t\t\tif (canAddMore && manager.allShapesExist(0)) {\n\t\t\t\tthis.$store.commit('updateColumnAdding', true);\n\t\t\t}\n\t\t},\n\t\tclearShape: function clearShape() {\n\t\t\tvar clearShapeTopic = __WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].topicMap.clearShape;\n\t\t\t__WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].publish(clearShapeTopic, {});\n\t\t},\n\t\ttoggleLoop: function toggleLoop() {\n\t\t\tthis.$store.state.sequenceSetManager.toggleLoop();\n\t\t},\n\t\tupdateFilename: function updateFilename(f) {\n\t\t\tthis.$store.state.sequenceSetManager.updateFilename(f);\n\t\t},\n\t\tupdateConstraint: function updateConstraint(c) {\n\t\t\tthis.$store.state.sequenceSetManager.updateConstraint(c);\n\t\t},\n\t\tgetRgbString: function getRgbString(f) {\n\t\t\treturn __WEBPACK_IMPORTED_MODULE_2__audio_instruments_js__[\"a\" /* default */][f].rgbString;\n\t\t},\n\t\tgetInstrumentStyle: function getInstrumentStyle(f) {\n\t\t\tvar rgbString = this.getRgbString(f);\n\t\t\treturn {\n\t\t\t\tbackgroundColor: rgbString\n\t\t\t};\n\t\t},\n\t\tgetInstrumentClassNames: function getInstrumentClassNames(f) {\n\t\t\tvar sequence = this.$store.state.editedSequence,\n\t\t\t    className = 'instrument-dot';\n\t\t\tif (sequence === undefined) return className;\n\t\t\tif (f !== sequence.filename) return className;\n\t\t\treturn className + ' instrument-dot--active';\n\t\t},\n\t\tgetConstraintStyle: function getConstraintStyle(c) {\n\t\t\treturn {\n\t\t\t\tbackgroundColor: c.color\n\t\t\t};\n\t\t},\n\t\tgetConstraintClass: function getConstraintClass(c) {\n\t\t\tvar sequence = this.$store.state.editedSequence,\n\t\t\t    className = 'constraint';\n\t\t\tif (sequence === undefined) return className;\n\t\t\tif (c.name !== sequence.constraint.name) return className;\n\t\t\treturn className + ' constraint--active';\n\t\t},\n\t\tgetTransportClass: function getTransportClass() {\n\t\t\tif (this.$store.state.sequenceSetManager.isLooping) {\n\t\t\t\treturn 'transportControl--playing';\n\t\t\t}\n\t\t\treturn 'transportControl--stopped';\n\t\t}\n\t},\n\tdirectives: {\n\t\tcaptureCanvas: function captureCanvas(element, binding) {\n\t\t\tvar values = binding.value;\n\t\t\t__WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].publish('newSurface', { element: element, values: values });\n\t\t}\n\t},\n\tmounted: function mounted() {\n\t\tvar self = this;\n\t\t__WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].subscribe(__WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].topicMap.newEditedSequence, function (data) {\n\t\t\tself.$store.commit('updatedEditedSequence', data.sequence);\n\t\t});\n\t\twindow.addEventListener('keydown', function (evt) {\n\t\t\tif (evt.keyCode !== 27) return;\n\t\t\tif (self.$store.state.mode === 'ARRANGEMENT') return;\n\t\t\tself.switchToArrangement();\n\t\t});\n\t}\n});\n\n/***/ }),\n/* 57 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Instrument__ = __webpack_require__(121);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Instrument___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__Instrument__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Arrangement__ = __webpack_require__(118);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Arrangement___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__Arrangement__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__eventbus_js__ = __webpack_require__(0);\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n\tname: 'sequencer',\n\tcomponents: { Instrument: __WEBPACK_IMPORTED_MODULE_0__Instrument___default.a, Arrangement: __WEBPACK_IMPORTED_MODULE_1__Arrangement___default.a },\n\tmounted: function mounted() {\n\t\tvar el = this.$el;\n\t\tfunction resizer() {\n\t\t\tel.style.width = window.innerWidth.toString() + 'px';\n\t\t\tel.style.height = window.innerHeight.toString() + 'px';\n\t\t}\n\t\twindow.addEventListener('resize', resizer);\n\t\tresizer();\n\t},\n\n\tcomputed: {\n\t\tmodeIsInstrument: function modeIsInstrument() {\n\t\t\treturn this.$store.state.mode === 'INSTRUMENT';\n\t\t}\n\t},\n\tmethods: {\n\t\tsoundsAreLoaded: function soundsAreLoaded() {\n\t\t\treturn this.$store.state.soundsAreLoaded;\n\t\t}\n\t}\n});\n\n/***/ }),\n/* 58 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Animator; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__eventbus_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__audio_webaudio_js__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__audio_instruments_js__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__ease_js__ = __webpack_require__(59);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__ease_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__ease_js__);\n\n\n\n\n\nfunction Animator(world, canvas) {\n\tthis.world = world;\n\tthis.activeCanvas = canvas;\n\tthis.instrumentCanvas = canvas;\n\tthis.arrangementCanvases = world.arrangementCanvases;\n\tthis.shouldAnimateInstrument = true;\n\tthis.shouldAnimateArrangement = false;\n\tthis.shouldDrawActiveNotes = true;\n\tthis.isRecording = false;\n\tthis.stroke = [];\n\tthis.style = {\n\t\teditedVertices: {\n\t\t\tshape: 'circle',\n\t\t\tsize: 30,\n\t\t\tblipIncrement: .8\n\t\t},\n\t\tdrawCentroidArrangement: false,\n\t\tdrawCentroidInstrument: false\n\t};\n\tthis.ratio = window.devicePixelRatio || 1;\n\tthis.pendingNotes = [];\n\tthis.activeNotes = [];\n\tthis.noteTimeTolerance = 1 / 50;\n\tthis.mode = undefined;\n\tthis.editedSequence = undefined;\n\tthis.subscribe();\n}\n\nAnimator.prototype.constructor = Animator;\n\nAnimator.prototype.subscribe = function () {\n\tvar newNoteTimesTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newNoteTimesReady,\n\t    canvasResizeTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.canvasResize,\n\t    newEditedSequenceTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newEditedSequence,\n\t    modeChangeTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.modeChange,\n\t    deletedColumnTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.deletedColumn;\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(newNoteTimesTopic, this.handleNewNoteTimes.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(canvasResizeTopic, this.handleCanvasResize.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(newEditedSequenceTopic, this.handleNewEditedSequence.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(modeChangeTopic, this.updateMode.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(deletedColumnTopic, this.handleDeletedColumn.bind(this));\n};\n\nAnimator.prototype.handleNewNoteTimes = function (data) {\n\tfor (var i = 0; i < data.noteTimes.length; i++) {\n\t\tthis.pendingNotes.push({\n\t\t\tsequenceId: data.sequenceId,\n\t\t\tsequenceIndex: data.sequenceIndex,\n\t\t\tsequenceSetId: data.sequenceSetId,\n\t\t\tnoteTime: data.noteTimes[i],\n\t\t\tpoint: data.points[i],\n\t\t\tcoordinate: data.coordinates[i],\n\t\t\tnoteDuration: data.noteDuration,\n\t\t\tloopIndex: data.loopIndex,\n\t\t\tfilename: data.filename,\n\t\t\tconstraint: data.constraint\n\t\t});\n\t}\n};\n\nAnimator.prototype.updateMode = function (to) {\n\tthis.mode = to;\n\tif (to === 'ARRANGEMENT') {\n\t\tthis.shouldAnimateInstrument = false;\n\t\tthis.shouldAnimateArrangement = true;\n\t\tthis.clearArrangementCanvases();\n\t\tthis.animateArrangement();\n\t} else {\n\t\tthis.shouldAnimateInstrument = true;\n\t\tthis.shouldAnimateArrangement = false;\n\t\tthis.activeCanvas = this.instrumentCanvas;\n\t\tthis.animateInstrument();\n\t}\n};\n\nAnimator.prototype.handleCanvasResize = function () {\n\tif (this.mode === 'INSTRUMENT') {\n\t\tthis.pendingNotes = [];\n\t\tthis.activeNotes = [];\n\t}\n};\n\nAnimator.prototype.handleDeletedColumn = function () {\n\tif (this.mode === 'INSTRUMENT') return;\n\tthis.pendingNotes = [];\n\tthis.activeNotes = [];\n};\n\nAnimator.prototype.drawCircle = function (shape, dotSize, props) {\n\tthis.drawArc(shape.center, shape.radius, true, props);\n\tthis.drawDots([shape.center], dotSize, false, props);\n};\n\nAnimator.prototype.drawRectTriLineRand = function (shape, dotSize, props) {\n\tvar linePoints = shape.points.concat([shape.points[0]]),\n\t    vertPoints = shape.points.concat([shape.center]);\n\tthis.drawLine(linePoints, true, props);\n\tthis.drawDots(vertPoints, dotSize, false, props);\n};\n\nAnimator.prototype.drawShape = function (shape, dotSize, props) {\n\tif (shape.identity === 'circle') {\n\t\tthis.drawCircle(shape, dotSize, props);\n\t} else {\n\t\tthis.drawRectTriLineRand(shape, dotSize, props);\n\t}\n};\n\nAnimator.prototype.animateArrangement = function () {\n\n\tvar self = this,\n\t    dotSize = this.style.editedVertices.size,\n\t    blipIncrement = this.style.editedVertices.blipIncrement;\n\n\tvar animator = function animator() {\n\t\tif (!self.shouldAnimateArrangement) return;\n\n\t\tself.updateActiveNotes();\n\t\tself.clearArrangementCanvases();\n\n\t\tfor (var i = 0; i < self.activeNotes.length; i++) {\n\t\t\tvar note = self.activeNotes[i],\n\t\t\t    sequenceIndex = note.sequenceIndex,\n\t\t\t    canvas = self.getArrangementCanvas(note.sequenceSetId, sequenceIndex),\n\t\t\t    ctx = canvas.getContext('2d'),\n\t\t\t    now = Date.now(),\n\t\t\t    start = note.start || now,\n\t\t\t    sign = note.sign || 1,\n\t\t\t    currentSize = note.currentSize || dotSize,\n\t\t\t    duration = note.noteDuration / 2 * 1000,\n\t\t\t    p = (now - start) / duration,\n\t\t\t    canvasSize = 100,\n\t\t\t    canvasCenter = {\n\t\t\t\tx: canvasSize / 2,\n\t\t\t\ty: canvasSize / 2\n\t\t\t},\n\t\t\t    val = __WEBPACK_IMPORTED_MODULE_3__ease_js___default.a.outQuad(p);\n\t\t\tif (p > .9) {\n\t\t\t\tnote.sign = -1;\n\t\t\t\tstart = now;\n\t\t\t}\n\t\t\tcurrentSize = currentSize + val * blipIncrement * sign;\n\t\t\tnote.start = start;\n\t\t\tnote.currentSize = currentSize;\n\n\t\t\tself.activeCanvas = canvas;\n\t\t\tcanvas.width = canvasSize * self.ratio;\n\t\t\tcanvas.height = canvasSize * self.ratio;\n\t\t\tctx.scale(self.ratio, self.ratio);\n\n\t\t\tvar color = note.constraint.color,\n\n\t\t\t// let color = instruments[note.filename].rgbString,\n\t\t\tprops = {\n\t\t\t\tfillStyle: color,\n\t\t\t\tstrokeStyle: color\n\t\t\t};\n\n\t\t\tself.drawDots([canvasCenter], currentSize, false, props);\n\n\t\t\tif (self.style.drawCentroidArrangement) {\n\t\t\t\tself.drawDots([canvasCenter], currentSize / 2, false, {\n\t\t\t\t\tfillStyle: __WEBPACK_IMPORTED_MODULE_2__audio_instruments_js__[\"a\" /* default */][note.filename].rgbString,\n\t\t\t\t\tstrokeStyle: __WEBPACK_IMPORTED_MODULE_2__audio_instruments_js__[\"a\" /* default */][note.filename].rgbString\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\twindow.requestAnimationFrame(animator);\n\t};\n\n\tanimator();\n};\n\nAnimator.prototype.animateInstrument = function () {\n\n\tvar self = this,\n\t    dotSize = this.style.editedVertices.size,\n\t    blipIncrement = this.style.editedVertices.blipIncrement;\n\n\tvar animator = function animator() {\n\t\tif (!self.shouldAnimateInstrument) return;\n\n\t\tvar world = self.world,\n\t\t    canvas = self.activeCanvas,\n\t\t    editedShape = world.getEditedShape(),\n\t\t    needResize = canvas.width === 0 || editedShape !== undefined && editedShape.previousCanvasWidth === undefined,\n\t\t    filename = self.editedSequence.filename,\n\t\t    color = self.editedSequence.constraint.color,\n\n\t\t// color = instruments[filename].rgbString,\n\t\tprops = {\n\t\t\tfillStyle: color,\n\t\t\tstrokeStyle: color,\n\t\t\tlineWidth: 5\n\t\t};\n\n\t\tself.updateActiveNotes();\n\n\t\tif (needResize) {\n\t\t\tself.sizeCanvas();\n\t\t}\n\n\t\tif (editedShape !== undefined && !self.isRecording) {\n\t\t\tself.drawShape(editedShape, dotSize, props);\n\t\t} else if (self.isRecording) {\n\t\t\tself.drawLine(self.stroke, true, props);\n\t\t} else {\n\t\t\tvar ctx = canvas.getContext('2d');\n\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t\t}\n\n\t\tfor (var i = 0; i < self.activeNotes.length; i++) {\n\t\t\tif (editedShape === undefined) continue;\n\t\t\tvar note = self.activeNotes[i],\n\t\t\t    coordinate = note.coordinate,\n\t\t\t    now = Date.now(),\n\t\t\t    start = note.start || now,\n\t\t\t    sign = note.sign || 1,\n\t\t\t    currentSize = note.currentSize || dotSize,\n\t\t\t    duration = note.noteDuration / 2 * 1000,\n\t\t\t    p = (now - start) / duration,\n\t\t\t    val = __WEBPACK_IMPORTED_MODULE_3__ease_js___default.a.outQuad(p),\n\t\t\t    blipSizeUse = void 0;\n\t\t\tif (p > .9) {\n\t\t\t\tnote.sign = -1;\n\t\t\t\tstart = now;\n\t\t\t}\n\t\t\tcurrentSize = currentSize + val * blipIncrement * sign;\n\t\t\tnote.start = start;\n\t\t\tnote.currentSize = currentSize;\n\t\t\tif (note.sequenceId !== world.editedSequenceId) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tself.drawDots([note.point], currentSize, false, props);\n\n\t\t\t/*\n   \tMARK: Begin animating centroid\n   */\n\n\t\t\tif (self.style.drawCentroidInstrument) {\n\t\t\t\tvar centerPoint = void 0,\n\t\t\t\t    centerPointSize = void 0;\n\t\t\t\tif (editedShape.identity === 'random') {\n\t\t\t\t\tcenterPoint = note.point;\n\t\t\t\t} else {\n\t\t\t\t\tcenterPoint = editedShape.center;\n\t\t\t\t}\n\t\t\t\tif (editedShape.identity === 'circle' || editedShape.identity === 'random') {\n\t\t\t\t\tcenterPointSize = currentSize / 4;\n\t\t\t\t} else {\n\t\t\t\t\tcenterPointSize = dotSize / 4;\n\t\t\t\t}\n\t\t\t\tself.drawDots([centerPoint], centerPointSize, false, {\n\t\t\t\t\tfillStyle: __WEBPACK_IMPORTED_MODULE_2__audio_instruments_js__[\"a\" /* default */][note.filename].rgbString,\n\t\t\t\t\tstrokeStyle: __WEBPACK_IMPORTED_MODULE_2__audio_instruments_js__[\"a\" /* default */][note.filename].rgbString\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\twindow.requestAnimationFrame(animator);\n\t};\n\n\tanimator();\n};\n\nAnimator.prototype.updateActiveNotes = function () {\n\tvar pendingNotes = [],\n\t    expired = [];\n\tfor (var i = 0; i < this.pendingNotes.length; i++) {\n\t\tvar note = this.pendingNotes[i],\n\t\t    currentTime = __WEBPACK_IMPORTED_MODULE_1__audio_webaudio_js__[\"a\" /* webAudio */].context.currentTime,\n\t\t    noteTime = note.noteTime;\n\t\tif (Math.abs(noteTime - currentTime) < this.noteTimeTolerance) {\n\t\t\tthis.activeNotes.push(note);\n\t\t} else {\n\t\t\tpendingNotes.push(note);\n\t\t}\n\t}\n\tfor (var _i = 0; _i < this.activeNotes.length; _i++) {\n\t\tvar _note = this.activeNotes[_i],\n\t\t    _currentTime = __WEBPACK_IMPORTED_MODULE_1__audio_webaudio_js__[\"a\" /* webAudio */].context.currentTime,\n\t\t    _noteTime = _note.noteTime,\n\t\t    noteDuration = _note.noteDuration;\n\t\tif (_currentTime - (_noteTime + noteDuration) > this.noteTimeTolerance) {\n\t\t\texpired.push(_i - expired.length);\n\t\t}\n\t}\n\tfor (var _i2 = 0; _i2 < expired.length; _i2++) {\n\t\tthis.activeNotes.splice(expired[_i2], 1);\n\t}\n\tthis.pendingNotes = pendingNotes;\n\n\t//\tget rid of pending notes if the shape is marked\n\t// \tas undefined\n\n\tvar expiredRemover = function expiredRemover(arr, id) {\n\t\tvar expired = [];\n\t\tfor (var _i3 = 0; _i3 < arr.length; _i3++) {\n\t\t\tif (arr[_i3].sequenceId === id) {\n\t\t\t\texpired.push(_i3 - expired.length);\n\t\t\t}\n\t\t}\n\t\tfor (var _i4 = 0; _i4 < expired.length; _i4++) {\n\t\t\tarr.splice(expired[_i4], 1);\n\t\t}\n\t};\n\n\tvar editedShape = this.world.getEditedShape();\n\tif (editedShape === undefined) {\n\t\texpiredRemover(this.pendingNotes, this.world.editedSequenceId);\n\t\texpiredRemover(this.activeNotes, this.world.editedSequenceId);\n\t}\n};\n\nAnimator.prototype.drawLine = function (points, doClear, props) {\n\tvar canvas = this.activeCanvas,\n\t    ctx = canvas.getContext('2d');\n\tif (typeof doClear == 'undefined') doClear = true;\n\tif (doClear) ctx.clearRect(0, 0, canvas.width, canvas.height);\n\tfor (var i = 0; i < points.length - 1; i++) {\n\t\tctx.beginPath();\n\t\tctx.moveTo(points[i].x, points[i].y);\n\t\tctx.lineTo(points[i + 1].x, points[i + 1].y);\n\t\tctx.lineWidth = props.lineWidth;\n\t\tctx.strokeStyle = props.strokeStyle;\n\t\tctx.stroke();\n\t}\n};\n\nAnimator.prototype.drawArc = function (center, radius, doClear, props) {\n\tvar canvas = this.activeCanvas,\n\t    ctx = canvas.getContext('2d');\n\tif (typeof doClear == 'undefined') doClear = true;\n\tif (doClear) ctx.clearRect(0, 0, canvas.width, canvas.height);\n\tctx.beginPath();\n\tctx.arc(center.x, center.y, radius, 0, Math.PI * 2);\n\tctx.strokeStyle = props.strokeStyle;\n\tctx.lineWidth = props.lineWidth;\n\tctx.stroke();\n};\n\nAnimator.prototype.drawDots = function (points, width, doClear, props) {\n\tvar canvas = this.activeCanvas,\n\t    ctx = canvas.getContext('2d');\n\tif (typeof doClear == 'undefined') doClear = true;\n\tif (doClear) ctx.clearRect(0, 0, canvas.width, canvas.height);\n\tfor (var i = 0; i < points.length; i++) {\n\t\tctx.fillStyle = props.fillStyle;\n\t\tctx.globalAlpha = props.alpha || 1;\n\t\tvar x = points[i].x,\n\t\t    y = points[i].y,\n\t\t    r = width / 2;\n\t\tr = Math.abs(r);\n\t\tctx.beginPath();\n\t\tctx.arc(x, y, r, 0, Math.PI * 2);\n\t\tctx.closePath();\n\t\tctx.fill();\n\t}\n};\n\nAnimator.prototype.sizeCanvas = function () {\n\tvar canvas = this.activeCanvas,\n\t    ctx = canvas.getContext('2d');\n\tsizeCanvas();\n\twindow.addEventListener('resize', sizeCanvas);\n\tfunction sizeCanvas() {\n\t\tvar rect = canvas.getBoundingClientRect(),\n\t\t    w = rect.width,\n\t\t    h = rect.height,\n\t\t    ratio = window.devicePixelRatio || 1;\n\t\tcanvas.width = w * ratio;\n\t\tcanvas.height = h * ratio;\n\t\tctx.scale(ratio, ratio);\n\t\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].publish('canvasResize', {\n\t\t\tcanvasWidth: canvas.width / ratio,\n\t\t\tcanvasHeight: canvas.height / ratio\n\t\t});\n\t}\n};\n\nAnimator.prototype.handleNewEditedSequence = function (data) {\n\tthis.pendingNotes = [];\n\tthis.activeNotes = [];\n\tthis.editedSequence = data.sequence;\n};\n\nAnimator.prototype.getArrangementCanvas = function (setId, index) {\n\tfor (var i = 0; i < this.arrangementCanvases.length; i++) {\n\t\tvar canvasSet = this.arrangementCanvases[i],\n\t\t    canvas = canvasSet.canvas,\n\t\t    sequenceSetId = canvasSet.sequenceSetId,\n\t\t    sequenceIndex = canvasSet.index;\n\t\tif (sequenceSetId === setId && sequenceIndex === index) {\n\t\t\treturn canvas;\n\t\t}\n\t}\n};\n\nAnimator.prototype.clearArrangementCanvases = function () {\n\tfor (var i = 0; i < this.arrangementCanvases.length; i++) {\n\t\tvar canvas = this.arrangementCanvases[i].canvas,\n\t\t    ctx = canvas.getContext('2d');\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t}\n};\n\nAnimator.prototype.clearActiveCanvas = function () {\n\tvar canvas = this.activeCanvas,\n\t    ctx = canvas.getContext('2d');\n\tctx.clearRect(0, 0, canvas.width, canvas.height);\n};\n\n\n\n/***/ }),\n/* 59 */\n/***/ (function(module, exports) {\n\n// https://raw.githubusercontent.com/component/ease/master/index.js \n// easing functions from \"Tween.js\"\n\nexports.linear = function (n) {\n  return n;\n};\n\nexports.inQuad = function (n) {\n  return n * n;\n};\n\nexports.outQuad = function (n) {\n  return n * (2 - n);\n};\n\nexports.inOutQuad = function (n) {\n  n *= 2;\n  if (n < 1) return 0.5 * n * n;\n  return -0.5 * (--n * (n - 2) - 1);\n};\n\nexports.inCube = function (n) {\n  return n * n * n;\n};\n\nexports.outCube = function (n) {\n  return --n * n * n + 1;\n};\n\nexports.inOutCube = function (n) {\n  n *= 2;\n  if (n < 1) return 0.5 * n * n * n;\n  return 0.5 * ((n -= 2) * n * n + 2);\n};\n\nexports.inQuart = function (n) {\n  return n * n * n * n;\n};\n\nexports.outQuart = function (n) {\n  return 1 - --n * n * n * n;\n};\n\nexports.inOutQuart = function (n) {\n  n *= 2;\n  if (n < 1) return 0.5 * n * n * n * n;\n  return -0.5 * ((n -= 2) * n * n * n - 2);\n};\n\nexports.inQuint = function (n) {\n  return n * n * n * n * n;\n};\n\nexports.outQuint = function (n) {\n  return --n * n * n * n * n + 1;\n};\n\nexports.inOutQuint = function (n) {\n  n *= 2;\n  if (n < 1) return 0.5 * n * n * n * n * n;\n  return 0.5 * ((n -= 2) * n * n * n * n + 2);\n};\n\nexports.inSine = function (n) {\n  return 1 - Math.cos(n * Math.PI / 2);\n};\n\nexports.outSine = function (n) {\n  return Math.sin(n * Math.PI / 2);\n};\n\nexports.inOutSine = function (n) {\n  return .5 * (1 - Math.cos(Math.PI * n));\n};\n\nexports.inExpo = function (n) {\n  return 0 == n ? 0 : Math.pow(1024, n - 1);\n};\n\nexports.outExpo = function (n) {\n  return 1 == n ? n : 1 - Math.pow(2, -10 * n);\n};\n\nexports.inOutExpo = function (n) {\n  if (0 == n) return 0;\n  if (1 == n) return 1;\n  if ((n *= 2) < 1) return .5 * Math.pow(1024, n - 1);\n  return .5 * (-Math.pow(2, -10 * (n - 1)) + 2);\n};\n\nexports.inCirc = function (n) {\n  return 1 - Math.sqrt(1 - n * n);\n};\n\nexports.outCirc = function (n) {\n  return Math.sqrt(1 - --n * n);\n};\n\nexports.inOutCirc = function (n) {\n  n *= 2;\n  if (n < 1) return -0.5 * (Math.sqrt(1 - n * n) - 1);\n  return 0.5 * (Math.sqrt(1 - (n -= 2) * n) + 1);\n};\n\nexports.inBack = function (n) {\n  var s = 1.70158;\n  return n * n * ((s + 1) * n - s);\n};\n\nexports.outBack = function (n) {\n  var s = 1.70158;\n  return --n * n * ((s + 1) * n + s) + 1;\n};\n\nexports.inOutBack = function (n) {\n  var s = 1.70158 * 1.525;\n  if ((n *= 2) < 1) return 0.5 * (n * n * ((s + 1) * n - s));\n  return 0.5 * ((n -= 2) * n * ((s + 1) * n + s) + 2);\n};\n\nexports.inBounce = function (n) {\n  return 1 - exports.outBounce(1 - n);\n};\n\nexports.outBounce = function (n) {\n  if (n < 1 / 2.75) {\n    return 7.5625 * n * n;\n  } else if (n < 2 / 2.75) {\n    return 7.5625 * (n -= 1.5 / 2.75) * n + 0.75;\n  } else if (n < 2.5 / 2.75) {\n    return 7.5625 * (n -= 2.25 / 2.75) * n + 0.9375;\n  } else {\n    return 7.5625 * (n -= 2.625 / 2.75) * n + 0.984375;\n  }\n};\n\nexports.inOutBounce = function (n) {\n  if (n < .5) return exports.inBounce(n * 2) * .5;\n  return exports.outBounce(n * 2 - 1) * .5 + .5;\n};\n\nexports.inElastic = function (n) {\n  var s,\n      a = 0.1,\n      p = 0.4;\n  if (n === 0) return 0;\n  if (n === 1) return 1;\n  if (!a || a < 1) {\n    a = 1;s = p / 4;\n  } else s = p * Math.asin(1 / a) / (2 * Math.PI);\n  return -(a * Math.pow(2, 10 * (n -= 1)) * Math.sin((n - s) * (2 * Math.PI) / p));\n};\n\nexports.outElastic = function (n) {\n  var s,\n      a = 0.1,\n      p = 0.4;\n  if (n === 0) return 0;\n  if (n === 1) return 1;\n  if (!a || a < 1) {\n    a = 1;s = p / 4;\n  } else s = p * Math.asin(1 / a) / (2 * Math.PI);\n  return a * Math.pow(2, -10 * n) * Math.sin((n - s) * (2 * Math.PI) / p) + 1;\n};\n\nexports.inOutElastic = function (n) {\n  var s,\n      a = 0.1,\n      p = 0.4;\n  if (n === 0) return 0;\n  if (n === 1) return 1;\n  if (!a || a < 1) {\n    a = 1;s = p / 4;\n  } else s = p * Math.asin(1 / a) / (2 * Math.PI);\n  if ((n *= 2) < 1) return -0.5 * (a * Math.pow(2, 10 * (n -= 1)) * Math.sin((n - s) * (2 * Math.PI) / p));\n  return a * Math.pow(2, -10 * (n -= 1)) * Math.sin((n - s) * (2 * Math.PI) / p) * 0.5 + 1;\n};\n\n// aliases\n\nexports['in-quad'] = exports.inQuad;\nexports['out-quad'] = exports.outQuad;\nexports['in-out-quad'] = exports.inOutQuad;\nexports['in-cube'] = exports.inCube;\nexports['out-cube'] = exports.outCube;\nexports['in-out-cube'] = exports.inOutCube;\nexports['in-quart'] = exports.inQuart;\nexports['out-quart'] = exports.outQuart;\nexports['in-out-quart'] = exports.inOutQuart;\nexports['in-quint'] = exports.inQuint;\nexports['out-quint'] = exports.outQuint;\nexports['in-out-quint'] = exports.inOutQuint;\nexports['in-sine'] = exports.inSine;\nexports['out-sine'] = exports.outSine;\nexports['in-out-sine'] = exports.inOutSine;\nexports['in-expo'] = exports.inExpo;\nexports['out-expo'] = exports.outExpo;\nexports['in-out-expo'] = exports.inOutExpo;\nexports['in-circ'] = exports.inCirc;\nexports['out-circ'] = exports.outCirc;\nexports['in-out-circ'] = exports.inOutCirc;\nexports['in-back'] = exports.inBack;\nexports['out-back'] = exports.outBack;\nexports['in-out-back'] = exports.inOutBack;\nexports['in-bounce'] = exports.inBounce;\nexports['out-bounce'] = exports.outBounce;\nexports['in-out-bounce'] = exports.inOutBounce;\nexports['in-elastic'] = exports.inElastic;\nexports['out-elastic'] = exports.outElastic;\nexports['in-out-elastic'] = exports.inOutElastic;\n\n/***/ }),\n/* 60 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Sequence; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__webaudio_js__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__eventbus_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__util_js__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__constraints__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__geometry_vertices_js__ = __webpack_require__(12);\n\n\n\n\n\n\nfunction Sequence(sequenceSet, filename) {\n\tthis.sequenceSet = sequenceSet;\n\tthis.shape = undefined;\n\tthis.id = __WEBPACK_IMPORTED_MODULE_2__util_js__[\"a\" /* Util */].randId();\n\tthis.index = 0;\n\tthis.filename = filename;\n\tthis.shouldLoop = true;\n\tthis.isActive = false;\n\tthis.isLooping = false;\n\tthis.loopIndex = 0;\n\tthis.nBeats = 4;\n\tthis.noteLength = 'quarter';\n\tthis.constraints = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__constraints__[\"a\" /* getSequenceConstraints */])();\n\tthis.constraint = this.constraints[0];\n\tthis.currentBeat = __WEBPACK_IMPORTED_MODULE_0__webaudio_js__[\"a\" /* webAudio */].getCurrentBeat();\n\tthis.sources = [];\n\tthis.previousWidth = undefined;\n\tthis.previousHeight = undefined;\n\tthis.mode = undefined;\n\tthis.animationFrameId = undefined;\n\tthis.subscribe();\n}\n\nSequence.prototype.constructor = Sequence;\n\nSequence.prototype.subscribe = function () {\n\tvar newShapeReadyTopic = __WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].topicMap.newShapeReady,\n\t    canvasResizeTopic = __WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].topicMap.canvasResize,\n\t    modeChangeTopic = __WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].topicMap.modeChange;\n\t__WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].subscribe(newShapeReadyTopic, this.registerShape.bind(this), this.id);\n\t__WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].subscribe(modeChangeTopic, this.handleModeChange.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].subscribe(canvasResizeTopic, this.handleCanvasResize.bind(this));\n};\n\nSequence.prototype.registerShape = function (data) {\n\tvar id = data.sequenceId,\n\t    shape = data.shape;\n\tif (id !== this.id) return;\n\tif (shape === undefined) {\n\t\tthis.nBeats = 4;\n\t\tthis.noteLength = 'quarter';\n\t\tthis.shape = shape;\n\t\tthis.stopSources();\n\t\treturn;\n\t}\n\tthis.shape = shape;\n\tswitch (shape.identity) {\n\t\tcase 'triangle':\n\t\t\tthis.nBeats = 4;\n\t\t\tthis.noteLength = 'eighthTriplet';\n\t\t\tbreak;\n\t\tcase 'rectangle':\n\t\t\tthis.nBeats = 4;\n\t\t\tthis.noteLength = 'quarter';\n\t\t\tbreak;\n\t\tcase 'circle':\n\t\t\tthis.nBeats = 4;\n\t\t\tthis.noteLength = 'sixteenth';\n\t\t\tbreak;\n\t\tcase 'line':\n\t\t\tthis.nBeats = 4;\n\t\t\tthis.noteLength = 'eighth';\n\t\t\tbreak;\n\t\tcase 'random':\n\t\t\tthis.nBeats = 4;\n\t\t\tthis.noteLength = 'sixteenthTriplet';\n\t\t\tbreak;\n\t}\n};\n\nSequence.prototype.cancelLoop = function () {\n\twindow.cancelAnimationFrame(this.animationFrameId);\n\tthis.stopSources();\n\tthis.isLooping = false;\n};\n\nSequence.prototype.stopSources = function () {\n\tfor (var i = 0; i < this.sources.length; i++) {\n\t\ttry {\n\t\t\tthis.sources[i].stop(0);\n\t\t} catch (err) {\n\t\t\tconsole.warn('Could not stop playback.');\n\t\t}\n\t}\n};\n\nSequence.prototype.handleModeChange = function (data) {\n\tthis.mode = data;\n};\n\nSequence.prototype.handleCanvasResize = function (data) {\n\tvar width = data.canvasWidth,\n\t    height = data.canvasHeight;\n\tif (width === 0 && height === 0) return;\n\tif (this.mode === 'ARRANGEMENT') return;\n\tthis.previousWidth = width;\n\tthis.previousHeight = height;\n};\n\nSequence.prototype.getPercentageCoordinates = function (points, width, height) {\n\tvar coords = [];\n\tfor (var i = 0; i < points.length; i++) {\n\t\tvar x = bounder(points[i].x / width),\n\t\t    y = bounder(points[i].y / height),\n\t\t    ind = points[i].index;\n\t\tcoords.push(new __WEBPACK_IMPORTED_MODULE_4__geometry_vertices_js__[\"a\" /* Point */](x, y, ind));\n\t}\n\tfunction bounder(a) {\n\t\tif (a < 0) return 0;\n\t\tif (a > 1) return 1;\n\t\treturn a;\n\t}\n\treturn coords;\n};\n\nSequence.prototype.loop = function () {\n\tvar self = this,\n\t    newActiveSequenceTopic = __WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].topicMap.newActiveSequence;\n\n\tthis.currentBeat = __WEBPACK_IMPORTED_MODULE_0__webaudio_js__[\"a\" /* webAudio */].getCurrentBeat();\n\tthis.shouldLoop = true;\n\tthis.loopIndex = 0;\n\n\t//\tmark that a new active sequence has begun\n\n\t__WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].publish(newActiveSequenceTopic, {\n\t\tsequenceId: this.id,\n\t\tsequenceSetId: this.sequenceSet.id\n\t});\n\n\tvar looper = function looper() {\n\n\t\tif (!self.shouldLoop) {\n\t\t\treturn;\n\t\t}\n\n\t\tself.isLooping = true;\n\n\t\tvar currentBeat = __WEBPACK_IMPORTED_MODULE_0__webaudio_js__[\"a\" /* webAudio */].getCurrentBeat(),\n\t\t    nBeats = self.nBeats,\n\t\t    loopIndex = self.loopIndex,\n\t\t    filename = self.filename,\n\t\t    noteLength = self.noteLength,\n\t\t    shape = self.shape,\n\t\t    points = void 0,\n\t\t    radius = void 0,\n\t\t    newNotesReadyTopic = __WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].topicMap.newNoteTimesReady;\n\n\t\tif (shape !== undefined) {\n\t\t\t// points = shape.vertices.copyPoints(shape.points)\n\t\t\tpoints = shape.points;\n\t\t\tif (shape.identity === 'rectangle') {\n\t\t\t\tpoints = [points[loopIndex]];\n\t\t\t} else if (shape.identity === 'circle') {\n\t\t\t\tvar pt = shape.center;\n\t\t\t\tpoints = shape.vertices.repPoint(pt, 4);\n\t\t\t\tradius = [{ x: shape.radius, y: shape.radius }];\n\t\t\t} else if (shape.identity === 'random') {\n\t\t\t\tvar _pt = shape.points[0];\n\t\t\t\tpoints = shape.vertices.repPoint(_pt, 6);\n\t\t\t}\n\t\t}\n\n\t\t//\tunless we've reached the next beat, do not proceed\n\n\t\tif (currentBeat === self.currentBeat) {\n\t\t\tself.animationFrameId = window.requestAnimationFrame(looper);\n\t\t\treturn;\n\t\t}\n\n\t\t//\tOnly calculate properties if we're the active sequence\n\n\t\t// if (this.isActive) {\n\n\t\t// }\n\n\t\t//\totherwise, schedule the appropriate number of notes associated with the\n\t\t//\tcurrent beat, and return the scheduled note times\n\n\t\tvar width = void 0,\n\t\t    height = void 0;\n\n\t\tif (shape !== undefined) {\n\t\t\tvar ratio = window.devicePixelRatio || 1;\n\t\t\tif (self.mode === 'INSTRUMENT') {\n\t\t\t\twidth = shape.canvas.width / ratio;\n\t\t\t\theight = shape.canvas.height / ratio;\n\t\t\t} else if (self.mode === 'ARRANGEMENT') {\n\t\t\t\twidth = self.previousWidth;\n\t\t\t\theight = self.previousHeight;\n\t\t\t}\n\t\t\tif (shape.identity === 'circle') {\n\t\t\t\tradius = self.getPercentageCoordinates(radius, width, height);\n\t\t\t}\n\t\t\tvar coordinates = self.getPercentageCoordinates(points, width, height),\n\t\t\t    schedule = __WEBPACK_IMPORTED_MODULE_0__webaudio_js__[\"a\" /* webAudio */].schedulePlay(filename, {\n\t\t\t\tnoteLength: noteLength,\n\t\t\t\tsequence: self,\n\t\t\t\tcoordinates: coordinates,\n\t\t\t\tidentity: shape.identity,\n\t\t\t\tradius: radius\n\t\t\t}),\n\t\t\t    currentTime = __WEBPACK_IMPORTED_MODULE_0__webaudio_js__[\"a\" /* webAudio */].context.currentTime;\n\t\t\t//\tmark self new note times are available\n\t\t\t__WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].publish(newNotesReadyTopic, {\n\t\t\t\tsequenceId: self.id,\n\t\t\t\tsequenceIndex: self.index,\n\t\t\t\tsequenceSetId: self.sequenceSet.id,\n\t\t\t\tnoteTimes: schedule.noteTimes,\n\t\t\t\tnoteDuration: schedule.noteDuration,\n\t\t\t\tcurrentTime: currentTime,\n\t\t\t\tloopIndex: loopIndex,\n\t\t\t\tshape: shape,\n\t\t\t\tpoints: points,\n\t\t\t\tcoordinates: coordinates,\n\t\t\t\tconstraint: self.constraint,\n\t\t\t\tfilename: filename\n\t\t\t});\n\t\t}\n\n\t\tself.previousWidth = width;\n\t\tself.previousHeight = height;\n\n\t\t//\tmark the updated currentBeat\n\n\t\tself.currentBeat = currentBeat;\n\n\t\t//\tif we're on the last beat of the sequence,\n\t\t//\tquit out of the looping function, and alert the parent\n\t\t//\tself it should move to the next sequence\n\n\t\tif (loopIndex === nBeats - 1) {\n\t\t\tself.isLooping = false;\n\t\t\t__WEBPACK_IMPORTED_MODULE_1__eventbus_js__[\"a\" /* eventBus */].publish('endOfSequence', {}, self.sequenceSet.id);\n\t\t\treturn;\n\t\t}\n\n\t\t//\totherwise, proceed to the next beat\n\n\t\tself.loopIndex++;\n\n\t\tself.animationFrameId = window.requestAnimationFrame(looper);\n\t};\n\n\tlooper();\n};\n\n\n\n/***/ }),\n/* 61 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return SequenceSet; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__eventbus_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__webaudio_js__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__util_js__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__sequence_js__ = __webpack_require__(60);\n\n\n\n\n\nfunction SequenceSet(filename) {\n\tthis.filename = filename;\n\tthis.sequences = [];\n\tthis.hasEditedSequence = false;\n\tthis.editedSequenceIndex = undefined;\n\tthis.editedSequenceId = undefined;\n\tthis.activeSequenceIndex = undefined;\n\tthis.activeSequenceId = undefined;\n\tthis.id = __WEBPACK_IMPORTED_MODULE_2__util_js__[\"a\" /* Util */].randId();\n\tthis.mode = undefined;\n\tthis.isLooping = false;\n\tthis.subscribe();\n}\n\nSequenceSet.prototype.constructor = SequenceSet;\n\nSequenceSet.prototype.subscribe = function () {\n\tvar topicNextSequence = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.endOfSequence,\n\t    topicModeChange = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.modeChange,\n\t    topicEditedSequence = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newEditedSequence;\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(topicNextSequence, this.nextSequence.bind(this), this.id);\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(topicModeChange, this.changeMode.bind(this));\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].subscribe(topicEditedSequence, this.handleNewEditedSequence.bind(this));\n};\n\nSequenceSet.prototype.resetLoopIndices = function () {\n\tfor (var i = 0; i < this.sequences.length; i++) {\n\t\tif (this.sequences[i] !== undefined) {\n\t\t\tthis.sequences[i].loopIndex = 0;\n\t\t}\n\t}\n};\n\nSequenceSet.prototype.cancelLoop = function () {\n\tthis.isLooping = false;\n\tif (this.sequences.length === 0) return;\n\tthis.sequences[this.activeSequenceIndex].cancelLoop();\n};\n\nSequenceSet.prototype.forceCancelLoop = function () {\n\tthis.isLooping = false;\n\tvar N = this.sequences.length;\n\tif (N === 0 || N === 1) return;\n\tvar nonEditedSequences = this.getNonEditedSequences();\n\tnonEditedSequences.map(function (seq) {\n\t\tseq.cancelLoop();\n\t});\n};\n\nSequenceSet.prototype.forceCancelAllLoops = function () {\n\tthis.isLooping = false;\n\tfor (var i = 0; i < this.sequences.length; i++) {\n\t\tthis.sequences[i].cancelLoop();\n\t}\n};\n\nSequenceSet.prototype.loop = function () {\n\tthis.isLooping = true;\n\tif (this.sequences.length === 0) return;\n\t//\tmake sure there aren't any queued loops\n\tvar loopingSequences = this.getLoopingSequences();\n\tif (loopingSequences.length !== 0) {\n\t\t// console.warn('More than 0 - loop');\n\t\treturn;\n\t}\n\tvar currentSequence = this.sequences[this.activeSequenceIndex];\n\tif (currentSequence === undefined) {\n\t\tthis.nextSequence();\n\t\treturn;\n\t}\n\tthis.activeSequenceId = currentSequence.id;\n\tcurrentSequence.loop();\n};\n\nSequenceSet.prototype.nextSequence = function () {\n\tif (this.mode === 'INSTRUMENT') {\n\t\tthis.loop();\n\t\treturn;\n\t}\n\tif (this.activeSequenceIndex === this.sequences.length - 1) {\n\t\tthis.activeSequenceIndex = 0;\n\t} else {\n\t\tthis.activeSequenceIndex++;\n\t}\n\tthis.loop();\n};\n\nSequenceSet.prototype.switchToColumn = function (index) {\n\tvar shouldResumeLoop = this.isLooping,\n\t    shouldCancelLoop = this.sequences.length > 1;\n\t// shouldCancelLoop = index !== this.activeSequenceIndex;\n\tif (shouldCancelLoop) {\n\t\tthis.forceCancelAllLoops();\n\t\tthis.activeSequenceIndex = index;\n\t}\n\tif (shouldResumeLoop) this.loop();\n};\n\nSequenceSet.prototype.handleNewEditedSequence = function (data) {\n\tif (data.sequenceSetId !== this.id) {\n\t\tthis.hasEditedSequence = false;\n\t\treturn;\n\t}\n\tvar definedSequences = this.sequences.filter(function (seq) {\n\t\treturn seq !== undefined;\n\t});\n\tthis.hasEditedSequence = true;\n\tvar sequenceId = data.sequenceId;\n\tthis.activeSequenceIndex = this.getIndexOfSequenceId(sequenceId);\n\tthis.editedSequenceIndex = this.activeSequenceIndex;\n\tthis.editedSequenceId = sequenceId;\n\tvar shouldResumeLoop = false;\n\tif (this.isLooping) {\n\t\tshouldResumeLoop = true;\n\t}\n\tif (definedSequences.length > 1) this.forceCancelLoop();\n\tif (shouldResumeLoop) this.loop();\n};\n\nSequenceSet.prototype.getSequenceIds = function () {\n\tvar ids = [];\n\tfor (var i = 0; i < this.sequences.length; i++) {\n\t\tif (this.sequences[i] === undefined) {\n\t\t\tids.push(undefined);\n\t\t\tcontinue;\n\t\t}\n\t\tids.push(this.sequences[i].id);\n\t}\n\treturn ids;\n};\n\nSequenceSet.prototype.getNonEditedSequences = function () {\n\tvar self = this;\n\treturn this.sequences.filter(function (seq) {\n\t\treturn seq.id !== self.editedSequenceId;\n\t});\n};\n\nSequenceSet.prototype.getDefinedSequences = function () {\n\treturn this.sequences.filter(function (seq) {\n\t\treturn seq !== undefined;\n\t});\n};\nSequenceSet.prototype.getLoopingSequences = function () {\n\treturn this.sequences.filter(function (seq) {\n\t\treturn seq.isLooping;\n\t});\n};\n\nSequenceSet.prototype.getIndexOfSequenceId = function (id) {\n\tvar ids = this.getSequenceIds();\n\treturn __WEBPACK_IMPORTED_MODULE_2__util_js__[\"a\" /* Util */].indexOf(ids, id);\n};\n\nSequenceSet.prototype.getSequenceById = function (id) {\n\treturn this.sequences[this.getIndexOfSequenceId(id)];\n};\n\nSequenceSet.prototype.changeMode = function (to) {\n\tthis.mode = to;\n};\n\nSequenceSet.prototype.createSequence = function (filename, index) {\n\tvar sequence = new __WEBPACK_IMPORTED_MODULE_3__sequence_js__[\"a\" /* Sequence */](this, filename),\n\t    setId = this.id;\n\tif (index === undefined) {\n\t\tindex = this.sequences.length - 1;\n\t}\n\tthis.sequences[index] = sequence;\n\tsequence.index = index;\n\tif (this.sequences.length === 1) {\n\t\tthis.activeSequenceIndex = index;\n\t\tthis.activeSequenceId = sequence.id;\n\t}\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].publish(__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newSequenceCreated, {\n\t\tsequenceId: sequence.id,\n\t\tsequenceSetId: setId,\n\t\tsequenceIndex: index\n\t});\n};\n\nSequenceSet.prototype.deleteLastSequence = function () {\n\tvar wasLooping = this.isLooping;\n\tthis.forceCancelAllLoops();\n\tthis.sequences.splice(this.sequences.length - 1, 1);\n\tthis.activeSequenceIndex = 0;\n\tthis.resetLoopIndices();\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].publish(__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.deletedColumn, {});\n\tif (wasLooping) this.loop();\n};\n\n\n\n/***/ }),\n/* 62 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return SequenceSets; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__eventbus_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__sequenceset_js__ = __webpack_require__(61);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__world_js__ = __webpack_require__(33);\n\n\n\n\nfunction SequenceSets() {\n\tthis.sequenceSets = [];\n\tthis.sequenceSetIndex = 0;\n\tthis.editedSequenceId = undefined;\n\tthis.maxNColumns = 4;\n\tthis.isLooping = false;\n}\n\nSequenceSets.prototype.constructor = SequenceSets;\n\nSequenceSets.prototype.createSet = function (filename) {\n\tvar set = new __WEBPACK_IMPORTED_MODULE_1__sequenceset_js__[\"a\" /* SequenceSet */](filename),\n\t    newSequenceSetTopicName = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newSequenceSetCreated;\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].publish(newSequenceSetTopicName, { sequenceSetId: set.id });\n\tthis.sequenceSets.push(set);\n\treturn set;\n};\n\nSequenceSets.prototype.loop = function () {\n\tif (this.isLooping) return;\n\tfor (var i = 0; i < this.sequenceSets.length; i++) {\n\t\tthis.sequenceSets[i].loop();\n\t}\n\tthis.isLooping = true;\n};\n\nSequenceSets.prototype.cancelLoop = function () {\n\tif (!this.isLooping) return;\n\tfor (var i = 0; i < this.sequenceSets.length; i++) {\n\t\tthis.sequenceSets[i].cancelLoop();\n\t}\n\tthis.isLooping = false;\n};\n\nSequenceSets.prototype.toggleLoop = function () {\n\tif (this.isLooping) {\n\t\tthis.cancelLoop();\n\t} else {\n\t\tthis.loop();\n\t}\n};\n\nSequenceSets.prototype._toggleSequences = function () {\n\tvar sequenceSetIds = this.sequenceSets.map(function (set) {\n\t\treturn set.id;\n\t});\n\tthis.sequenceSetIndex++;\n\tif (this.sequenceSetIndex > sequenceSetIds.length - 1) {\n\t\tthis.sequenceSetIndex = 0;\n\t}\n\tvar currentId = sequenceSetIds[this.sequenceSetIndex];\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].publish(__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newActiveSequenceSet, {\n\t\tsequenceSetId: currentId\n\t});\n};\n\nSequenceSets.prototype.getSequenceSetById = function (id) {\n\tfor (var i = 0; i < this.sequenceSets.length; i++) {\n\t\tvar currentSet = this.sequenceSets[i];\n\t\tif (currentSet.id === id) return currentSet;\n\t}\n\treturn -1;\n};\n\nSequenceSets.prototype.sequenceExistsAtIndex = function (index) {\n\treturn this.sequenceSets.some(function (set) {\n\t\treturn set.sequences.length - 1 === index;\n\t});\n};\n\nSequenceSets.prototype.createSequencesAtIndex = function (index) {\n\tfor (var i = 0; i < this.sequenceSets.length; i++) {\n\t\tvar set = this.sequenceSets[i];\n\t\tset.createSequence(set.filename, index);\n\t}\n};\n\nSequenceSets.prototype.createNextColumn = function () {\n\tvar index = this.sequenceSets[0].sequences.length - 1;\n\tindex++;\n\tthis.createSequencesAtIndex(index);\n};\n\nSequenceSets.prototype.sequenceExists = function (setId, index) {\n\tvar set = this.getSequenceSetById(setId);\n\tif (set.sequences[index] === undefined) return false;\n\treturn true;\n};\n\nSequenceSets.prototype.shapeExists = function (setId, index) {\n\tif (!this.sequenceExists(setId, index)) return false;\n\tvar set = this.getSequenceSetById(setId);\n\tif (set.sequences[index].shape === undefined) return false;\n\treturn true;\n};\n\nSequenceSets.prototype.allShapesExist = function (index) {\n\tfor (var i = 0; i < this.sequenceSets.length; i++) {\n\t\tvar set = this.sequenceSets[i],\n\t\t    setId = set.id;\n\t\tif (!this.shapeExists(setId, index)) return false;\n\t}\n\treturn true;\n};\n\nSequenceSets.prototype.handleClickedSequence = function (setId, index, store) {\n\tvar set = this.getSequenceSetById(setId);\n\tif (!this.sequenceExists(setId, index)) {\n\t\tset.createSequence(set.filename, index);\n\t}\n\tthis.markActiveSet(setId);\n\tvar sequenceId = set.sequences[index].id;\n\tthis.markEditedSequence(setId, sequenceId);\n\tfor (var i = 0; i < this.sequenceSets.length; i++) {\n\t\tthis.sequenceSets[i].switchToColumn(index);\n\t}\n\tthis.editedSequenceId = setId;\n};\n\nSequenceSets.prototype.markActiveSet = function (id) {\n\tvar newActiveSetTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newActiveSequenceSet;\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].publish(newActiveSetTopic, { sequenceSetId: id });\n};\n\nSequenceSets.prototype.markEditedSequence = function (sequenceSetId, sequenceId) {\n\tvar newEditedSequenceTopic = __WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].topicMap.newEditedSequence,\n\t    sequence = this.getSequenceSetById(sequenceSetId).getSequenceById(sequenceId);\n\t__WEBPACK_IMPORTED_MODULE_0__eventbus_js__[\"a\" /* eventBus */].publish(newEditedSequenceTopic, {\n\t\tsequenceSetId: sequenceSetId,\n\t\tsequenceId: sequenceId,\n\t\tsequence: sequence\n\t});\n};\n\nSequenceSets.prototype.getEditedSequence = function () {\n\tvar set = this.getSequenceSetById(__WEBPACK_IMPORTED_MODULE_2__world_js__[\"a\" /* world */].activeSequenceSetId);\n\treturn set.getSequenceById(__WEBPACK_IMPORTED_MODULE_2__world_js__[\"a\" /* world */].editedSequenceId);\n};\n\nSequenceSets.prototype.updateFilename = function (filename) {\n\tvar sequence = this.getEditedSequence();\n\tsequence.filename = filename;\n};\n\nSequenceSets.prototype.updateConstraint = function (constraint) {\n\tvar sequence = this.getEditedSequence();\n\tsequence.constraint = constraint;\n};\n\nSequenceSets.prototype.canAddMoreColumns = function () {\n\tif (this.sequenceSets[0].sequences.length === this.maxNColumns) {\n\t\treturn false;\n\t}\n\treturn true;\n};\n\nSequenceSets.prototype.deleteLastColumn = function () {\n\tfor (var i = 0; i < this.sequenceSets.length; i++) {\n\t\tthis.sequenceSets[i].deleteLastSequence();\n\t}\n};\n\n\n\n/***/ }),\n/* 63 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Detector; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__vertices_js__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shape_js__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__util_js__ = __webpack_require__(5);\n\n\n\n\nfunction Detector(vertices) {\n\tthis.vertices = vertices;\n\tthis.criteria = {\n\t\trectangle: {\n\t\t\taxisRatioThreshold: .5\n\t\t},\n\t\tcircle: {\n\t\t\tglobalThreshold: .5\n\t\t},\n\t\ttriangle: {\n\t\t\tglobalThreshold: 10\n\t\t},\n\t\tline: {\n\t\t\tdistanceThreshold: .4,\n\t\t\tperpDistanceThreshold: .05\n\t\t},\n\t\trandom: {\n\t\t\tglobalThreshold: .5\n\t\t}\n\t};\n\tthis.estimatedVertices = {\n\t\trectangle: [],\n\t\tcircle: [],\n\t\ttriangle: [],\n\t\tline: []\n\t};\n\tthis.identity = undefined;\n}\n\nDetector.prototype.constructor = Detector;\n\n/*\n\tUPDATE ESTIMATED VERTICES\n*/\n\nDetector.prototype.updateEstimatedVertices = function () {\n\tthis.estimatedVertices.rectangle = this.getEstimatedRectVertices();\n\tthis.estimatedVertices.triangle = this.getEstimatedTriangleVertices();\n\tthis.estimatedVertices.circle = this.getEstimatedCircleVertices();\n\tthis.estimatedVertices.line = this.getEstimatedLineVertices();\n};\n\n/*\n\tESTIMATE VERTICES\n*/\n\nDetector.prototype.getEstimatedTriangleVertices = function () {\n\tvar verts = this.vertices.hull,\n\t    points = verts.points,\n\t    inds = [];\n\tfor (var i = 0; i < points.length; i++) {\n\t\tinds.push(i);\n\t}var area = -Infinity,\n\t    largestSet;\n\tinds = __WEBPACK_IMPORTED_MODULE_2__util_js__[\"a\" /* Util */].combs(inds, 3);\n\tfor (var i = 0; i < inds.length; i++) {\n\t\tvar set = inds[i],\n\t\t    A = points[set[0]],\n\t\t    B = points[set[1]],\n\t\t    C = points[set[2]],\n\t\t    tri = [A, B, C],\n\t\t    currentArea = Math.abs(verts.getArea(tri));\n\t\tif (currentArea > area) {\n\t\t\tlargestSet = [A, B, C];\n\t\t\tarea = currentArea;\n\t\t}\n\t}\n\treturn largestSet;\n};\n\nDetector.prototype.getEstimatedRectVertices = function () {\n\n\tvar verts = this.vertices.hull,\n\t    points = verts.points,\n\t    centroid = verts.centroid,\n\t    topLeftPts = points.filter(topLeftFunc),\n\t    topRightPts = points.filter(topRightFunc),\n\t    btmLeftPts = points.filter(btmLeftFunc),\n\t    btmRightPts = points.filter(btmRightFunc),\n\t    nTopLeft = topLeftPts.length,\n\t    nTopRight = topRightPts.length,\n\t    nBtmLeft = btmLeftPts.length,\n\t    nBtmRight = btmRightPts.length;\n\n\tif (nTopLeft === 0 || nTopRight === 0 || nBtmLeft === 0 || nBtmRight === 0) {\n\t\treturn [];\n\t}\n\n\tvar topLeftDistances = verts.getDistances(centroid, topLeftPts),\n\t    topRightDistances = verts.getDistances(centroid, topRightPts),\n\t    btmLeftDistances = verts.getDistances(centroid, btmLeftPts),\n\t    btmRightDistances = verts.getDistances(centroid, btmRightPts);\n\n\tvar topLeftInd = __WEBPACK_IMPORTED_MODULE_2__util_js__[\"a\" /* Util */].findMax(topLeftDistances),\n\t    topRightInd = __WEBPACK_IMPORTED_MODULE_2__util_js__[\"a\" /* Util */].findMax(topRightDistances),\n\t    btmLeftInd = __WEBPACK_IMPORTED_MODULE_2__util_js__[\"a\" /* Util */].findMax(btmLeftDistances),\n\t    btmRightInd = __WEBPACK_IMPORTED_MODULE_2__util_js__[\"a\" /* Util */].findMax(btmRightDistances);\n\n\tvar topLeftPt = topLeftPts[topLeftInd],\n\t    topRightPt = topRightPts[topRightInd],\n\t    btmLeftPt = btmLeftPts[btmLeftInd],\n\t    btmRightPt = btmRightPts[btmRightInd];\n\n\treturn [topLeftPt, topRightPt, btmLeftPt, btmRightPt];\n\n\tfunction topLeftFunc(pt) {\n\t\treturn pt.x < centroid.x && pt.y > centroid.y;\n\t}\n\tfunction topRightFunc(pt) {\n\t\treturn pt.x > centroid.x && pt.y > centroid.y;\n\t}\n\tfunction btmLeftFunc(pt) {\n\t\treturn pt.x < centroid.x && pt.y < centroid.y;\n\t}\n\tfunction btmRightFunc(pt) {\n\t\treturn pt.x > centroid.x && pt.y < centroid.y;\n\t}\n};\n\nDetector.prototype.getEstimatedCircleVertices = function () {\n\tvar verts = this.vertices,\n\t    points = verts.hull.points,\n\t    centroid = verts.hull.centroid,\n\t    distances = verts.getDistances(centroid, points),\n\t    summed = __WEBPACK_IMPORTED_MODULE_2__util_js__[\"a\" /* Util */].sum(distances),\n\t    N = distances.length,\n\t    mean = summed / N;\n\n\tvar radius = new __WEBPACK_IMPORTED_MODULE_0__vertices_js__[\"a\" /* Point */](centroid.x, centroid.y + mean, 0);\n\n\treturn [centroid, radius];\n};\n\nDetector.prototype.getEstimatedLineVertices = function () {\n\tvar N = this.vertices.points.length;\n\treturn [this.vertices.points[0], this.vertices.points[N - 1]];\n};\n\n/*\n\tASSESS SHAPE LIKELIHOOD\n*/\n\nDetector.prototype.getLikelihoodRect = function () {\n\tvar rectVertices = this.estimatedVertices.rectangle;\n\n\tif (rectVertices.length === 0) return 0;\n\n\tvar hull = this.vertices.hull,\n\t    topLeftPt = rectVertices[0],\n\t    topRightPt = rectVertices[1],\n\t    btmLeftPt = rectVertices[2],\n\t    btmRightPt = rectVertices[3],\n\t    centroid = hull.centroid;\n\n\tvar axis1Ratio = getSlopeRatio(topLeftPt, btmRightPt, centroid),\n\t    axis2Ratio = getSlopeRatio(btmLeftPt, topRightPt, centroid),\n\t    threshold = this.criteria.rectangle.axisRatioThreshold;\n\n\treturn Math.max(axis1Ratio, axis2Ratio);\n\n\tfunction getSlopeRatio(p0, p1, centroid) {\n\t\tvar slopeA = hull.getSlope(p0, centroid),\n\t\t    slopeB = hull.getSlope(p1, centroid),\n\t\t    slopeAB = hull.getSlope(p0, p1),\n\t\t    ratio = slopeA / slopeAB * (slopeB / slopeAB);\n\t\treturn ratio;\n\t}\n};\n\nDetector.prototype.getLikelihoodCircle = function () {\n\tvar verts = this.vertices,\n\t    hull = verts.hull,\n\t    vertPoints = verts.points,\n\t    hullPoints = hull.points,\n\t    nSamples = vertPoints.length,\n\t    nHull = hullPoints.length,\n\t    nRatio = nHull / nSamples,\n\t    realArea = verts.area,\n\t    hullArea = hull.area,\n\t    areaRatio = realArea / hullArea,\n\t    perimEfficiency = verts.perimeterEfficiency,\n\t    confidence = perimEfficiency * nRatio * areaRatio;\n\n\treturn confidence;\n};\n\nDetector.prototype.getLikelihoodTriangle = function () {\n\tvar triangleVertices = this.estimatedVertices.triangle,\n\t    area = this.vertices.hull.area;\n\tif (triangleVertices === undefined) return Infinity;\n\treturn area / Math.abs(this.vertices.getArea(triangleVertices));\n};\n\nDetector.prototype.getLikelihoodLine = function () {\n\tvar verts = this.vertices,\n\t    points = verts.points,\n\t    pFirst = points[0],\n\t    pLast = points[points.length - 1],\n\t    perpDistanceRatios = [],\n\t    distances = [],\n\t    lastDistance = verts.getDistance(pFirst, pLast),\n\t    pDistance;\n\tfor (var i = 1; i < points.length - 2; i++) {\n\t\tpDistance = verts.getPerpendicularDistance(points[i], pFirst, pLast);\n\t\tperpDistanceRatios.push(pDistance / lastDistance);\n\t}\n\tfor (var i = 0; i < points.length - 2; i++) {\n\t\tdistances.push(verts.getDistance(points[i], points[i + 1]));\n\t}\n\tvar summed = __WEBPACK_IMPORTED_MODULE_2__util_js__[\"a\" /* Util */].sum(distances),\n\t    distRatio = lastDistance / summed,\n\t    maxPerpRatio = Math.max.apply(Math, perpDistanceRatios);\n\n\treturn {\n\t\tdistanceRatio: distRatio,\n\t\tperpDistanceRatio: maxPerpRatio\n\t};\n};\n\nDetector.prototype.getLikelihoodRandom = function () {\n\treturn this.vertices.perimeterEfficiency;\n};\n\n/*\n\tASSIGN SHAPE IDENTITY\n*/\n\nDetector.prototype.isRectangle = function () {\n\tvar estimate = this.getLikelihoodRect(),\n\t    thresh = this.criteria.rectangle.axisRatioThreshold;\n\treturn Math.abs(estimate - 1) < thresh;\n};\n\nDetector.prototype.isCircle = function () {\n\tvar estimate = this.getLikelihoodCircle(),\n\t    thresh = this.criteria.circle.globalThreshold;\n\treturn estimate > thresh;\n};\n\nDetector.prototype.isTriangle = function () {\n\tvar estimate = this.getLikelihoodTriangle(),\n\t    thresh = this.criteria.triangle.globalThreshold;\n\treturn estimate < thresh;\n};\n\nDetector.prototype.isLine = function () {\n\tvar estimates = this.getLikelihoodLine(),\n\t    distanceRatio = estimates.distanceRatio,\n\t    perpRatio = estimates.perpDistanceRatio,\n\t    distanceThresh = this.criteria.line.distanceThreshold,\n\t    perpDistanceThresh = this.criteria.line.perpDistanceThreshold;\n\n\treturn distanceRatio - 1 < distanceThresh && perpRatio < perpDistanceThresh;\n};\n\nDetector.prototype.isRandom = function () {\n\tvar estimate = this.getLikelihoodRandom(),\n\t    thresh = this.criteria.random.globalThreshold;\n\n\treturn estimate < thresh;\n};\n\n/*\n\tMODIFY VERTICES\n*/\n\nDetector.prototype.getAdjustedRectVertices = function () {\n\tvar rectPoints = this.estimatedVertices.rectangle,\n\t    rectVerts = new __WEBPACK_IMPORTED_MODULE_0__vertices_js__[\"b\" /* Vertices */](rectPoints),\n\t    points = rectVerts._sortPointsByPolarAngle();\n\tpoints.unshift(rectVerts.anchorPoint);\n\trectVerts.points = points;\n\trectVerts.updateAllExceptHull();\n\tpoints.push(points[0]);\n\tvar distances = rectVerts.getConsecutiveDistances(points),\n\t    L = __WEBPACK_IMPORTED_MODULE_2__util_js__[\"a\" /* Util */].mean(distances),\n\n\t// LA = Util.mean([distances[0], distances[2]]),\n\t// LB = Util.mean([distances[1], distances[3]]),\n\tcentroid = rectVerts.centroid,\n\t    midPoint = new __WEBPACK_IMPORTED_MODULE_0__vertices_js__[\"a\" /* Point */](L / 2, L / 2, 0),\n\t    A = centroid.copy(),\n\t    B = centroid.copy(),\n\t    C = centroid.copy(),\n\t    D = centroid.copy();\n\n\tA.minus(midPoint);\n\tB.x -= midPoint.x;\n\tB.y += midPoint.y;\n\tC.plus(midPoint);\n\tD.x += midPoint.x;\n\tD.y -= midPoint.y;\n\n\tvar recombinedVerts = new __WEBPACK_IMPORTED_MODULE_0__vertices_js__[\"b\" /* Vertices */]([A, B, C, D]);\n\trecombinedVerts.updateAll();\n\treturn recombinedVerts;\n};\n\nDetector.prototype.getAdjustedTriangleVertices = function () {\n\tvar verts = this.vertices,\n\t    triPoints = this.estimatedVertices.triangle,\n\t    centroid = verts.hull.centroid,\n\t    distances = verts.getDistances(centroid, triPoints),\n\t    meanDist = __WEBPACK_IMPORTED_MODULE_2__util_js__[\"a\" /* Util */].mean(distances) * .9,\n\t    newVerts = [];\n\n\tfor (var i = 0; i < 3; i++) {\n\t\tvar center = centroid.copy();\n\t\tif (i === 0) {\n\t\t\tcenter.y -= meanDist;\n\t\t} else if (i === 1) {\n\t\t\tcenter.y += meanDist;\n\t\t\tcenter.x -= meanDist;\n\t\t} else {\n\t\t\tcenter.y += meanDist;\n\t\t\tcenter.x += meanDist;\n\t\t}\n\t\tnewVerts.push(center);\n\t}\n\tvar vertices = new __WEBPACK_IMPORTED_MODULE_0__vertices_js__[\"b\" /* Vertices */](newVerts);\n\tvertices.updateAll();\n\treturn vertices;\n};\n\n/*\n\tGET DETECTED SHAPE\n*/\n\nDetector.prototype.getLine = function () {\n\treturn new __WEBPACK_IMPORTED_MODULE_1__shape_js__[\"a\" /* Line */](this.vertices);\n};\n\nDetector.prototype.getRectangle = function () {\n\tvar verts = this.getAdjustedRectVertices();\n\treturn new __WEBPACK_IMPORTED_MODULE_1__shape_js__[\"b\" /* Shape */](verts, 'rectangle');\n};\n\nDetector.prototype.getTriangle = function () {\n\tvar verts = this.getAdjustedTriangleVertices();\n\treturn new __WEBPACK_IMPORTED_MODULE_1__shape_js__[\"b\" /* Shape */](verts, 'triangle');\n};\n\nDetector.prototype.getCircle = function () {\n\tvar verts = this.vertices,\n\t    estimatedVertices = this.estimatedVertices.circle,\n\t    center = estimatedVertices[0],\n\t    radius = estimatedVertices[1].y - center.y;\n\treturn new __WEBPACK_IMPORTED_MODULE_1__shape_js__[\"c\" /* Circle */](verts, center, radius);\n};\n\nDetector.prototype.getRandom = function () {\n\tvar N = this.vertices.points.length - 1;\n\tthis.vertices.points = [this.vertices.points[N]];\n\tthis.vertices.updateAllExceptHull();\n\treturn new __WEBPACK_IMPORTED_MODULE_1__shape_js__[\"b\" /* Shape */](this.vertices, 'random');\n};\n\nDetector.prototype.getDetectedShape = function () {\n\tswitch (this.identity) {\n\t\tcase 'line':\n\t\t\treturn this.getLine();\n\t\tcase 'rectangle':\n\t\t\treturn this.getRectangle();\n\t\tcase 'circle':\n\t\t\treturn this.getCircle();\n\t\tcase 'triangle':\n\t\t\treturn this.getTriangle();\n\t\tcase 'random':\n\t\t\treturn this.getRandom();\n\t\tdefault:\n\t\t\treturn this.getRandom();\n\t}\n};\n\n/*\n\tIDENTIFY\n*/\n\nDetector.prototype.identify = function () {\n\tvar isRectangle = this.isRectangle(),\n\t    isCircle = this.isCircle(),\n\t    isTriangle = this.isTriangle(),\n\t    isLine = this.isLine(),\n\t    isRandom = this.isRandom(),\n\t    identity;\n\n\tif (isLine) {\n\t\tidentity = 'line';\n\t} else if (isRandom) {\n\t\tidentity = 'random';\n\t} else if (isCircle) {\n\t\tidentity = 'circle';\n\t} else if (isRectangle) {\n\t\tidentity = 'rectangle';\n\t} else if (isTriangle) {\n\t\tidentity = 'triangle';\n\t} else {\n\t\tidentity = undefined;\n\t}\n\n\tthis.identity = identity;\n};\n\n\n\n/***/ }),\n/* 64 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Interaction; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__util_js__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__geometry_detector_js__ = __webpack_require__(63);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__geometry_shape_js__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__geometry_vertices_js__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__eventbus_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__audio_webaudio_js__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_interact_js__ = __webpack_require__(116);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_interact_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_interact_js__);\n\n\n\n\n\n\n\n\nfunction Interaction(world, animator) {\n\tthis.world = world;\n\tthis.animator = animator;\n}\n\nInteraction.prototype.constructor = Interaction;\n\nInteraction.prototype.handleTouch = function () {\n\n\tvar self = this,\n\t    position,\n\t    stroke = [],\n\t    shouldContinue = true,\n\t    shape,\n\t    vertex,\n\t    animator = this.animator,\n\t    element = animator.instrumentCanvas,\n\t    sequenceIdCurrent,\n\t    sequenceIdOnDown,\n\t    bounds = animator.style.editedVertices.size;\n\n\tanimator.isRecording = false;\n\n\t__WEBPACK_IMPORTED_MODULE_6_interact_js___default()(element).on('down', down).on('up', up).on('move', move);\n\n\tfunction move(e) {\n\t\te.preventDefault();\n\t\tposition = correctPosition({ x: e.clientX, y: e.clientY });\n\t}\n\tfunction down(e) {\n\t\te.preventDefault();\n\t\tshouldContinue = true;\n\t\t__WEBPACK_IMPORTED_MODULE_5__audio_webaudio_js__[\"a\" /* webAudio */].playDummySound();\n\t\tposition = correctPosition({ x: e.clientX, y: e.clientY });\n\t\tshape = self.world.getEditedShape();\n\t\tsequenceIdOnDown = self.world.editedSequenceId;\n\t\tsequenceIdCurrent = sequenceIdOnDown;\n\t\t//\twe're making a new shape\n\t\tif (shape === undefined) {\n\t\t\tanimator.isRecording = true;\n\t\t\trequestAnimationFrame(record);\n\t\t\treturn;\n\t\t}\n\t\tvar nearbyVertices = shape.getVerticesNear(position, bounds),\n\t\t    isNearCenter = shape.isNearCenter(position, bounds);\n\t\tif (nearbyVertices.length === 0 && !isNearCenter) {\n\t\t\tself.publishNewShape(undefined);\n\t\t\tanimator.isRecording = true;\n\t\t\trequestAnimationFrame(record);\n\t\t\treturn;\n\t\t}\n\t\tanimator.isRecording = false;\n\t\tif (nearbyVertices.length > 0) {\n\t\t\tvertex = nearbyVertices[0];\n\t\t\trequestAnimationFrame(modifyVertex);\n\t\t} else {\n\t\t\trequestAnimationFrame(modifyCenter);\n\t\t}\n\t}\n\tfunction updateCurrentSequenceId() {\n\t\tsequenceIdCurrent = self.world.editedSequenceId;\n\t}\n\tfunction correctPosition(pos) {\n\t\tvar rect = self.animator.instrumentCanvas.getBoundingClientRect(),\n\t\t    width = self.animator.instrumentCanvas.width,\n\t\t    height = self.animator.instrumentCanvas.height,\n\t\t    ratio = self.animator.ratio,\n\t\t    x = Math.round((pos.x - rect.left) / (rect.right - rect.left) * width / ratio),\n\t\t    y = Math.round((pos.y - rect.top) / (rect.bottom - rect.top) * height / ratio);\n\t\treturn { x: x, y: y };\n\t}\n\tfunction convertToFractionalCoordinates(pos) {\n\t\tvar rect = self.animator.instrumentCanvas.getBoundingClientRect(),\n\t\t    percX = pos.x - rect.left,\n\t\t    percY = pos.y - rect.top;\n\t\treturn { x: percX, y: percY };\n\t}\n\tfunction up() {\n\t\tshouldContinue = false;\n\t\tupdateCurrentSequenceId();\n\t\tif (!animator.isRecording) return;\n\t\tif (sequenceIdCurrent !== sequenceIdOnDown) return;\n\t\tanimator.isRecording = false;\n\t\tself.handleNewStroke(stroke);\n\t\tstroke = [];\n\t\tanimator.stroke = [];\n\t}\n\tfunction record() {\n\t\tupdateCurrentSequenceId();\n\t\tif (!shouldContinue) return;\n\t\tif (sequenceIdCurrent !== sequenceIdOnDown) return;\n\t\tstroke.push(position);\n\t\tanimator.stroke = stroke;\n\t\trequestAnimationFrame(record);\n\t}\n\tfunction modifyVertex() {\n\t\tupdateCurrentSequenceId();\n\t\tif (!shouldContinue) return;\n\t\tif (sequenceIdCurrent !== sequenceIdOnDown) return;\n\t\tvertex.x = Math.round(position.x);\n\t\tvertex.y = Math.round(position.y);\n\t\tshape.update();\n\t\trequestAnimationFrame(modifyVertex);\n\t}\n\tfunction modifyCenter() {\n\t\tupdateCurrentSequenceId();\n\t\tif (!shouldContinue) return;\n\t\tif (sequenceIdCurrent !== sequenceIdOnDown) return;\n\t\tvar pt = new __WEBPACK_IMPORTED_MODULE_3__geometry_vertices_js__[\"a\" /* Point */](position.x, position.y, 0);\n\t\tshape.centerOn(pt);\n\t\tshape.update();\n\t\trequestAnimationFrame(modifyCenter);\n\t}\n};\n\nInteraction.prototype.publishNewShape = function (shape) {\n\tvar sequenceId = this.world.editedSequenceId,\n\t    sequenceSetId = this.world.activeSequenceSetId,\n\t    newShapeTopic = __WEBPACK_IMPORTED_MODULE_4__eventbus_js__[\"a\" /* eventBus */].topicMap.newShapeReady;\n\t__WEBPACK_IMPORTED_MODULE_4__eventbus_js__[\"a\" /* eventBus */].publish(newShapeTopic, { shape: shape, sequenceId: sequenceId, sequenceSetId: sequenceSetId });\n};\n\nInteraction.prototype.handleNewStroke = function (stroke) {\n\tstroke = __WEBPACK_IMPORTED_MODULE_0__util_js__[\"a\" /* Util */].unique(__WEBPACK_IMPORTED_MODULE_0__util_js__[\"a\" /* Util */].resample(stroke, 256));\n\tif (stroke[0] === undefined) {\n\t\tconsole.warn('No shape will be constructed.');\n\t\treturn;\n\t}\n\tvar verts = new __WEBPACK_IMPORTED_MODULE_3__geometry_vertices_js__[\"b\" /* Vertices */](stroke);\n\tverts.updateAll();\n\tvar detector = new __WEBPACK_IMPORTED_MODULE_1__geometry_detector_js__[\"a\" /* Detector */](verts);\n\tdetector.updateEstimatedVertices();\n\tdetector.identify();\n\tvar shape = detector.getDetectedShape();\n\tshape.canvas = this.animator.instrumentCanvas;\n\tthis.publishNewShape(shape);\n};\n\n\n\n/***/ }),\n/* 65 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vuex__ = __webpack_require__(51);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__App__ = __webpack_require__(50);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__App___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__App__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__router__ = __webpack_require__(49);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__eventbus_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__audio_webaudio_js__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__interface_setup_js__ = __webpack_require__(48);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__audio_setup_js__ = __webpack_require__(47);\n\n\n\n\n\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */].use(__WEBPACK_IMPORTED_MODULE_1_vuex__[\"a\" /* default */]);\n\nvar startingMode = 'ARRANGEMENT';\n\nvar store = new __WEBPACK_IMPORTED_MODULE_1_vuex__[\"a\" /* default */].Store({\n\tstate: {\n\t\tsequenceSetManager: __WEBPACK_IMPORTED_MODULE_7__audio_setup_js__[\"a\" /* sequenceSetManager */],\n\t\tmode: startingMode,\n\t\tsoundsAreLoaded: false,\n\t\teditedSequence: undefined,\n\t\tcanAddColumn: false,\n\t\tdidShowPlus: false,\n\t\tcanDeleteColumn: false\n\t},\n\tmutations: {\n\t\tswitchMode: function switchMode(state, to) {\n\t\t\tif (to !== 'ARRANGEMENT' && to !== 'INSTRUMENT') {\n\t\t\t\tthrow new Error('Unrecognized view mode ' + to);\n\t\t\t}\n\t\t\tstate.mode = to;\n\t\t\t__WEBPACK_IMPORTED_MODULE_4__eventbus_js__[\"a\" /* eventBus */].publish('modeChange', to);\n\t\t},\n\t\tmarkSoundsAreLoaded: function markSoundsAreLoaded(state, to) {\n\t\t\tstate.soundsAreLoaded = to;\n\t\t},\n\t\tupdateDidShowPlus: function updateDidShowPlus(state, to) {\n\t\t\tstate.didShowPlus = to;\n\t\t},\n\t\tupdateColumnAdding: function updateColumnAdding(state, to) {\n\t\t\tstate.canAddColumn = to;\n\t\t},\n\t\tupdateColumnDelete: function updateColumnDelete(state, to) {\n\t\t\tstate.canDeleteColumn = to;\n\t\t},\n\t\tupdatedEditedSequence: function updatedEditedSequence(state, to) {\n\t\t\tstate.editedSequence = to;\n\t\t}\n\t}\n});\n\nstore.commit('switchMode', startingMode);\n\n__WEBPACK_IMPORTED_MODULE_7__audio_setup_js__[\"a\" /* sequenceSetManager */].loop();\n\nwindow.addEventListener('keydown', function (evt) {\n\tif (evt.keyCode === 32) __WEBPACK_IMPORTED_MODULE_7__audio_setup_js__[\"a\" /* sequenceSetManager */].toggleLoop();\n});\n\n__WEBPACK_IMPORTED_MODULE_5__audio_webaudio_js__[\"a\" /* webAudio */].loadSounds().then(function () {\n\tstore.commit('markSoundsAreLoaded', true);\n});\n\n__WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */].config.productionTip = false;\n\n/* eslint-disable no-new */\nnew __WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */]({\n\tel: '#app',\n\tstore: store,\n\trouter: __WEBPACK_IMPORTED_MODULE_3__router__[\"a\" /* default */],\n\ttemplate: '<App/>',\n\tcomponents: { App: __WEBPACK_IMPORTED_MODULE_2__App___default.a }\n});\n\n/***/ }),\n/* 66 */,\n/* 67 */,\n/* 68 */,\n/* 69 */,\n/* 70 */,\n/* 71 */,\n/* 72 */,\n/* 73 */,\n/* 74 */,\n/* 75 */,\n/* 76 */,\n/* 77 */,\n/* 78 */,\n/* 79 */,\n/* 80 */,\n/* 81 */,\n/* 82 */,\n/* 83 */,\n/* 84 */,\n/* 85 */,\n/* 86 */,\n/* 87 */,\n/* 88 */,\n/* 89 */,\n/* 90 */,\n/* 91 */,\n/* 92 */,\n/* 93 */,\n/* 94 */,\n/* 95 */,\n/* 96 */,\n/* 97 */,\n/* 98 */,\n/* 99 */,\n/* 100 */,\n/* 101 */,\n/* 102 */,\n/* 103 */,\n/* 104 */,\n/* 105 */,\n/* 106 */,\n/* 107 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 108 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 109 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 110 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 111 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 112 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 113 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 114 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 115 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 116 */,\n/* 117 */,\n/* 118 */\n/***/ (function(module, exports, __webpack_require__) {\n\nfunction injectStyle (ssrContext) {\n  __webpack_require__(107)\n  __webpack_require__(108)\n}\nvar Component = __webpack_require__(8)(\n  /* script */\n  __webpack_require__(53),\n  /* template */\n  __webpack_require__(123),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-0a587290\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 119 */\n/***/ (function(module, exports, __webpack_require__) {\n\nfunction injectStyle (ssrContext) {\n  __webpack_require__(110)\n  __webpack_require__(111)\n}\nvar Component = __webpack_require__(8)(\n  /* script */\n  __webpack_require__(54),\n  /* template */\n  __webpack_require__(125),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-6f30bcb8\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 120 */\n/***/ (function(module, exports, __webpack_require__) {\n\nfunction injectStyle (ssrContext) {\n  __webpack_require__(109)\n}\nvar Component = __webpack_require__(8)(\n  /* script */\n  __webpack_require__(55),\n  /* template */\n  __webpack_require__(124),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-2d560100\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 121 */\n/***/ (function(module, exports, __webpack_require__) {\n\nfunction injectStyle (ssrContext) {\n  __webpack_require__(112)\n  __webpack_require__(113)\n}\nvar Component = __webpack_require__(8)(\n  /* script */\n  __webpack_require__(56),\n  /* template */\n  __webpack_require__(126),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-a9caebae\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 122 */\n/***/ (function(module, exports, __webpack_require__) {\n\nfunction injectStyle (ssrContext) {\n  __webpack_require__(115)\n}\nvar Component = __webpack_require__(8)(\n  /* script */\n  __webpack_require__(57),\n  /* template */\n  __webpack_require__(128),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  null,\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 123 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"container\",\n    style: (_vm.getContainerStyle())\n  }, [(_vm.canAddColumn() || _vm.canDeleteColumn()) ? _c('div', {\n    staticClass: \"row interface\"\n  }, [(_vm.canDeleteColumn()) ? _c('div', {\n    staticClass: \"cell minusCircle\",\n    on: {\n      \"click\": function($event) {\n        _vm.deleteColumn()\n      }\n    }\n  }, [_c('div', {\n    staticClass: \"bar horizontalpx\"\n  })]) : _vm._e(), _vm._v(\" \"), (_vm.canAddColumn()) ? _c('div', {\n    staticClass: \"cell plusCircle\",\n    on: {\n      \"click\": function($event) {\n        _vm.createColumn()\n      }\n    }\n  }, [_c('div', {\n    staticClass: \"bar horizontalpx\"\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"bar verticalpx\"\n  })]) : _vm._e()]) : _vm._e(), _vm._v(\" \"), _vm._l((_vm.sequenceSets), function(set) {\n    return _c('div', {\n      staticClass: \"row interface\"\n    }, _vm._l((set.sequences.length), function(n) {\n      return _c('cell', {\n        key: set.sequences[n - 1].id,\n        attrs: {\n          \"index\": n - 1,\n          \"sequenceId\": set.sequences[n - 1].id,\n          \"sequenceSetId\": set.id\n        }\n      })\n    }))\n  })], 2)\n},staticRenderFns: []}\n\n/***/ }),\n/* 124 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"hello\"\n  }, [_c('h1', [_vm._v(_vm._s(_vm.msg))]), _vm._v(\" \"), _c('h2', [_vm._v(\"Essential Links\")]), _vm._v(\" \"), _vm._m(0), _vm._v(\" \"), _c('h2', [_vm._v(\"Ecosystem\")]), _vm._v(\" \"), _vm._m(1)])\n},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('ul', [_c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://vuejs.org\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Core Docs\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://forum.vuejs.org\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Forum\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://gitter.im/vuejs/vue\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Gitter Chat\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://twitter.com/vuejs\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Twitter\")])]), _vm._v(\" \"), _c('br'), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://vuejs-templates.github.io/webpack/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Docs for This Template\")])])])\n},function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('ul', [_c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://router.vuejs.org/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"vue-router\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://vuex.vuejs.org/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"vuex\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://vue-loader.vuejs.org/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"vue-loader\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://github.com/vuejs/awesome-vue\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"awesome-vue\")])])])\n}]}\n\n/***/ }),\n/* 125 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"cell\"\n  }, [_c('div', {\n    class: _vm.cellClass,\n    on: {\n      \"click\": function($event) {\n        _vm.switchToSequence()\n      }\n    }\n  }, [_c('canvas', {\n    staticClass: \"instrument__canvas\"\n  })])])\n},staticRenderFns: []}\n\n/***/ }),\n/* 126 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"instrument\"\n  }, [_c('div', {\n    staticClass: \"row interface\"\n  }, [_c('div', {\n    staticClass: \"cell\"\n  }, [_c('div', {\n    staticClass: \"circle circle--active\",\n    on: {\n      \"click\": function($event) {\n        _vm.switchToArrangement()\n      }\n    }\n  })]), _vm._v(\" \"), _vm._l((_vm.constraints), function(pattern) {\n    return _c('div', {\n      staticClass: \"cell\"\n    }, [_c('div', {\n      class: _vm.getConstraintClass(pattern),\n      style: (_vm.getConstraintStyle(pattern)),\n      on: {\n        \"click\": function($event) {\n          _vm.updateConstraint(pattern)\n        }\n      }\n    })])\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"cell\"\n  }, [_c('div', {\n    staticClass: \"circle circle--active transportControl\",\n    on: {\n      \"click\": function($event) {\n        _vm.toggleLoop()\n      }\n    }\n  }, [_c('div', {\n    class: _vm.getTransportClass()\n  })])])], 2), _vm._v(\" \"), _c('canvas', {\n    directives: [{\n      name: \"capture-canvas\",\n      rawName: \"v-capture-canvas\",\n      value: ({\n        type: 'INSTRUMENT'\n      }),\n      expression: \"{type: 'INSTRUMENT'}\"\n    }],\n    staticClass: \"instrument__canvas\"\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"row interface\"\n  }, [_c('div', {\n    staticClass: \"cell\"\n  }, [_c('div', {\n    staticClass: \"instrument-cell\",\n    on: {\n      \"click\": function($event) {\n        _vm.clearShape()\n      }\n    }\n  })]), _vm._v(\" \"), _vm._l((_vm.filenames), function(f) {\n    return _c('div', {\n      staticClass: \"cell\"\n    }, [_c('div', {\n      staticClass: \"instrument-cell\",\n      on: {\n        \"click\": function($event) {\n          _vm.updateFilename(f)\n        }\n      }\n    }, [_c('div', {\n      class: _vm.getInstrumentClassNames(f),\n      style: (_vm.getInstrumentStyle(f))\n    })])])\n  })], 2)])\n},staticRenderFns: []}\n\n/***/ }),\n/* 127 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"app\"\n    }\n  }, [(_vm.soundsAreLoaded()) ? _c('sequencer') : _c('div', [_vm._v(\"\\n\\t\\tLoading ...\\n\\t\")])], 1)\n},staticRenderFns: []}\n\n/***/ }),\n/* 128 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"sequencer\"\n    }\n  }, [_c('instrument', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.modeIsInstrument),\n      expression: \"modeIsInstrument\"\n    }]\n  }), _vm._v(\" \"), _c('arrangement', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (!_vm.modeIsInstrument),\n      expression: \"!modeIsInstrument\"\n    }]\n  })], 1)\n},staticRenderFns: []}\n\n/***/ })\n],[65]);\n\n\n// WEBPACK FOOTER //\n// static/js/app.610535faafd7da876798.js","// http://dev.housetrip.com/2014/09/15/decoupling-javascript-apps-using-pub-sub-pattern/\n\nfunction EventBus() {\n\tthis.topics = {}\n\tthis.topicMap = {\n\t\tmodeChange: 'modeChange',\n\t\tcanvasResize: 'canvasResize',\n\t\tcanvasResizeEnd: 'canvasResizeEnd',\n\t\tnewShapeReady: 'newShapeReady',\n\t\tendOfSequence: 'endOfSequence',\n\t\tnewSequenceSetCreated: 'newSequenceSetCreated',\n\t\tnewSequenceCreated: 'newSequenceCreated',\n\t\tnewActiveSequence: 'newActiveSequence',\n\t\tnewEditedSequence: 'newEditedSequence',\n\t\tnewActiveSequenceSet: 'newActiveSequenceSet',\n\t\tnewNoteTimesReady: 'newNoteTimesReady',\n\t\tclearShape: 'clearShape',\n\t\tnewSurface: 'newSurface',\n\t\tdeletedColumn: 'deletedColumn',\n\t\tsoundsLoaded: 'soundsLoaded'\n\t}\n}\n\nEventBus.prototype.constructor = EventBus\n\nEventBus.prototype.subscribe = function(topic, listener, id) {\n  \tif (!this.topics[topic]) this.topics[topic] = [];\n\n  \tthis.topics[topic].push( { method: listener, id } )\n}\n\nEventBus.prototype.publish = function(topic, data, to) {\n  \tif (!this.topics[topic]) {\n\t\tthrow new Error(`No ${topic} exists`);\n  \t}\n  \tif (this.topics.length < 1) return;\n  \tthis.topics[topic].forEach( (listener) => {\n\t\tif (typeof to == 'undefined') {\n\t\t  \tlistener.method(data || {});\n\t\t} else {\n\t\t  \tif (to === listener.id) {\n\t\t\t\tlistener.method(data || {});\n\t\t  \t}\n\t\t}\n  \t})\n}\n\nconst eventBus = new EventBus();\n\nexport { eventBus }\n\n\n// WEBPACK FOOTER //\n// ./src/eventbus.js","import { Util } from '../util.js';\nimport instruments from './instruments.js';\nimport Tuna from 'tunajs'\n\n/*\n\tconstructor\n*/\n\nfunction WebAudio(properties) {\n\tthis.bpm = properties.bpm;\n\n\tthis.interval = 60 / this.bpm;\n\n\tthis.currentBeat = 1;\n\n\t//\tinitialize the AudioContext, or return -1\n\t//\tif initialization fails\n\n\tthis.context = this.initContext();\n\n\tthis.tuna = new Tuna(this.context);\n\tthis.impulse = undefined;\n\n\t//\tarray of buffer objects with <buffer> and <filename>\n\t//\tproperties\n\n\tthis.buffers = [];\n\tthis.filenames = properties.filenames;\n\n\t//\tdefine default playing properties\n\n\tthis.defaultPlayProperties = {\n\t\taudible: true,\n\t\tpitch: { min: 0, max: 0 }\n\t}\n\n\t//\tmake sure the object was instantiated correctly\n\n\tthis.validate();\n\n\t//\tfor proper safari playback\n\n\tthis.playedDummySound = false;\n}\n\n\n/*\n\tprototype\n*/\n\n\nWebAudio.prototype.constructor = WebAudio;\n\n//\tinitialize the audio context, or return -1 if init fails\n\nWebAudio.prototype.initContext = function() {\n\tlet audioContext = window.AudioContext || window.webkitAudioContext || -1;\n\tif ( audioContext === -1 ) return audioContext;\n\treturn new audioContext();\n}\n\n//\tmake sure we can properly instantiate a new WebAudio\n\nWebAudio.prototype.validate = function() {\n\t//\tmake sure we have window.requestAnimationFrame\n\tif ( typeof window.requestAnimationFrame == 'undefined' ) {\n\t\tthrow new Error('requestAnimationFrame is not supported in this browser');\n\t}\n\t//\tmake sure the audio context is valid\n\tif (this.context === -1) {\n\t\tthrow new Error('Web audio is not supported in this browser');\n\t}\n}\n\nWebAudio.prototype.loadTestSounds = function() {\n\tlet filenames = this.filenames, \n\t\tthat = this,\n\t\tbuffers = this.buffers\n\tfilenames.map( (name) => {\n\t\tlet fullfile = `https://dl.dropboxusercontent.com/s/mt0s5oj4tx1lre2/${name}`,\n\t\t\trequest = new XMLHttpRequest()\n\t\trequest.open('GET', fullfile, true);\n\t\trequest.responseType = 'arraybuffer';\n\t\trequest.onload = function() {\n\t\t\tthat.context.decodeAudioData(request.response, (buffer) => {\n\t\t\t\tbuffers.push({\n\t\t\t\t\tfilename: name,\n\t\t\t\t\tbuffer: buffer\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\t\trequest.send()\n\t})\n}\n\nWebAudio.prototype.loadImpulse = function() {\n\tlet self = this;\n\tlet promise = this.loadSound('impulse_rev.wav')\n\t\t.then(function(sound) {\n\t\t\tself.impulse = sound;\n\t\t});\n}\n\nWebAudio.prototype.loadSound = function(filename) {\n\n\t//\treturn a promise to load the given <filename>\n\n\tlet that = this;\n\n\treturn new Promise( (resolve, reject) => {\n\t\tlet request = new XMLHttpRequest(),\n\t\t\tfullfile = '/sounds/' + filename;\n\n\t\trequest.open('GET', fullfile);\n\t\trequest.responseType = 'arraybuffer';\n\n\t\trequest.onload = function() {\n\t\t\tthat.context.decodeAudioData(request.response, (buffer) => {\n\t\t\t\tresolve(buffer);\n\t\t\t})\n\t\t}\n\n\t\trequest.onerror = (err) => {\n\t\t\treject(err);\n\t\t}\n\n\t\trequest.send();\n\t});\n}\n\nWebAudio.prototype.loadSounds = function() {\n\n\t//\tgiven the array of stored filenames in <this>,\n\t//\tresolve each promise to load the corresponding buffer, and\n\t//\tpush each buffer to the <buffers> array in <this>\n\n\tlet promises = [],\n\t\tbuffers = this.buffers,\n\t\tfilenames = this.filenames,\n\t\tthat = this;\n\n\tfilenames.map( (file) => {\n\t\tpromises.push( that.loadSound(file) );\n\t});\n\n\tlet promise = Promise.all(promises)\n\t\t.then( (sounds) => {\n\t\t\tfor (let i=0; i<sounds.length; i++) {\n\t\t\t\tbuffers.push({\n\t\t\t\t\tfilename: filenames[i],\n\t\t\t\t\tbuffer: sounds[i]\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\t\t.catch( (err) => {\n\t\t\tconsole.log('An error occurred while loading sounds');\n\t\t});\n\n\treturn promise;\n}\n\n//\tfrom the array of buffer objects in this.buffers,\n//\treturn the buffer that matches <filename>\n\nWebAudio.prototype.getBufferByFilename = function(filename) {\n\tlet oneBuffer = this.buffers.filter( (buffer) => buffer.filename === filename );\n\tif (oneBuffer.length === 0) return -1;\n\tif (oneBuffer.length > 1) {\n\t\tthrow new Error('More than one buffer found for' + filename);\n\t}\n\treturn oneBuffer[0].buffer;\n}\n\nWebAudio.prototype.getCurrentBeat = function() {\n\tlet totalElapsedTime = this.context.currentTime,\n\t\tinterval = this.interval;\n\treturn Math.floor(totalElapsedTime / interval);\n}\n\n//\tschedule the playing of N number of notes, where N corresponds\n//\tto the note length specified in <props.noteLength>\n\nWebAudio.prototype.schedulePlay = function(filename, props) {\n\tlet interval = this.interval,\n\t\tcurrentBeat = this.getCurrentBeat(),\n\t\tnoteLength = props.noteLength,\n\t\tcoordinates = props.coordinates,\n\t\tscheduledTime,\n\t\tbeatsToSchedule,\n\t\tduration,\n\t\tscheduledTimes = [];\n\n\tswitch (noteLength) {\n\t\tcase 'quarter':\n\t\t\tbeatsToSchedule = 1;\n\t\t\tbreak;\n\t\tcase 'eighth':\n\t\t\tbeatsToSchedule = 2;\n\t\t\tbreak;\n\t\tcase 'eighthTriplet':\n\t\t\tbeatsToSchedule = 3;\n\t\t\tbreak;\n\t\tcase 'sixteenth':\n\t\t\tbeatsToSchedule = 4;\n\t\t\tbreak;\n\t\tcase 'sixteenthTriplet':\n\t\t\tbeatsToSchedule = 6;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthrow new Error(`Unrecognized noteLength ${noteLength}`);\n\t}\n\n\t//\tfirst scheduled time\n\n\t// scheduledTime = (currentBeat * interval) + interval/beatsToSchedule;\n\t// scheduledTime = (currentBeat * interval) + interval/6;\n\t// scheduledTime = (currentBeat * interval) + interval/2\n\tscheduledTime = (currentBeat * interval) + interval/2;\n\n\t//\tnote length\n\n\tduration = interval/beatsToSchedule;\n\n\t//\tupdate the current beat\n\n\tthis.currentBeat = currentBeat;\n\n\t//\tremove the sources from the sequence\n\n\tprops.sequence.sources = [];\n\n\tfor (let i=0; i<beatsToSchedule; i++) {\n\t\tlet playTime = scheduledTime + (interval/beatsToSchedule) * i,\n\t\t\tplayProps = Object.assign(props, {when: playTime});\n\n\t\t//\tplay each note at time <playTime>\n\n\t\tthis.play(filename, playProps, coordinates[i]);\n\n\t\t//\tfor output\n\n\t\tscheduledTimes.push(playTime);\n\t}\n\n\treturn {noteTimes: scheduledTimes, noteDuration: duration};\n}\n\nWebAudio.prototype.play = function(filename, props, coord) {\n\tlet source = this.context.createBufferSource(),\n\t\tbuffer = this.getBufferByFilename(filename),\n\t\tdefaultPlayProperties = this.defaultPlayProperties,\n\t\twhen = props.when || 0;\n\n\tif ( buffer === -1 ) throw new Error(`Could not find ${filename}`);\n\n\tprops = Object.assign({}, defaultPlayProperties, props);\n\n\tprops.sequence.sources.push(source);\n\n\t//\tif this set of beats is set to be silent, return\n\n\tif (!props.audible) return;\n\n\tlet pitchMatrix = props.sequence.constraint.pitchMatrix,\n\t\tpitchIndex,\n\t\txModulation;\n\tif (props.identity !== 'circle') {\n\t\tpitchIndex = Math.floor((1-coord.y) * (pitchMatrix.length-1));\n\t\txModulation = coord.x;\n\t} else {\n\t\tlet radius = (props.radius[0].x + props.radius[0].y)/2,\n\t\t\tsign = 1,\n\t\t\tadjustedY;\n\t\tif (Math.random() > .5) sign = -1;\n\t\tadjustedY = coord.y + Math.random()*radius*sign;\n\t\tif (adjustedY > 1) adjustedY = 1;\n\t\tif (adjustedY < 0) adjustedY = 0;\n\t\tpitchIndex = Math.floor((1-adjustedY) * (pitchMatrix.length-1));\n\t\txModulation = 1-adjustedY;\n\t}\t\n\n\tlet octaveSemitone = pitchMatrix[pitchIndex],\n\t\tsemitone = (octaveSemitone[0]*12) + octaveSemitone[1];\n\n\tlet bitcrusher = props.sequence.bitcrusher || new this.tuna.Bitcrusher({\n    \tbits: 8,\n    \tnormfreq: xModulation,\n    \tbufferSize: 4096\n\t});\n\n\tbitcrusher.normfreq = (xModulation*.1) + .1;\n\n\tlet convolver = props.sequence.convolver || new this.tuna.PingPongDelay({\n\t    wetLevel: 0.5, //0 to 1\n\t    feedback: 0, //0 to 1\n\t    delayTimeLeft: 200, //1 to 10000 (milliseconds)\n\t    delayTimeRight: 350 //1 to 10000 (milliseconds)\n\t});\n\n\tconvolver.wetLevel = xModulation;\n\n\tprops.sequence.bitcrusher = bitcrusher;\n\tprops.sequence.convolver = convolver;\n\n\tsource.playbackRate.value = Math.pow(2, semitone/12);\n\tsource.buffer = buffer;\n\n\tsource.connect(bitcrusher);\n\tbitcrusher.connect(convolver);\n\tconvolver.connect(this.context.destination);\n\tsource.start(when);\n}\n\nWebAudio.prototype.playDummySound = function() {\n\tif (this.playedDummySound) return;\n\n\tlet buffer = this.context.createBuffer(1, 22050, 44100),\n\t\tsource = this.context.createBufferSource();\n\n\tsource.buffer = buffer;\n\tsource.connect(this.context.destination);\n\tsource.start(0);\n\n\tthis.playedDummySound = true\n}\n\n\n/*\n\tinstantiate\n*/\n\nconst filenames = Object.keys(instruments);\n\nconst webAudio = new WebAudio({\n\tbpm: 85, \n\tfilenames\n})\n\n// webAudio.loadSounds();\n// webAudio.loadImpulse();\n\nexport { webAudio }\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/audio/webaudio.js","var Util = {};\n\nUtil.contains = function(arr, val) {\n\tfor (var i=0; i<arr.length; i++) {\n\t\tif (arr[i] === val) return true;\n\t}\n\treturn false;\n}\n\nUtil.unique = function(arr) {\n\tvar newArr = [arr[0]];\n\tfor (var i=1; i<arr.length; i++) {\n\t\tif (this.contains(newArr, arr[i])) continue;\n\t\tnewArr.push(arr[i]);\n\t}\n\treturn newArr;\n}\n\nUtil.resample = function(arr, N) {\n\tif (arr.length <= N) return arr;\n\tvar factor = Math.ceil(arr.length / N),\n\t\tresampled = [],\n\t\tstp = 0;\n\twhile (stp < arr.length) {\n\t\tresampled.push(arr[stp]);\n\t\tstp += factor;\n\t}\n\treturn resampled;\n}\n\nUtil.findMin = function(arr) {\n\tvar ind = -1,\n\t\tminimum = Infinity;\n\tfor (var i=0; i<arr.length; i++) {\n\t\tif (arr[i] < minimum) {\n\t\t\tind = i;\n\t\t\tminimum = arr[i];\n\t\t}\n\t}\n\treturn ind;\n}\n\nUtil.findMax = function(arr) {\n\tvar ind = -1,\n\t\tmaximum = -Infinity;\n\tfor (var i=0; i<arr.length; i++) {\n\t\tif (arr[i] > maximum) {\n\t\t\tind = i;\n\t\t\tmaximum = arr[i];\n\t\t}\n\t}\n\treturn ind;\n}\n\nUtil.sum = function(arr) {\n\tvar cumulative = 0;\n\tfor (var i=0; i<arr.length; i++) {\n\t\tcumulative += arr[i];\n\t}\n\treturn cumulative;\n}\n\nUtil.mean = function(arr) {\n\treturn this.sum(arr) / arr.length;\n}\n\nUtil.combs = function(arr, N) {\n\tvar output = [];\n\tgetAllPossibleCombinations(arr, N, output);\n\treturn output;\n\tfunction getCombinations(array, size, start, initialStuff, output) {\n\t    if (initialStuff.length >= size) {\n\t        output.push(initialStuff);\n\t    } else {\n\t        var i;\n\t        for (i=start; i<array.length; ++i) {\n\t\t    \tgetCombinations(array, size, i + 1, initialStuff.concat(array[i]), output);\n\t        }\n\t    }\n\t}\n\tfunction getAllPossibleCombinations(array, size, output) {\n\t    getCombinations(array, size, 0, [], output);\n\t}\n}\n\nUtil.logicalKeep = function(arr, ind) {\n\tvar newArr = [];\n\tfor (var i=0; i<arr.length; i++) {\n\t\tif (!ind[i]) continue;\n\t\tnewArr.push(arr[i]);\n\t}\n\treturn newArr;\n}\n\nUtil.randId = function(append) {\n\tlet id = Math.random().toString(36).substring(7);\n\tif (append == null) return id;\n\treturn append + id;\n}\n\nUtil.indexOf = function(arr, val) {\n\tfor (let i=0; i<arr.length; i++) {\n\t\tif (arr[i] === val) return i;\n\t}\n\treturn -1;\n}\n\nexport { Util };\n\n\n// WEBPACK FOOTER //\n// ./src/util.js","import { Util } from '../util.js';\n\n/*\n\tVERTICES\n*/\n\nfunction Vertices(pts) {\n\n\tthis.points = [];\n\tthis.pointsSansAnchor = [];\n\tthis.anchorPoint = undefined;\n\tthis.firstPoint = undefined;\n\tthis.hull = undefined;\n\tthis.area = undefined;\n\tthis.signedArea = undefined;\n\tthis.perimeter = undefined;\n\tthis.centroid = undefined;\n\tthis.perimeterEfficiency = undefined;\n\tthis.hullAreaRatio = 0;\n\tthis.hullNRatio = 0;\n\n\tif (pts !== undefined) {\n\t\tthis.addPoints(pts);\n\t}\n}\n\n/*\n\tINIT\n*/\n\nVertices.prototype.constructor = Vertices;\n\nVertices.prototype.addPoints = function(pts) {\n\tfor (var i=0; i<pts.length; i++) {\n\t\tthis.addPoint(pts[i].x, pts[i].y, i);\n\t}\n}\n\nVertices.prototype.addPointsWithIndex = function(pts) {\n\tfor (var i=0; i<pts.length; i++) {\n\t\tthis.addPoint(pts[i].x, pts[i].y, pts[i].index);\n\t}\n}\n\nVertices.prototype.addPoint = function(x, y, index) {\n\tvar ap = this.anchorPoint,\n\t\tpoint = new Point(x, y, index);\n\n    if (ap === undefined) {\n        this.anchorPoint = point;\n        this.firstPoint = point;\n        this.points.push(point);\n        return;\n    } else if (\n        (ap.y > y && ap.x > x) ||\n        (ap.y === y && ap.x > x) ||\n        (ap.y > y && ap.x === x)\n    ) {\n        this.pointsSansAnchor.push(ap);\n        this.anchorPoint = point;\n    } else {\n    \tthis.pointsSansAnchor.push(point);\n    }\n\tthis.points.push(point);\n\tif (this.firstPoint.index > point.index) {\n\t\tthis.firstPoint = point;\n\t}\n};\n\n/*\n\tUTIL\n*/\n\nVertices.prototype.pushFirstPoint = function() {\n\tthis.points.push(this.points[0]);\n}\n\nVertices.prototype.removeLastPoint = function() {\n\tthis.points.splice(this.points.length-1, 1);\n}\n\nVertices.prototype.copyPoints = function(arr) {\n\treturn arr.map(function(pt) {\n\t\treturn new Point(pt.x, pt.y, pt.index);\n\t});\n}\n\nVertices.prototype.copyPoint = function(pt) {\n\treturn new Point(pt.x, pt.y, pt.index);\n}\n\nVertices.prototype.repPoint = function(point, N) {\n\tvar points = [];\n\tfor (let i=0; i<N; i++) {\n\t\tpoints.push(point);\n\t}\n\treturn points;\n}\n\n/*\n\tOPERATIONS\n*/\n\nVertices.prototype.arrayAdd = function(points, b) {\n\tfor (var i=0; i<points.length; i++) {\n\t\tpoints[i].plus(b);\n\t}\n}\n\nVertices.prototype.arrayMinus = function(points, b) {\n\tfor (var i=0; i<points.length; i++) {\n\t\tpoints[i].minus(b);\n\t}\n}\n\nVertices.prototype.arrayTimes = function(points, b) {\n\tfor (var i=0; i<points.length; i++) {\n\t\tpoints[i].times(b);\n\t}\n}\n\nVertices.prototype.arrayDivide = function(points, b) {\n\tfor (var i=0; i<points.length; i++) {\n\t\tpoints[i].divide(b);\n\t}\n}\n\n/*\n\tCONVEX HULL\n*/\n\nVertices.prototype._sortPointsByPolarAngle = function() {\n    var self = this;\n\n    return this.pointsSansAnchor.sort(function(a, b) {\n        var polarA = self._findPolarAngle(self.anchorPoint, a);\n        var polarB = self._findPolarAngle(self.anchorPoint, b);\n\n        if (polarA < polarB) return -1;\n        if (polarA > polarB) return 1;\n        return 0;\n    });\n}\nVertices.prototype._findPolarAngle = function(a, b) {\n    var ONE_RADIAN = 57.295779513082;\n    var deltaX, deltaY;\n\n    if (!a || !b) return 0;\n\n    deltaX = (b.x - a.x);\n    deltaY = (b.y - a.y);\n\n    if (deltaX == 0 && deltaY == 0) return 0;\n\n    var angle = Math.atan2(deltaY, deltaX) * ONE_RADIAN;\n\n    if (this.reverse) {\n        if (angle <= 0) {\n            angle += 360;\n        }\n    } else {\n        if (angle >= 0) {\n            angle += 360;\n        }\n    }\n    return angle;\n}\nVertices.prototype._ccw = function(p0, p1, p2) {\n    var difAngle;\n    var cwAngle = this._findPolarAngle(p0, p1);\n    var ccwAngle = this._findPolarAngle(p0, p2);\n\n    if (cwAngle > ccwAngle) {\n        difAngle = cwAngle - ccwAngle;\n        return !(difAngle > 180);\n    } else if (cwAngle < ccwAngle) {\n        difAngle = ccwAngle - cwAngle;\n        return (difAngle > 180);\n    }\n    return true;\n}\nVertices.prototype.getHull = function() {\n    var hullPoints = [],\n        points,\n        pointsLength;\n\n    this.reverse = this.pointsSansAnchor.every(function(point){\n        return (point.x < 0 && point.y < 0);\n    });\n\n    points = this._sortPointsByPolarAngle();\n    pointsLength = points.length;\n\n    if (pointsLength < 3) {\n        points.unshift(this.anchorPoint);\n        return points;\n    }\n\n    hullPoints.push(points.shift(), points.shift());\n\n    while (true) {\n        var p0,\n            p1,\n            p2;\n\n        hullPoints.push(points.shift());\n\n        p0 = hullPoints[hullPoints.length - 3];\n        p1 = hullPoints[hullPoints.length - 2];\n        p2 = hullPoints[hullPoints.length - 1];\n\n        if (this._ccw(p0, p1, p2)) {\n            hullPoints.splice(hullPoints.length - 2, 1);\n        }\n\n        if (points.length == 0) {\n            if (pointsLength == hullPoints.length) {\n                var ap = this.anchorPoint;\n                hullPoints = hullPoints.filter(function(p) { return !!p; });\n                if (!hullPoints.some(function(p){\n                        return(p.x == ap.x && p.y == ap.y);\n                    })) {\n                    hullPoints.unshift(this.anchorPoint);\n                }\n                return hullPoints;\n            }\n            points = hullPoints;\n            pointsLength = points.length;\n            hullPoints = [];\n            hullPoints.push(points.shift(), points.shift());\n        }\n    }\n}\n\n/*\n\tUPDATES\n*/\n\nVertices.prototype.updateMost = function() {\n\tthis.updatePerimeter();\n\tthis.updateArea();\n\tthis.updatePerimeterEfficiency();\n\tthis.updateCentroid();\n}\n\nVertices.prototype.updateAll = function() {\n\tthis.updateMost();\n\tthis.updateHull();\n\tthis.updateHullAreaRatio();\n\tthis.updateHullNRatio();\n}\n\nVertices.prototype.updateAllExceptHull = function() {\n\tthis.updateMost();\n}\n\nVertices.prototype.updateHull = function() {\n\tvar hullPoints = this.getHull(),\n\t\thull = new Vertices();\n\thull.addPointsWithIndex(hullPoints);\n\thull.updateAllExceptHull();\n\thull.hull = hull;\n\tthis.hull = hull;\n}\n\nVertices.prototype.updateCentroid = function() {\n\tif (this.area === undefined) this.updateArea();\n\tthis.pushFirstPoint();\n\tthis.centroid = this.getCentroid(this.points, this.signedArea);\n\tthis.removeLastPoint();\n}\n\nVertices.prototype.updatePerimeter = function() {\n\tthis.pushFirstPoint();\n\tthis.perimeter = this.getPerimeter(this.points);\n\tthis.removeLastPoint();\n}\n\nVertices.prototype.updateArea = function() {\n\tthis.pushFirstPoint();\n\tvar area = this.getArea(this.points);\n\tthis.area = Math.abs(area);\n\tthis.signedArea = area;\n\tthis.removeLastPoint();\n}\n\nVertices.prototype.updatePerimeterEfficiency = function() {\n\tif (this.area === undefined || this.perimeter === undefined) {\n\t\tthis.updateArea();\n\t\tthis.updatePerimeter();\n\t}\n\tvar\tarea = this.area,\n\t\tperim = this.perimeter;\n\tthis.perimeterEfficiency = this.getPerimeterEfficiency(area, perim);\n}\n\nVertices.prototype.updateHullAreaRatio = function() {\n\tif (this.area === undefined || this.hull === undefined) return;\n\tthis.hullAreaRatio = this.hull.area / this.area;\n}\n\nVertices.prototype.updateHullNRatio = function() {\n\tif (this.hull === undefined) return;\n\tthis.hullNRatio = this.hull.points.length / this.points.length\n}\n\n/*\n\tBASIC GEOMETRY\n*/\n\nVertices.prototype.getPerimeter = function(points) {\n\tvar perim = 0,\n\t\tx1, x2, y1, y2;\n\tfor (var i=1; i<points.length; i++) {\n\t\tx1 = points[i-1].x;\n\t\tx2 = points[i].x;\n\t\ty1 = points[i-1].y;\n\t\ty2 = points[i].y;\n\t\tvar xsq = Math.pow(x2-x1, 2),\n\t\t\tysq = Math.pow(y2-y1, 2);\n\t\tperim += Math.sqrt(xsq + ysq);\n\t}\n\treturn perim\n}\n\nVertices.prototype.getArea = function(points) {\n\tvar x1, y1, x2, y2, sum = 0;\n\tfor (var i=0; i<points.length-1; i++) {\n\t\tx1 = points[i].x;\n\t\tx2 = points[i+1].x;\n\t\ty1 = points[i].y;\n\t\ty2 = points[i+1].y;\n\t\tsum += (x1*y2) - (y1*x2);\n\t}\n\treturn sum/2\n}\n\nVertices.prototype.getPerimeterEfficiency = function(area, perim) {\n\treturn (2*Math.sqrt(Math.PI*area))/perim\n}\n\nVertices.prototype.getCentroid = function(points, area) {\n\tif (area === undefined) {\n\t\tarea = getArea(points);\n\t}\n\tvar xs = points.map(function(point) { return point.x }),\n\t\tys = points.map(function(point) { return point.y });\n\n\tvar Cx = 0, \n\t\tCy = 0;\n\n\tfor (var i = 0; i<xs.length-1; i++) {\n\t\tvar x0 = xs[i],\n\t\t\tx1 = xs[i+1],\n\t\t\ty0 = ys[i],\n\t\t\ty1 = ys[i+1],\n\t\t\tB = (x0*y1 - x1*y0);\n\t\tCx += (x0+x1) * B;\n\t\tCy += (y0+y1) * B;\n\t}\n\n\tCx /= (6*area);\n\tCy /= (6*area);\n\n\treturn new Point(Cx, Cy, 0);\n}\n\nVertices.prototype.getDistances = function(point, points) {\n\tvar dist = [];\n\tfor (var i=0; i<points.length; i++) {\n\t\tdist.push(this.getDistance(point, points[i]));\n\t}\n\treturn dist;\n}\n\nVertices.prototype.getDistance = function(a, b) {\n\treturn Math.sqrt(Math.pow(b.x-a.x, 2) + Math.pow(b.y-a.y, 2));\n}\n\nVertices.prototype.getPerpendicularDistance = function(p, v, w) {\n\tfunction sqr(x) { return x * x }\n\tfunction dist2(v, w) { return sqr(v.x - w.x) + sqr(v.y - w.y) }\n\tfunction distToSegmentSquared(p, v, w) {\n\t  var l2 = dist2(v, w);\n\t  if (l2 == 0) return dist2(p, v);\n\t  var t = ((p.x - v.x) * (w.x - v.x) + (p.y - v.y) * (w.y - v.y)) / l2;\n\t  t = Math.max(0, Math.min(1, t));\n\t  return dist2(p, { x: v.x + t * (w.x - v.x),\n\t                    y: v.y + t * (w.y - v.y) });\n\t}\n\treturn Math.sqrt(distToSegmentSquared(p, v, w));\n}\n\nVertices.prototype.getConsecutiveDistances = function(points) {\n\tvar D = [], a, b;\n\tfor (var i=0; i<points.length-1; i++) {\n\t\ta = points[i];\n\t\tb = points[i+1];\n\t\tD.push(this.getDistance(a, b));\n\t}\n\treturn D;\n}\n\nVertices.prototype.getSlope = function(p1, p2) {\n\treturn (p2.y - p1.y) / (p2.x - p1.x);\n}\n\nVertices.prototype.getLineEquationY = function(p1, p2) {\n\tvar m = this.getSlope(p1, p2),\n\t\tb = p2.y - (m * p2.x),\n\t\tfunc = function(x) { return m * x + b; };\n\treturn func;\n}\n\nVertices.prototype.getLineEquationX = function(p1, p2) {\n\tvar m = this.getSlope(p1, p2),\n\t\tb = p2.y - (m * p2.x),\n\t\tfunc = function(y) { return (y - b)/m; };\n\treturn func;\n}\n\nVertices.prototype.getXAlongLineAtY = function(y, p1, p2) {\n\tvar func = this.getLineEquationX(p1, p2);\n\treturn func(y);\n}\n\nVertices.prototype.getYAlongLineAtX = function(x, p1, p2) {\n\tvar func = this.getLineEquationY(p1, p2);\n\treturn func(x);\n}\n\nVertices.prototype.getAngle = function(p1, p2, p3) {\n\tvar p12 = this.getDistance(p1, p2),\n\t\tp13 = this.getDistance(p1, p3),\n\t\tp23 = this.getDistance(p2, p3),\n\t\tA1 = Math.pow(p12, 2),\n\t\tA2 = Math.pow(p13, 2),\n\t\tA3 = Math.pow(p23, 2);\n\treturn Math.acos((A1 + A2 - A3) / (2 * p12 * p13));\n}\n\n/*\n\tCONDITIONS\n*/\n\nVertices.prototype.isNearVertex = function(p1, p2, bounds) {\n\treturn this.getDistance(p1, p2) <= bounds;\n}\n\nVertices.prototype.isNearVertices = function(points, p2, bounds) {\n\tvar M = [];\n\tfor (var i=0; i<points.length; i++) {\n\t\tM.push(this.isNearVertex(points[i], p2, bounds));\n\t}\n\treturn M;\n}\n\nVertices.prototype.doesIntersect = function(p1, p2, p3, bounds) {\n\tvar m = this.getSlope(p2, p3),\n\t\tb = p2.y - (m * p2.x),\n\t\ty = m * p1.x + b;\n\treturn Math.abs(y-p1.y) <= bounds;\n}\n\n/*\n\tPOINT\n*/\n\nfunction Point(x, y, index) {\n\tthis.x = x;\n\tthis.y = y;\n\tthis.index = index;\n}\n\nPoint.prototype.constructor = Point;\n\nPoint.prototype.copy = function() {\n\treturn new Point(this.x, this.y, this.index);\n}\n\nPoint.prototype.minus = function(b) {\n\tif (b instanceof Point) {\n\t\tthis.x -= b.x;\n\t\tthis.y -= b.y;\n\t} else {\n\t\tthis.x -= b;\n\t\tthis.y -= b;\n\t}\n}\n\nPoint.prototype.plus = function(b) {\n\tif (b instanceof Point) {\n\t\tthis.x += b.x;\n\t\tthis.y += b.y;\n\t} else {\n\t\tthis.x += b;\n\t\tthis.y += b;\n\t}\n}\n\nPoint.prototype.times = function(b) {\n\tif (b instanceof Point) {\n\t\tthis.x *= b.x;\n\t\tthis.y *= b.y;\n\t} else {\n\t\tthis.x *= b;\n\t\tthis.y *= b;\n\t}\n}\n\nPoint.prototype.divide = function(b) {\n\tif (b instanceof Point) {\n\t\tthis.x /= b.x;\n\t\tthis.y /= b.y;\n\t} else {\n\t\tthis.x /= b;\n\t\tthis.y /= b;\n\t}\n}\n\nexport { Vertices, Point }\n\n\n// WEBPACK FOOTER //\n// ./src/geometry/vertices.js","const Instruments = {\n\t'piano_g.mp3': {\n\t\tcolor: [255, 0, 255]\n\t},\n\t'celeste_g.mp3': {\n\t\tcolor: [66, 244, 134]\n\t},\n\t'808_hi.mp3': {\n\t\tcolor: [0, 255, 255]\n\t},\n\t'perc_kick.mp3': {\n\t\tcolor: [255, 165, 0]\n\t},\n}\n\nlet keys = Object.keys(Instruments);\nkeys.map(function(key) {\n\tlet color = Instruments[key].color,\n\t\trgbString = 'rgb(' + color.join(',') + ')';\n\tInstruments[key].rgbString = rgbString;\n});\n\nexport default Instruments;\n\n\n// WEBPACK FOOTER //\n// ./src/audio/instruments.js","//\tdefine sequence templates here\n\nconst getSequenceConstraints = function() {\n\tlet semitones = [];\n\tfor (let i=1; i<13; i++) {\n\t\tsemitones.push(i);\n\t}\n\treturn [\n\t\t// {\n\t\t// \tname: 'major1',\n\t\t// \tsemitones: [ 0, 7, 9 ],\n\t\t// \toctaves: [ -2, -1, 0, 1, 2 ],\n\t\t// \tstyle: 'random',\n\t\t// \tcolor: 'blue',\n\t\t// \trgb: [ 255, 40, 255 ]\n\t\t// },\n\t\t{\n\t\t\tname: 'minor1',\n\t\t\tsemitones: [ 2, 5, 10 ],\n\t\t\toctaves: [ -2, -1, 0, 1, 2 ],\n\t\t\tstyle: 'random',\n\t\t\tcolor: 'red',\n\t\t\trgb: [ 255, 255, 200 ]\n\t\t},\n\t\t{\n\t\t\tname: 'minor2',\n\t\t\tsemitones: [ 3, 7 ],\n\t\t\toctaves: [ -2, -1, 0, 1, 2 ],\n\t\t\tstyle: 'random',\n\t\t\tcolor: 'green',\n\t\t\trgb: [ 255, 200, 255 ]\n\t\t},\n\t\t{\n\t\t\tname: 'minor3',\n\t\t\tsemitones: [ 3, 5, 7, 9, 10 ],\n\t\t\toctaves: [ -2, -1, 0, 1, 2 ],\n\t\t\tstyle: 'random',\n\t\t\tcolor: 'blue',\n\t\t\trgb: [ 255, 200, 255 ]\n\t\t},\n\t\t{\n\t\t\tname: 'full',\n\t\t\tsemitones: semitones,\n\t\t\toctaves: [ -2, -1, 0, 1, 2 ],\n\t\t\tstyle: 'random',\n\t\t\tcolor: 'black',\n\t\t\trgb: [ 255, 40, 255 ]\n\n\t\t},\n\t].map(function(sequence) {\n\t\tsequence.pitchMatrix = matrixMaker(sequence);\n\t\treturn sequence;\n\t});\n}\n\n//\tcombine into a matrix of [octave, semitone] pairs\n\nfunction matrixMaker(sequence) {\n\tlet semitones = sequence.semitones,\n\t\toctaves = sequence.octaves;\n\n\treturn octaves.reduce(function(combined, octave) {\n\t\tfor (let i=0; i<semitones.length; i++) {\n\t\t\tcombined.push([octave, semitones[i]]);\n\t\t}\n\t\treturn combined;\n\t}, []);\n}\n\nexport { getSequenceConstraints }\n\n\n// WEBPACK FOOTER //\n// ./src/audio/constraints.js","import { Util } from '../util.js';\nimport { Vertices, Point } from './vertices.js'\n\n/*\n\tSHAPE -- Rectangle, Triangle, Random ...\n*/\n\nfunction Shape(vertices, identity) {\n\tthis.vertices = vertices;\n\tthis.points = vertices.points;\n\tthis.identity = identity;\n\tthis.canvas = undefined;\n\tthis.previousCanvasWidth = undefined;\n\tthis.previousCanvasHeight = undefined;\n\tthis.getCenter();\n}\n\nShape.prototype.constructor = Shape;\n\nShape.prototype.getRescaledVertices = function(oldWidth, oldHeight, newWidth, newHeight) {\n\tif (oldWidth === newWidth && oldHeight === newHeight) return;\n\tlet verts = this.vertices,\n\t\tscaleVecA = new Point(oldWidth, oldHeight, 0),\n\t\tscaleVecB = new Point(newWidth/oldWidth, newHeight/oldHeight, 0),\n\t\tcenter,\n\t\tpoints_;\n\tif (this.points.length > 1) {\n\t\tcenter = verts.copyPoint(this.center)\n\t} else {\n\t\tcenter = this.points[0];\n\t}\n\n\tcenter.divide(scaleVecA);\n\tcenter.times(new Point(newWidth, newHeight, 0));\n\n\tif (this.points.length > 1 ) {\n\t\tpoints_ = verts.copyPoints(this.points);\n\t\tverts.arrayMinus(points_, this.center);\n\t\tverts.arrayTimes(points_, scaleVecB);\n\t\tverts.arrayAdd(points_, center);\n\t} else {\n\t\tpoints_ = [center];\n\t}\n\n\treturn new Vertices(points_);\n}\n\nShape.prototype.rescale = function(pwidth, pheight, nwidth, nheight) {\n\tlet newVertices = this.getRescaledVertices(pwidth, pheight, nwidth, nheight);\n\tthis.vertices = newVertices;\n\tthis.points = newVertices.points;\n\tthis.update();\n}\n\nShape.prototype.update = function() {\n\tthis.vertices.updateAllExceptHull();\n\tthis.getCenter();\n}\n\nShape.prototype.getCenter = function() {\n\tthis.center = this.vertices.centroid;\n}\n\nShape.prototype.centerOn = function(pt) {\n\tpt.minus(this.center);\n\tthis.vertices.arrayAdd(this.points, pt);\n\tthis.update();\n}\n\nShape.prototype.isNearVertices = function(coord, bounds) {\n\treturn this.vertices.isNearVertices(this.points, coord, bounds);\n}\n\nShape.prototype.getVerticesNear = function(coord, bounds) {\n\tvar index = this.isNearVertices(coord, bounds);\n\treturn Util.logicalKeep(this.points, index);\n}\n\nShape.prototype.isNearCenter = function(coord, bounds) {\n\treturn this.vertices.isNearVertices([this.center], coord, bounds)[0];\n}\n\n/*\n\tDISPLAY\n*/\n\nShape.prototype.drawLine = function(canvas, doClear) {\n\tif (typeof doClear == 'undefined') doClear = true;\n\tvar ctx = canvas.getContext('2d'),\n\t\tpoints = this.vertices.copyPoints(this.points);\n\tpoints.push(points[0]);\n\tif (doClear)  ctx.clearRect(0, 0, canvas.width, canvas.height);\n\tfor (var i=0; i<points.length-1; i++) {\n\t\tctx.beginPath();\n\t\tctx.moveTo(points[i].x, points[i].y);\n\t\tctx.lineTo(points[i+1].x, points[i+1].y);\n\t\t// ctx.moveTo(points[i].x*canvas.width/2, points[i].y*canvas.height/2);\n\t\t// ctx.lineTo(points[i+1].x*canvas.width/2, points[i+1].y*canvas.height/2);\n\t\tctx.strokeStyle = 'gray';\n\t\tctx.lineWidth = 5;\n\t\tctx.stroke();\n\t}\n}\n\nShape.prototype.drawDots = function(canvas, width, doClear) {\n\tif (typeof doClear == 'undefined') doClear = true;\n\tvar ctx = canvas.getContext('2d'),\n\t\tpoints = this.vertices.copyPoints(this.points);\n\t\tpoints.push(this.center);\n\tif (doClear)  ctx.clearRect(0, 0, canvas.width, canvas.height);\n\tlet canvasWidth = canvas.width/2,\n\t\tcanvasHeight = canvas.height/2;\n\tfor (var i=0; i<points.length; i++) {\n\t\t// var x = points[i].x - width/2;\n\t\t// var y = points[i].y - width/2;\n\t\t// ctx.fillRect(x, y, width, width);\n\t\tlet x = points[i].x,\n\t\t\ty = points[i].y,\n\t\t\tr = width/2;\n\t\tctx.beginPath();\n\t\tctx.arc(x, y, r, 0, Math.PI*2);\n\t\tctx.closePath();\n\t\tctx.fillStyle = 'gray';\n\t\tctx.fill();\n\t}\n}\n\n/*\n\tLINE\n*/\n\t\nfunction Line(vertices) {\n\tvar N = vertices.points.length - 1;\n\tthis.vertices = vertices;\n\tthis.points = [vertices.points[0], vertices.points[N]];\n\tthis.identity = 'line';\n\tthis.getCenter();\n}\n\nLine.prototype = Object.create(Shape.prototype);\n\nLine.prototype.constructor = Line;\n\nLine.prototype.getCenter = function() {\n\tvar points = this.points,\n\t\tverts = this.vertices,\n\t\tx = (points[1].x - points[0].x) / 2 + points[0].x,\n\t\ty = verts.getYAlongLineAtX(x, points[0], points[1]);\n\tthis.center = new Point(x, y, 0);\n}\n\nLine.prototype.rescale = function(pwidth, pheight, nwidth, nheight) {\n\tlet newVertices = this.getRescaledVertices(pwidth, pheight, nwidth, nheight),\n\t\tN = newVertices.points.length - 1;\n\tthis.vertices = newVertices;\n\tthis.points = [newVertices.points[0], newVertices.points[N]]\n\tthis.update();\n}\n\n/*\n\tCIRCLE\n*/\n\nfunction Circle(vertices, center, radius) {\n\tthis.vertices = vertices;\n\tthis.center = center;\n\tthis.radius = radius;\n\tthis.points = [center];\n\tthis.identity = 'circle';\n}\n\nCircle.prototype = Object.create(Shape.prototype);\n\nCircle.prototype.constructor = Circle;\n\nCircle.prototype.rescale = function(oldWidth, oldHeight, newWidth, newHeight) {\n\tif (oldWidth === newWidth && oldHeight === newHeight) return;\n\tlet verts = this.vertices,\n\t\tscaleVecA = new Point(oldWidth, oldHeight, 0),\n\t\tscaleVecB = new Point(newWidth/oldWidth, newHeight/oldHeight, 0),\n\t\tcenter = this.center,\n\t\tradiusScale = ((newWidth/oldWidth) + (newHeight/oldHeight))/2;\n\n\tcenter.divide(scaleVecA);\n\tcenter.times(new Point(newWidth, newHeight, 0));\n\tthis.radius *= radiusScale;\n}\n\nCircle.prototype.update = function() {\n\tthis.vertices.updateAllExceptHull();\n}\n\nCircle.prototype.drawLine = function(canvas, doClear) {\n\tif (typeof doClear == 'undefined') doClear = true;\n\tvar ctx = canvas.getContext('2d'),\n\t\tpoint = this.points[0],\n\t\tr = this.radius;\n\tif (doClear) ctx.clearRect(0, 0, canvas.width, canvas.height);\n\tctx.beginPath();\n\tctx.arc(point.x, point.y, r, 0, Math.PI*2);\n\tctx.strokeStyle = 'gray';\n\tctx.lineWidth = 5;\n\tctx.stroke();\n}\n\nexport { Shape, Line, Circle }\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/geometry/shape.js","import { eventBus } from './eventbus.js';\n\nfunction World() {\n\tthis.shapes = [];\n\tthis.subscribe();\n\tthis.editedSequenceId = undefined;\n\tthis.activeSequenceIds = [];\n\tthis.activeSequenceSetId = undefined;\n\tthis.mode = undefined;\n\tthis.canvas = undefined;\n\tthis.arrangementCanvases = [];\n}\n\nWorld.prototype.constructor = World;\n\nWorld.prototype.subscribe = function() {\n\tlet newShapeReadyTopic = eventBus.topicMap.newShapeReady,\n\t\tnewSequenceSetCreatedTopic = eventBus.topicMap.newSequenceSetCreated,\n\t\tnewSequenceCreatedTopic = eventBus.topicMap.newSequenceCreated,\n\t\tnewActiveSequenceTopic = eventBus.topicMap.newActiveSequence,\n\t\tnewActiveSequenceSetTopic = eventBus.topicMap.newActiveSequenceSet,\n\t\tmodeChangeTopic = eventBus.topicMap.modeChange,\n\t\tcanvasResizeTopic = eventBus.topicMap.canvasResize,\n\t\tclearShapeTopic = eventBus.topicMap.clearShape,\n\t\tnewSurfaceTopic = eventBus.topicMap.newSurface;\n\n\teventBus.subscribe(newSequenceSetCreatedTopic, this.registerSequenceSet.bind(this));\n\teventBus.subscribe(newSequenceCreatedTopic, this.registerSequence.bind(this));\n\teventBus.subscribe(newShapeReadyTopic, this.registerShape.bind(this));\n\teventBus.subscribe(newActiveSequenceTopic, this.updateActiveSequence.bind(this));\n\teventBus.subscribe(newActiveSequenceSetTopic, this.updateActiveSequenceSet.bind(this));\n\teventBus.subscribe(modeChangeTopic, this.updateMode.bind(this));\n\teventBus.subscribe(canvasResizeTopic, this.updateShapeSizes.bind(this));\n\teventBus.subscribe(clearShapeTopic, this.clearShape.bind(this));\n\teventBus.subscribe(newSurfaceTopic, this.handleNewSurface.bind(this));\n}\n\nWorld.prototype.handleNewSurface = function(data) {\n\tlet element = data.element,\n\t\tvalues = data.values,\n\t\ttype = values.type;\n\tif (type === 'INSTRUMENT') {\n\t\tthis.canvas = element;\n\t\treturn;\n\t}\n\tlet canvasIndex = this.getIndexOfSurface(values.index, values.sequenceSetId),\n\t\tcanvasObject = {\n\t\t\tindex: values.index,\n\t\t\tsequenceSetId: values.sequenceSetId,\n\t\t\tcanvas: element\n\t\t};\n\tif (canvasIndex === -1) {\n\t\tthis.arrangementCanvases.push(canvasObject);\n\t} else {\n\t\tthis.arrangementCanvases[canvasIndex].canvas = element;\n\t}\n}\n\nWorld.prototype.updateMode = function(data) {\n\tthis.mode = data;\n}\n\nWorld.prototype.clearShape = function(data) {\n\tlet newShapeReadyTopic = eventBus.topicMap.newShapeReady,\n\t\tsequenceId = this.editedSequenceId,\n\t\tsequenceSetId = this.activeSequenceSetId;\n\teventBus.publish(newShapeReadyTopic, {\n\t\tshape: undefined, \n\t\tsequenceId, \n\t\tsequenceSetId\n\t});\n}\n\nWorld.prototype.updateEditedSequence = function() {\n\tlet index = this.findActiveSequenceIdBySequenceSetId(this.activeSequenceSetId);\n\tthis.editedSequenceId = this.activeSequenceIds[index].sequenceId;\n}\n\nWorld.prototype.updateActiveSequence = function(data) {\n\tlet sequenceSetId = data.sequenceSetId,\n\t\tsetId = data.sequenceId,\n\t\tindex = this.findActiveSequenceIdBySequenceSetId(sequenceSetId);\n\tthis.activeSequenceIds[index].sequenceId = setId;\n\tthis.updateEditedSequence();\n}\n\nWorld.prototype.updateActiveSequenceSet = function(data) {\n\tthis.activeSequenceSetId = data.sequenceSetId;\n\tthis.updateEditedSequence();\n}\n\nWorld.prototype.registerSequenceSet = function(data) {\n\tthis.activeSequenceIds.push({\n\t\tsequenceSetId: data.sequenceSetId,\n\t\tsequenceId: undefined\n\t});\n}\n\nWorld.prototype.registerSequence = function(data) {\n\tdata.shape = undefined;\n\tthis.registerShape(data);\n}\n\nWorld.prototype.registerShape = function(data) {\n\tlet shape = data.shape,\n\t\tsequenceId = data.sequenceId,\n\t\tsequenceSetId = data.sequenceSetId;\n\tif (this.isShapeWithSequenceId(sequenceId)) {\n\t\tvar ind = this.findShapeBySequenceId(sequenceId);\n\t\tthis.shapes[ind].shape = shape;\n\t} else {\n\t\tthis.shapes.push({\n\t\t\tshape,\n\t\t\tsequenceId,\n\t\t\tsequenceSetId\n\t\t});\n\t}\n}\n\nWorld.prototype.updateShapeSize = function(shape, newWidth, newHeight) {\n\tlet prevWidth = shape.previousCanvasWidth,\n\t\tprevHeight = shape.previousCanvasHeight;\n\tif (prevWidth === undefined) {\n\t\tshape.previousCanvasWidth = newWidth,\n\t\tshape.previousCanvasHeight = newHeight;\n\t\treturn;\n\t} else if (shape === undefined \n\t\t\t|| (newWidth === prevWidth \n\t\t\t&& newHeight === prevHeight)) {\n\t\treturn;\n\t}\n\tif (this.mode === 'ARRANGEMENT') return;\n\tif (newWidth === 0 && newHeight === 0) return;\n\tshape.rescale(prevWidth, prevHeight, newWidth, newHeight);\n\tshape.previousCanvasWidth = newWidth;\n\tshape.previousCanvasHeight = newHeight;\n}\n\nWorld.prototype.updateShapeSizes = function(data) {\n\tfor (let i=0; i<this.shapes.length; i++) {\n\t\tlet shape = this.shapes[i].shape;\n\t\tif (shape === undefined) continue;\n\t\tthis.updateShapeSize(shape, data.canvasWidth, data.canvasHeight);\n\t}\n}\n\nWorld.prototype.findActiveSequenceIdBySequenceSetId = function(id) {\n\tfor (let i=0; i<this.activeSequenceIds.length; i++) {\n\t\tif (this.activeSequenceIds[i].sequenceSetId === id) return i;\n\t}\n\treturn -1;\n}\n\nWorld.prototype.getShapesBySequenceSetId = function(id) {\n\treturn this.shapes.filter(function(shape) {\n\t\treturn shape.sequenceSetId === id;\n\t}).shape;\n}\n\nWorld.prototype.getShapeBySequenceId = function(id) {\n\tvar ind = this.findShapeBySequenceId(id);\n\tif (ind === -1) return undefined;\n\treturn this.shapes[ind].shape;\n}\n\nWorld.prototype.getEditedShape = function() {\n\treturn this.getShapeBySequenceId(this.editedSequenceId);\n}\n\nWorld.prototype.findShapeBySequenceId = function(id) {\n\tfor (var i=0; i<this.shapes.length; i++) {\n\t\tif (this.shapes[i].sequenceId === id) return i;\n\t}\n\treturn -1;\n}\n\nWorld.prototype.isShapeWithSequenceId = function(id) {\n\treturn this.findShapeBySequenceId(id) !== -1;\n}\n\nWorld.prototype.getIndexOfSurface = function(index, setId) {\n\tfor (let i=0; i<this.arrangementCanvases.length; i++) {\n\t\tlet canvasSet = this.arrangementCanvases[i];\n\t\tif (canvasSet.index === index && canvasSet.sequenceSetId === setId) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\nconst world = new World();\n\nexport { world };\n\n\n// WEBPACK FOOTER //\n// ./src/world.js","import { webAudio } from '../audio/webaudio.js';\nimport { eventBus } from '../eventbus.js';\nimport { SequenceSets } from '../audio/sequencesets.js';\n\nconst sequenceSetManager = new SequenceSets(),\n\tNSETS = 4,\n\tNSEQUENCES = 1,\n\tfilenames = webAudio.filenames;\n\nfor (let i=0; i<NSETS; i++) {\n\tlet set = sequenceSetManager.createSet(filenames[i]),\n\t\ttopic = eventBus.topicMap.newActiveSequenceSet;\n\teventBus.publish(topic, {sequenceSetId: set.id});\n\tfor (let j=0; j<NSEQUENCES; j++) {\n\t\tset.createSequence(set.filename, j);\n\t}\n}\n\nexport { sequenceSetManager };\n\n\n\n// WEBPACK FOOTER //\n// ./src/audio/setup.js","import { eventBus } from '../eventbus.js';\nimport { webAudio } from '../audio/webaudio.js';\nimport { world } from '../world.js';\nimport { Animator } from '../animation/animator.js';\nimport { Interaction } from '../interaction.js';\n\nlet awaitCanvas = new Promise(function(resolve, reject) {\n\teventBus.subscribe('newSurface', function(data) {\n\t\tresolve(data);\n\t});\n});\n\nawaitCanvas.then(postCanvasRetrieval);\n\nfunction postCanvasRetrieval(data) {\n\tvar\tcanvas = data.element,\n\t\tanimator = new Animator(world, canvas),\n\t\tinteraction = new Interaction(world, animator);\n\n\tinteraction.handleTouch();\n\tanimator.sizeCanvas();\n}\n\n\n// WEBPACK FOOTER //\n// ./src/interface/setup.js","import Vue from 'vue'\nimport Router from 'vue-router'\nimport Hello from '@/components/Hello'\n\nVue.use(Router)\n\nexport default new Router({\n  routes: [\n    {\n      path: '/',\n      name: 'Hello',\n      component: Hello\n    }\n  ]\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-bd26cd6c\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar Component = require(\"!../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"),\n  /* template */\n  require(\"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-bd26cd6c\\\"}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  null,\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = 50\n// module chunks = 1","<template>\n\t<div id=\"app\">\n\t\t<sequencer v-if=\"soundsAreLoaded()\"></sequencer>\n\t\t<div v-else>\n\t\t\tLoading ...\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport Sequencer from './components/Sequencer';\n\nexport default {\n\tname: 'app',\n\tcomponents: { Sequencer },\n\tmethods: {\n\t\tsoundsAreLoaded() {\n\t\t\treturn this.$store.state.soundsAreLoaded\n\t\t}\n\t}\n}\n</script>\n\n<style>\n\nbody {\n\tmargin: 0;\n\tpadding: 0;\n}\n\n#app {\n\theight: 100%;\n\twidth: 100%;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// App.vue?a11c2580","<template>\n\t<div class=\"container\" :style=\"getContainerStyle()\">\n\t\t<div v-if=\"canAddColumn() || canDeleteColumn()\" class=\"row interface\">\n\t\t\t<div v-if=\"canDeleteColumn()\" @click=\"deleteColumn()\" class=\"cell minusCircle\">\n\t\t\t\t<div class=\"bar horizontalpx\"></div>\n\t\t\t</div>\n\t\t\t<div v-if=\"canAddColumn()\" @click=\"createColumn()\" class=\"cell plusCircle\">\n\t\t\t\t<div class=\"bar horizontalpx\"></div>\n  \t\t\t<div class=\"bar verticalpx\"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-for=\"set in sequenceSets\" class=\"row interface\">\n\t\t\t<cell v-for=\"n in set.sequences.length\" :index=\"n-1\" :key=\"set.sequences[n-1].id\"\n\t\t\t:sequenceId=\"set.sequences[n-1].id\" :sequenceSetId=\"set.id\"></cell>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { eventBus } from '../eventbus.js';\nimport Cell from './Cell.vue';\n\nexport default {\n\tname: 'arrangement',\n\tcomponents: { Cell },\n\tcomputed: {\n\t\tsequenceSets() {\n\t\t\treturn this.$store.state.sequenceSetManager.sequenceSets;\n\t\t}\n\t},\n\tmethods: {\n\t\tgetContainerStyle() {\n\t\t\tlet manager = this.$store.state.sequenceSetManager,\n\t\t\t\taddExtraHeight = this.canAddColumn() || this.canDeleteColumn(),\n\t\t\t\tmaxHeight = (manager.sequenceSets.length * 50);\n\t\t\tif (addExtraHeight) maxHeight += 50;\n\t\t\tmaxHeight = maxHeight.toString() + 'px';\n\t\t\tlet maxWidth = (manager.sequenceSets[0].sequences.length * 50) + 'px';\n\t\t\treturn {\n\t\t\t\tmaxWidth,\n\t\t\t\tmaxHeight\n\t\t\t};\n\t\t},\n\t\tcreateColumn() {\n\t\t\tlet manager = this.$store.state.sequenceSetManager,\n\t\t\t\tnColumns = manager.sequenceSets[0].sequences.length,\n\t\t\t\tmaxNColumns = manager.maxNColumns;\n\t\t\tif (nColumns === maxNColumns-1) {\n\t\t\t\tthis.$store.commit('updateColumnAdding', false);\n\t\t\t}\n\t\t\tmanager.createNextColumn();\n\t\t\tthis.$forceUpdate();\n\t\t},\n\t\tdeleteColumn() {\n\t\t\tlet manager = this.$store.state.sequenceSetManager,\n\t\t\t\tnColumns = manager.sequenceSets[0].sequences.length;\n\t\t\tif (nColumns === 1) {\n\t\t\t\tthis.$store.commit('updateColumnDelete', false);\n\t\t\t} else {\n\t\t\t\tmanager.deleteLastColumn();\n\t\t\t}\n\t\t\tthis.$forceUpdate();\n\t\t},\n\t\tcanAddColumn() {\n\t\t\tlet manager = this.$store.state.sequenceSetManager,\n\t\t\t\tdidShowPlus = this.$store.state.didShowPlus,\n\t\t\t\tcanAddColumn = manager.canAddMoreColumns(),\n\t\t\t\tshapesExist = manager.allShapesExist(0);\n\n\t\t\tif (!canAddColumn) return false;\n\t\t\tif (!didShowPlus && !shapesExist) return false;\n\t\t\tif (!didShowPlus && shapesExist) {\n\t\t\t\tthis.$store.commit('updateDidShowPlus', true);\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tcanDeleteColumn() {\n\t\t\tlet manager = this.$store.state.sequenceSetManager;\n\t\t\treturn manager.sequenceSets[0].sequences.length > 1;\n\t\t}\n\t}\n}\n</script>\n\n<style type=\"text/css\">\n\t@import '../style/_style.scss';\n</style>\n\n<style scoped>\n\n.minusCircle {\n\twidth: 25px;\n  height: 25px;\n  position: relative;\n}\n\n.plusCircle {\n  width: 25px;\n  height: 25px;\n  position: relative;\n}\n\n.bar {\n  margin: 0 auto;\n  position: absolute;\n  background-color: white;\n}\n\n.horizontalpx {\n\twidth: 25px;\n\theight: 6.25px;\n\tleft: 12.5px;\n\ttop: 21.875px;\n}\n\n.verticalpx {\n\theight: 25px;\n\twidth: 6.25px;\n\ttop: 12.5px;\n\tleft: 21.875px;\n}\n\n.container {\n\tdisplay: flex;\n\tflex-direction: column;\n\theight: 95%;\n\tmax-height: 250px;\n\twidth: 95%;\n\ttop: 0px;\n\tleft: 0px;\n\t/*overflow: scroll;*/\n\toverflow: hidden;\n}\n\n.row {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\theight: 50px;\n\tmin-height: 50px;\n\twidth: 100%;\n}\n\n.cell {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\theight: 50px;\n\twidth: 50px;\n}\n\n.control {\n\tposition: relative;\n\t/*background-color: blue;*/\n\theight: 50px;\n\twidth: 50px;\n}\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// Arrangement.vue?d88f6bf2","<template>\n\t<div class=\"cell\">\n\t\t<div @click=\"switchToSequence()\" :class=\"cellClass\">\n\t\t\t<canvas class=\"instrument__canvas\"></canvas>\n\t\t</div>\n\t</div>\n</template>\n\n<script type=\"text/javascript\">\n\nimport { eventBus } from '../eventbus.js';\n\nexport default {\n\tname: 'cell',\n\tprops: ['index', 'sequenceSetId', 'sequenceId'],\n\tdata() {\n\t\treturn {\n\t\t\tshapeExists: false\n\t\t}\n\t},\n\tcomputed: {\n\t\tcellClass() {\n\t\t\tlet className = 'circle';\n\t\t\tif (this.shapeExists) {\n\t\t\t\tclassName += ' circle--active';\n\t\t\t}\n\t\t\treturn className;\n\t\t}\n\t},\n\tmethods: {\n\t\tsequenceExists() {\n\t\t\tlet manager = this.$store.state.sequenceSetManager;\n\t\t\treturn manager.sequenceExists(this.sequenceSetId, this.index);\n\t\t},\n\t\tshapeExists() {\n\t\t\tlet manager = this.$store.state.sequenceSetManager;\n\t\t\treturn manager.shapeExists(this.sequenceSetId, this.index);\n\t\t},\n\t\tswitchToSequence() {\n\t\t\tlet manager = this.$store.state.sequenceSetManager;\n\t\t\tmanager.handleClickedSequence(this.sequenceSetId, this.index, this.$store);\n\t\t\tthis.switchToInstrument();\n\t\t},\n\t\tswitchToInstrument() {\n\t\t\tthis.$store.commit('switchMode', 'INSTRUMENT');\n\t\t},\n\t},\n\tmounted() {\n\t\tlet canvas = this.$el.children[0].children[0],\n\t\t\ttopic = eventBus.topicMap.newSurface,\n\t\t\tindex = this.index,\n\t\t\tsequenceSetId = this.sequenceSetId,\n\t\t\tself = this;\n\t\teventBus.publish(topic, {\n\t\t\telement: canvas,\n\t\t\tvalues: {\n\t\t\t\ttype: 'ARRANGEMENT',\n\t\t\t\tindex,\n\t\t\t\tsequenceSetId\n\t\t\t}\n\t\t});\n\t\teventBus.subscribe(eventBus.topicMap.newShapeReady, function(data) {\n\t\t\tif (data.sequenceId !== self.sequenceId) return;\n\t\t\tif (data.shape === undefined) {\n\t\t\t\tself.shapeExists = false;\n\t\t\t} else {\n\t\t\t\tself.shapeExists = true;\n\t\t\t}\n\t\t});\n\t}\n}\n</script>\n\n<style type=\"text/css\">\n\t@import '../style/_style.scss';\n</style>\n\n<style scoped>\n\ncanvas {\n\twidth: 100%;\n\theight: 100%;\n\tborder-radius: 50%;\n}\n\n.cell {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\theight: 50px;\n\twidth: 50px;\n}\n</style>\n\n\n// WEBPACK FOOTER //\n// Cell.vue?63eb990a","<template>\n  <div class=\"hello\">\n    <h1>{{ msg }}</h1>\n    <h2>Essential Links</h2>\n    <ul>\n      <li><a href=\"https://vuejs.org\" target=\"_blank\">Core Docs</a></li>\n      <li><a href=\"https://forum.vuejs.org\" target=\"_blank\">Forum</a></li>\n      <li><a href=\"https://gitter.im/vuejs/vue\" target=\"_blank\">Gitter Chat</a></li>\n      <li><a href=\"https://twitter.com/vuejs\" target=\"_blank\">Twitter</a></li>\n      <br>\n      <li><a href=\"http://vuejs-templates.github.io/webpack/\" target=\"_blank\">Docs for This Template</a></li>\n    </ul>\n    <h2>Ecosystem</h2>\n    <ul>\n      <li><a href=\"http://router.vuejs.org/\" target=\"_blank\">vue-router</a></li>\n      <li><a href=\"http://vuex.vuejs.org/\" target=\"_blank\">vuex</a></li>\n      <li><a href=\"http://vue-loader.vuejs.org/\" target=\"_blank\">vue-loader</a></li>\n      <li><a href=\"https://github.com/vuejs/awesome-vue\" target=\"_blank\">awesome-vue</a></li>\n    </ul>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'hello',\n  data () {\n    return {\n      msg: 'Welcome to Your Vue.js App'\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nh1, h2 {\n  font-weight: normal;\n}\n\nul {\n  list-style-type: none;\n  padding: 0;\n}\n\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\n\na {\n  color: #42b983;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// Hello.vue?8b4cb386","<template>\n\t<div class=\"instrument\">\n\t\t<div class=\"row interface\">\n\t\t\t<div class=\"cell\">\n\t\t\t\t<div @click=\"switchToArrangement()\" class=\"circle circle--active\"></div>\n\t\t\t</div>\n\t\t\t<div v-for=\"pattern in constraints\" class=\"cell\">\n\t\t\t\t<div @click=\"updateConstraint(pattern)\" :style=\"getConstraintStyle(pattern)\" :class=\"getConstraintClass(pattern)\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"cell\">\n\t\t\t\t<div @click=\"toggleLoop()\" class=\"circle circle--active transportControl\">\n\t\t\t\t\t<div :class=\"getTransportClass()\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<canvas v-capture-canvas=\"{type: 'INSTRUMENT'}\" class=\"instrument__canvas\"></canvas>\n\t\t<div class=\"row interface\">\n\t\t\t<div class=\"cell\">\n\t\t\t\t<div @click=\"clearShape()\" class=\"instrument-cell\"></div>\n\t\t\t</div>\n\t\t\t<div v-for=\"f in filenames\" class=\"cell\">\n\t\t\t\t<div @click=\"updateFilename(f)\" class=\"instrument-cell\">\n\t\t\t\t\t<div :class=\"getInstrumentClassNames(f)\" :style=\"getInstrumentStyle(f)\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\nimport { eventBus } from '../eventbus.js';\nimport instruments from '../audio/instruments.js';\nimport { getSequenceConstraints } from '../audio/constraints.js';\n\nconst filenames = Object.keys(instruments),\n\tconstraints = getSequenceConstraints();\n\nexport default {\n\tname: 'instrument',\n\tdata() {\n\t\treturn {\n\t\t\tfilenames,\n\t\t\tconstraints\n\t\t}\n\t},\n\tmethods: {\n\t\tswitchToArrangement() {\n\t\t\tthis.$store.commit('switchMode', 'ARRANGEMENT');\n\t\t\tlet manager = this.$store.state.sequenceSetManager,\n\t\t\t\tcanAddMore = manager.canAddMoreColumns();\n\t\t\tif (canAddMore && manager.allShapesExist(0)) {\n\t\t\t\tthis.$store.commit('updateColumnAdding', true);\n\t\t\t}\n\t\t},\n\t\tclearShape() {\n\t\t\tlet clearShapeTopic = eventBus.topicMap.clearShape;\n\t\t\teventBus.publish(clearShapeTopic, {});\n\t\t},\n\t\ttoggleLoop() {\n\t\t\tthis.$store.state.sequenceSetManager.toggleLoop();\n\t\t},\n\t\tupdateFilename(f) {\n\t\t\tthis.$store.state.sequenceSetManager.updateFilename(f);\n\t\t},\n\t\tupdateConstraint(c) {\n\t\t\tthis.$store.state.sequenceSetManager.updateConstraint(c);\n\t\t},\n\t\tgetRgbString(f) {\n\t\t\treturn instruments[f].rgbString;\n\t\t},\n\t\tgetInstrumentStyle(f) {\n\t\t\tlet rgbString = this.getRgbString(f);\n\t\t\treturn {\n\t\t\t\tbackgroundColor: rgbString\n\t\t\t}\n\t\t},\n\t\tgetInstrumentClassNames(f) {\n\t\t\tlet sequence = this.$store.state.editedSequence,\n\t\t\t\tclassName = 'instrument-dot';\n\t\t\tif (sequence === undefined) return className;\n\t\t\tif (f !== sequence.filename) return className;\n\t\t\treturn className + ' instrument-dot--active';\n\t\t},\n\t\tgetConstraintStyle(c) {\n\t\t\treturn {\n\t\t\t\tbackgroundColor: c.color\n\t\t\t}\n\t\t},\n\t\tgetConstraintClass(c) {\n\t\t\tlet sequence = this.$store.state.editedSequence,\n\t\t\t\tclassName = 'constraint';\n\t\t\tif (sequence === undefined) return className;\n\t\t\tif (c.name !== sequence.constraint.name) return className;\n\t\t\treturn className + ' constraint--active';\n\t\t},\n\t\tgetTransportClass() {\n\t\t\tif (this.$store.state.sequenceSetManager.isLooping) {\n\t\t\t\treturn 'transportControl--playing';\n\t\t\t}\n\t\t\treturn 'transportControl--stopped';\n\t\t}\n\t},\n\tdirectives: {\n\t\tcaptureCanvas(element, binding) {\n\t\t\tlet values = binding.value;\n\t\t\teventBus.publish('newSurface', {element, values});\n\t\t}\n\t},\n\tmounted() {\n\t\tlet self = this;\n\t\teventBus.subscribe(eventBus.topicMap.newEditedSequence, function(data) {\n\t\t\tself.$store.commit('updatedEditedSequence', data.sequence);\n\t\t});\n\t\twindow.addEventListener('keydown', function(evt) {\n\t\t\tif (evt.keyCode !== 27) return;\n\t\t\tif (self.$store.state.mode === 'ARRANGEMENT') return;\n\t\t\tself.switchToArrangement();\n\t\t});\n\t}\n}\n</script>\n\n<style type=\"text/css\">\n\t@import '../style/_style.scss';\n</style>\n\n<style scoped>\n\n.instrument {\n\theight: 95%; width: 95%; max-height: 500px; max-width: 500px;\n\tdisplay: flex; flex-direction: column;\n\t/*overflow: scroll;*/\n\toverflow: hidden;\n}\n\n.instrument__canvas {\n\tflex-grow: 1; min-height: 0; cursor: crosshair;\n}\n\n.row {\n\theight: 50px; min-height: 50px; width: 100%;\n\tdisplay: flex; justify-content: space-between;\n\t/*background-color: yellow;*/\n}\n\n.cell {\n\theight: 100%; min-width: 50px; display: flex;\n\talign-items: center; justify-content: center;\n\t/*box-sizing: border-box; border: solid 1px;*/\n}\n\n.constraint {\n\theight: 25px;\n\twidth: 25px;\n\tborder-radius: 10%;\n\tbox-sizing: border-box;\n}\n\n.constraint--active {\n\tborder: solid 3px;\n}\n\n.instrument-cell {\n\tborder-radius: 10%;\n\twidth: 25px;\n\theight: 25px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tbackground-color: white;\n}\n\n.instrument-dot {\n\twidth: 40%;\n\theight: 40%;\n\tborder-radius: 50%;\n}\n\n.instrument-dot--active {\n\twidth: 20%;\n\theight: 20%;\n}\n\n.transportControl {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n.transportControl--playing {\n\twidth: 25%;\n\theight: 25%;\n\tbackground-color: black;\n}\n\n.transportControl--stopped {\n\twidth: 0; \n  height: 0; \n  border-top: 5px solid transparent;\n  border-bottom: 5px solid transparent;\n  border-left: 8px solid black;\n  margin-left: 2px;\n}\n\n</style>\n\n\n// WEBPACK FOOTER //\n// Instrument.vue?f6ac51ec","<template>\n\t<div id=\"sequencer\">\n\t\t<instrument v-show=\"modeIsInstrument\"></instrument>\n\t\t<arrangement v-show=\"!modeIsInstrument\"></arrangement>\n\t</div>\n</template>\n\n<script>\nimport Instrument from './Instrument';\nimport Arrangement from './Arrangement';\nimport { eventBus } from '../eventbus.js';\n\nexport default {\n\tname: 'sequencer',\n\tcomponents: { Instrument, Arrangement },\n\tmounted() {\n\t\tlet el = this.$el;\n\t\tfunction resizer() {\n\t\t\tel.style.width = window.innerWidth.toString() + 'px';\n\t\t\tel.style.height = window.innerHeight.toString() + 'px';\n\t\t}\n\t\twindow.addEventListener('resize', resizer);\n\t\tresizer();\n\t},\n\tcomputed: {\n\t\tmodeIsInstrument() {\n\t\t\treturn this.$store.state.mode === 'INSTRUMENT';\n\t\t}\n\t},\n\tmethods: {\n\t\tsoundsAreLoaded() {\n\t\t\treturn this.$store.state.soundsAreLoaded\n\t\t}\n\t}\n}\n</script>\n\n<style>\n\n#sequencer {\n\theight: 100vh;\n\twidth: 100vw;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// Sequencer.vue?750acb72","import { eventBus } from '../eventbus.js';\nimport { webAudio } from '../audio/webaudio.js';\nimport instruments from '../audio/instruments.js';\nimport ease from './ease.js';\n\nfunction Animator(world, canvas) {\n\tthis.world = world;\n\tthis.activeCanvas = canvas;\n\tthis.instrumentCanvas = canvas;\n\tthis.arrangementCanvases = world.arrangementCanvases;\n\tthis.shouldAnimateInstrument = true;\n\tthis.shouldAnimateArrangement = false;\n\tthis.shouldDrawActiveNotes = true;\n\tthis.isRecording = false;\n\tthis.stroke = [];\n\tthis.style = {\n\t\teditedVertices: {\n\t\t\tshape: 'circle',\n\t\t\tsize: 30,\n\t\t\tblipIncrement: .8\n\t\t},\n\t\tdrawCentroidArrangement: false,\n\t\tdrawCentroidInstrument: false\n\t}\n\tthis.ratio = window.devicePixelRatio || 1;\n\tthis.pendingNotes = [];\n\tthis.activeNotes = [];\n\tthis.noteTimeTolerance = 1/50;\n\tthis.mode = undefined;\n\tthis.editedSequence = undefined;\n\tthis.subscribe();\n}\n\nAnimator.prototype.constructor = Animator;\n\nAnimator.prototype.subscribe = function() {\n\tlet newNoteTimesTopic = eventBus.topicMap.newNoteTimesReady,\n\t\tcanvasResizeTopic = eventBus.topicMap.canvasResize,\n\t\tnewEditedSequenceTopic = eventBus.topicMap.newEditedSequence,\n\t\tmodeChangeTopic = eventBus.topicMap.modeChange,\n\t\tdeletedColumnTopic = eventBus.topicMap.deletedColumn;\n\teventBus.subscribe(newNoteTimesTopic, this.handleNewNoteTimes.bind(this));\n\teventBus.subscribe(canvasResizeTopic, this.handleCanvasResize.bind(this));\n\teventBus.subscribe(newEditedSequenceTopic, this.handleNewEditedSequence.bind(this));\n\teventBus.subscribe(modeChangeTopic, this.updateMode.bind(this));\n\teventBus.subscribe(deletedColumnTopic, this.handleDeletedColumn.bind(this));\n}\n\nAnimator.prototype.handleNewNoteTimes = function(data) {\n\tfor (let i=0; i<data.noteTimes.length; i++) {\n\t\tthis.pendingNotes.push({\n\t\t\tsequenceId: data.sequenceId,\n\t\t\tsequenceIndex: data.sequenceIndex,\n\t\t\tsequenceSetId: data.sequenceSetId,\n\t\t\tnoteTime: data.noteTimes[i],\n\t\t\tpoint: data.points[i],\n\t\t\tcoordinate: data.coordinates[i],\n\t\t\tnoteDuration: data.noteDuration,\n\t\t\tloopIndex: data.loopIndex,\n\t\t\tfilename: data.filename,\n\t\t\tconstraint: data.constraint\n\t\t});\n\t}\n}\n\nAnimator.prototype.updateMode = function(to) {\n\tthis.mode = to;\n\tif (to === 'ARRANGEMENT') {\n\t\tthis.shouldAnimateInstrument = false;\n\t\tthis.shouldAnimateArrangement = true;\n\t\tthis.clearArrangementCanvases();\n\t\tthis.animateArrangement();\n\t} else {\n\t\tthis.shouldAnimateInstrument = true;\n\t\tthis.shouldAnimateArrangement = false;\n\t\tthis.activeCanvas = this.instrumentCanvas;\n\t\tthis.animateInstrument();\n\t}\n}\n\nAnimator.prototype.handleCanvasResize = function() {\n\tif (this.mode === 'INSTRUMENT') {\n\t\tthis.pendingNotes = [];\n\t\tthis.activeNotes = [];\n\t}\n}\n\nAnimator.prototype.handleDeletedColumn = function() {\n\tif (this.mode === 'INSTRUMENT') return;\n\tthis.pendingNotes = [];\n\tthis.activeNotes = [];\n}\n\nAnimator.prototype.drawCircle = function(shape, dotSize, props) {\n\tthis.drawArc(shape.center, shape.radius, true, props);\n\tthis.drawDots([shape.center], dotSize, false, props);\n}\n\nAnimator.prototype.drawRectTriLineRand = function(shape, dotSize, props) {\n\tlet linePoints = shape.points.concat([shape.points[0]]),\n\t\tvertPoints = shape.points.concat([shape.center]);\n\tthis.drawLine(linePoints, true, props);\n\tthis.drawDots(vertPoints, dotSize, false, props);\n}\n\nAnimator.prototype.drawShape = function(shape, dotSize, props) {\n\tif (shape.identity === 'circle') {\n\t\tthis.drawCircle(shape, dotSize, props);\n\t} else {\n\t\tthis.drawRectTriLineRand(shape, dotSize, props);\n\t}\n}\n\nAnimator.prototype.animateArrangement = function() {\n\n\tlet self = this,\n\t\tdotSize = this.style.editedVertices.size,\n\t\tblipIncrement = this.style.editedVertices.blipIncrement;\n\n\tconst animator = function() {\n\t\tif (!self.shouldAnimateArrangement) return;\n\n\t\tself.updateActiveNotes();\n\t\tself.clearArrangementCanvases();\n\n\t\tfor (let i=0; i<self.activeNotes.length; i++) {\n\t\t\tlet note = self.activeNotes[i],\n\t\t\t\tsequenceIndex = note.sequenceIndex,\n\t\t\t\tcanvas = self.getArrangementCanvas(note.sequenceSetId, sequenceIndex),\n\t\t\t\tctx = canvas.getContext('2d'),\n\t\t\t\tnow = Date.now(),\n\t\t\t\tstart = note.start || now,\n\t\t\t\tsign = note.sign || 1,\n\t\t\t\tcurrentSize = note.currentSize || dotSize,\n\t\t\t\tduration = note.noteDuration/2 * 1000,\n\t\t\t\tp = (now-start) / duration,\n\t\t\t\tcanvasSize = 100,\n\t\t\t\tcanvasCenter = {\n\t\t\t\t\tx: canvasSize/2,\n\t\t\t\t\ty: canvasSize/2\n\t\t\t\t},\n\t\t\t\tval = ease.outQuad(p);\n\t\t\tif (p > .9) {\n\t\t\t\tnote.sign = -1;\n\t\t\t\tstart = now;\n\t\t\t}\n\t\t\tcurrentSize = currentSize + (val*blipIncrement*sign);\n\t\t\tnote.start = start;\n\t\t\tnote.currentSize = currentSize;\n\n\t\t\tself.activeCanvas = canvas;\n\t\t\tcanvas.width = canvasSize * self.ratio;\n\t\t\tcanvas.height = canvasSize * self.ratio;\n\t\t\tctx.scale(self.ratio, self.ratio);\n\n\t\t\tlet color = note.constraint.color,\n\t\t\t// let color = instruments[note.filename].rgbString,\n\t\t\t\tprops = {\n\t\t\t\t\tfillStyle: color,\n\t\t\t\t\tstrokeStyle: color\n\t\t\t\t};\n\n\t\t\tself.drawDots([canvasCenter], currentSize, false, props);\n\n\t\t\tif (self.style.drawCentroidArrangement) {\n\t\t\t\tself.drawDots([canvasCenter], currentSize/2, false, {\n\t\t\t\t\tfillStyle: instruments[note.filename].rgbString,\n\t\t\t\t\tstrokeStyle: instruments[note.filename].rgbString\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\twindow.requestAnimationFrame(animator);\n\t}\n\n\tanimator();\n\n}\n\nAnimator.prototype.animateInstrument = function() {\n\n\tlet self = this,\n\t\tdotSize = this.style.editedVertices.size,\n\t\tblipIncrement = this.style.editedVertices.blipIncrement;\n\n\tconst animator = function() {\n\t\tif (!self.shouldAnimateInstrument) return;\n\n\t\tlet world = self.world,\n\t\t\tcanvas = self.activeCanvas,\n\t\t\teditedShape = world.getEditedShape(),\n\t\t\tneedResize = canvas.width === 0 || (editedShape !== undefined &&\n\t\t\t\teditedShape.previousCanvasWidth === undefined),\n\t\t\tfilename = self.editedSequence.filename,\n\t\t\tcolor = self.editedSequence.constraint.color,\n\t\t\t// color = instruments[filename].rgbString,\n\t\t\tprops = {\n\t\t\t\tfillStyle: color,\n\t\t\t\tstrokeStyle: color,\n\t\t\t\tlineWidth: 5\n\t\t\t}\n\n\t\tself.updateActiveNotes();\n\n\t\tif (needResize) {\n\t\t\tself.sizeCanvas();\n\t\t}\n\n\t\tif (editedShape !== undefined && !self.isRecording) {\n\t\t\tself.drawShape(editedShape, dotSize, props);\n\t\t} else if (self.isRecording) {\n\t\t\tself.drawLine(self.stroke, true, props);\n\t\t} else {\n\t\t\tlet ctx = canvas.getContext('2d');\n\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t\t}\n\n\t\tfor (let i=0; i<self.activeNotes.length; i++) {\n\t\t\tif (editedShape === undefined) continue;\n\t\t\tlet note = self.activeNotes[i],\n\t\t\t\tcoordinate = note.coordinate,\n\t\t\t\tnow = Date.now(),\n\t\t\t\tstart = note.start || now,\n\t\t\t\tsign = note.sign || 1,\n\t\t\t\tcurrentSize = note.currentSize || dotSize,\n\t\t\t\tduration = note.noteDuration/2 * 1000,\n\t\t\t\tp = (now-start) / duration,\n\t\t\t\tval = ease.outQuad(p),\n\t\t\t\tblipSizeUse\n\t\t\tif (p > .9) {\n\t\t\t\tnote.sign = -1;\n\t\t\t\tstart = now;\n\t\t\t}\n\t\t\tcurrentSize = currentSize + (val*blipIncrement*sign);\n\t\t\tnote.start = start;\n\t\t\tnote.currentSize = currentSize;\n\t\t\tif (note.sequenceId !== world.editedSequenceId) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tself.drawDots([note.point], currentSize, false, props);\n\n\t\t\t/*\n\t\t\t\tMARK: Begin animating centroid\n\t\t\t*/\n\n\t\t\tif (self.style.drawCentroidInstrument) {\n\t\t\t\tlet centerPoint,\n\t\t\t\t\tcenterPointSize;\n\t\t\t\tif (editedShape.identity === 'random') {\n\t\t\t\t\tcenterPoint = note.point;\n\t\t\t\t} else {\n\t\t\t\t\tcenterPoint = editedShape.center;\n\t\t\t\t}\n\t\t\t\tif (editedShape.identity === 'circle' || \n\t\t\t\t\teditedShape.identity === 'random') {\n\t\t\t\t\tcenterPointSize = currentSize/4;\n\t\t\t\t} else {\n\t\t\t\t\tcenterPointSize = dotSize/4;\n\t\t\t\t}\n\t\t\t\tself.drawDots([centerPoint], centerPointSize, false, {\n\t\t\t\t\tfillStyle: instruments[note.filename].rgbString,\n\t\t\t\t\tstrokeStyle: instruments[note.filename].rgbString\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\twindow.requestAnimationFrame(animator);\n\t}\n\n\tanimator();\n}\n\nAnimator.prototype.updateActiveNotes = function() {\n\tlet pendingNotes = [],\n\t\texpired = [];\n\tfor (let i=0; i<this.pendingNotes.length; i++) {\n\t\tlet note = this.pendingNotes[i],\n\t\t\tcurrentTime = webAudio.context.currentTime,\n\t\t\tnoteTime = note.noteTime;\n\t\tif (Math.abs(noteTime-currentTime) < this.noteTimeTolerance) {\n\t\t\tthis.activeNotes.push(note);\n\t\t} else {\n\t\t\tpendingNotes.push(note);\n\t\t}\n\t}\n\tfor (let i=0; i<this.activeNotes.length; i++) {\n\t\tlet note = this.activeNotes[i],\n\t\t\tcurrentTime = webAudio.context.currentTime,\n\t\t\tnoteTime = note.noteTime,\n\t\t\tnoteDuration = note.noteDuration;\n\t\tif ((currentTime-(noteTime+noteDuration)) > this.noteTimeTolerance) {\n\t\t\texpired.push(i-expired.length);\n\t\t}\n\t}\n\tfor (let i=0; i<expired.length; i++) {\n\t\tthis.activeNotes.splice(expired[i], 1);\n\t}\n\tthis.pendingNotes = pendingNotes;\n\n\t//\tget rid of pending notes if the shape is marked\n\t// \tas undefined\n\n\tconst expiredRemover = function(arr, id) {\n\t\tlet expired = [];\n\t\tfor (let i=0; i<arr.length; i++) {\n\t\t\tif (arr[i].sequenceId === id) {\n\t\t\t\texpired.push(i-expired.length);\n\t\t\t}\n\t\t}\n\t\tfor (let i=0; i<expired.length; i++) {\n\t\t\tarr.splice(expired[i], 1);\n\t\t}\n\t}\n\n\tlet editedShape = this.world.getEditedShape();\n\tif (editedShape === undefined) {\n\t\texpiredRemover(this.pendingNotes, this.world.editedSequenceId);\n\t\texpiredRemover(this.activeNotes, this.world.editedSequenceId);\n\t}\n}\n\nAnimator.prototype.drawLine = function(points, doClear, props) {\n\tlet canvas = this.activeCanvas,\n\t\tctx = canvas.getContext('2d');\n\tif (typeof doClear == 'undefined') doClear = true;\n\tif (doClear) ctx.clearRect(0, 0, canvas.width, canvas.height);\n\tfor (var i=0; i<points.length-1; i++) {\n\t\tctx.beginPath();\n\t\tctx.moveTo(points[i].x, points[i].y);\n\t\tctx.lineTo(points[i+1].x, points[i+1].y);\n\t\tctx.lineWidth = props.lineWidth;\n\t\tctx.strokeStyle = props.strokeStyle;\n\t\tctx.stroke();\n\t}\n}\n\nAnimator.prototype.drawArc = function(center, radius, doClear, props) {\n\tlet canvas = this.activeCanvas,\n\t\tctx = canvas.getContext('2d');\n\tif (typeof doClear == 'undefined') doClear = true;\n\tif (doClear) ctx.clearRect(0, 0, canvas.width, canvas.height);\n\tctx.beginPath();\n\tctx.arc(center.x, center.y, radius, 0, Math.PI*2);\n\tctx.strokeStyle = props.strokeStyle;\n\tctx.lineWidth = props.lineWidth;\n\tctx.stroke();\n}\n\nAnimator.prototype.drawDots = function(points, width, doClear, props) {\n\tlet canvas = this.activeCanvas,\n\t\tctx = canvas.getContext('2d');\n\tif (typeof doClear == 'undefined') doClear = true;\n\tif (doClear) ctx.clearRect(0, 0, canvas.width, canvas.height);\n\tfor (let i=0; i<points.length; i++) {\n\t\tctx.fillStyle = props.fillStyle;\n\t\tctx.globalAlpha = props.alpha || 1;\n\t\tlet x = points[i].x,\n\t\t\ty = points[i].y,\n\t\t\tr = width/2;\n\t\tr = Math.abs(r);\n\t\tctx.beginPath();\n\t\tctx.arc(x, y, r, 0, Math.PI*2);\n\t\tctx.closePath();\n\t\tctx.fill();\n\t}\n}\n\nAnimator.prototype.sizeCanvas = function() {\n\tlet canvas = this.activeCanvas,\n\t\tctx = canvas.getContext('2d');\n\tsizeCanvas();\n\twindow.addEventListener('resize', sizeCanvas);\n\tfunction sizeCanvas() {\n\t\tvar rect = canvas.getBoundingClientRect(),\n\t\t\tw = rect.width,\n\t\t\th = rect.height,\n\t\t\tratio = window.devicePixelRatio || 1;\n\t\tcanvas.width = w * ratio;\n\t\tcanvas.height = h * ratio;\n\t\tctx.scale(ratio, ratio);\n\t\teventBus.publish('canvasResize', {\n\t\t\tcanvasWidth: canvas.width/ratio,\n\t\t\tcanvasHeight: canvas.height/ratio\n\t\t});\n\t}\n}\n\nAnimator.prototype.handleNewEditedSequence = function(data) {\n\tthis.pendingNotes = [];\n\tthis.activeNotes = [];\n\tthis.editedSequence = data.sequence;\n}\n\nAnimator.prototype.getArrangementCanvas = function(setId, index) {\n\tfor (let i=0; i<this.arrangementCanvases.length; i++) {\n\t\tlet canvasSet = this.arrangementCanvases[i],\n\t\t\tcanvas = canvasSet.canvas,\n\t\t\tsequenceSetId = canvasSet.sequenceSetId,\n\t\t\tsequenceIndex = canvasSet.index;\n\t\tif (sequenceSetId === setId && sequenceIndex === index) {\n\t\t\treturn canvas;\n\t\t}\n\t}\n}\n\nAnimator.prototype.clearArrangementCanvases = function() {\n\tfor (let i=0; i<this.arrangementCanvases.length; i++) {\n\t\tlet canvas = this.arrangementCanvases[i].canvas,\n\t\t\tctx = canvas.getContext('2d');\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t}\n}\n\nAnimator.prototype.clearActiveCanvas = function() {\n\tlet canvas = this.activeCanvas,\n\t\tctx = canvas.getContext('2d');\n\tctx.clearRect(0, 0, canvas.width, canvas.height);\n}\n\nexport { Animator };\n\n\n// WEBPACK FOOTER //\n// ./src/animation/animator.js","// https://raw.githubusercontent.com/component/ease/master/index.js \n// easing functions from \"Tween.js\"\n\nexports.linear = function(n){\n  return n;\n};\n\nexports.inQuad = function(n){\n  return n * n;\n};\n\nexports.outQuad = function(n){\n  return n * (2 - n);\n};\n\nexports.inOutQuad = function(n){\n  n *= 2;\n  if (n < 1) return 0.5 * n * n;\n  return - 0.5 * (--n * (n - 2) - 1);\n};\n\nexports.inCube = function(n){\n  return n * n * n;\n};\n\nexports.outCube = function(n){\n  return --n * n * n + 1;\n};\n\nexports.inOutCube = function(n){\n  n *= 2;\n  if (n < 1) return 0.5 * n * n * n;\n  return 0.5 * ((n -= 2 ) * n * n + 2);\n};\n\nexports.inQuart = function(n){\n  return n * n * n * n;\n};\n\nexports.outQuart = function(n){\n  return 1 - (--n * n * n * n);\n};\n\nexports.inOutQuart = function(n){\n  n *= 2;\n  if (n < 1) return 0.5 * n * n * n * n;\n  return -0.5 * ((n -= 2) * n * n * n - 2);\n};\n\nexports.inQuint = function(n){\n  return n * n * n * n * n;\n}\n\nexports.outQuint = function(n){\n  return --n * n * n * n * n + 1;\n}\n\nexports.inOutQuint = function(n){\n  n *= 2;\n  if (n < 1) return 0.5 * n * n * n * n * n;\n  return 0.5 * ((n -= 2) * n * n * n * n + 2);\n};\n\nexports.inSine = function(n){\n  return 1 - Math.cos(n * Math.PI / 2 );\n};\n\nexports.outSine = function(n){\n  return Math.sin(n * Math.PI / 2);\n};\n\nexports.inOutSine = function(n){\n  return .5 * (1 - Math.cos(Math.PI * n));\n};\n\nexports.inExpo = function(n){\n  return 0 == n ? 0 : Math.pow(1024, n - 1);\n};\n\nexports.outExpo = function(n){\n  return 1 == n ? n : 1 - Math.pow(2, -10 * n);\n};\n\nexports.inOutExpo = function(n){\n  if (0 == n) return 0;\n  if (1 == n) return 1;\n  if ((n *= 2) < 1) return .5 * Math.pow(1024, n - 1);\n  return .5 * (-Math.pow(2, -10 * (n - 1)) + 2);\n};\n\nexports.inCirc = function(n){\n  return 1 - Math.sqrt(1 - n * n);\n};\n\nexports.outCirc = function(n){\n  return Math.sqrt(1 - (--n * n));\n};\n\nexports.inOutCirc = function(n){\n  n *= 2\n  if (n < 1) return -0.5 * (Math.sqrt(1 - n * n) - 1);\n  return 0.5 * (Math.sqrt(1 - (n -= 2) * n) + 1);\n};\n\nexports.inBack = function(n){\n  var s = 1.70158;\n  return n * n * (( s + 1 ) * n - s);\n};\n\nexports.outBack = function(n){\n  var s = 1.70158;\n  return --n * n * ((s + 1) * n + s) + 1;\n};\n\nexports.inOutBack = function(n){\n  var s = 1.70158 * 1.525;\n  if ( ( n *= 2 ) < 1 ) return 0.5 * ( n * n * ( ( s + 1 ) * n - s ) );\n  return 0.5 * ( ( n -= 2 ) * n * ( ( s + 1 ) * n + s ) + 2 );\n};\n\nexports.inBounce = function(n){\n  return 1 - exports.outBounce(1 - n);\n};\n\nexports.outBounce = function(n){\n  if ( n < ( 1 / 2.75 ) ) {\n    return 7.5625 * n * n;\n  } else if ( n < ( 2 / 2.75 ) ) {\n    return 7.5625 * ( n -= ( 1.5 / 2.75 ) ) * n + 0.75;\n  } else if ( n < ( 2.5 / 2.75 ) ) {\n    return 7.5625 * ( n -= ( 2.25 / 2.75 ) ) * n + 0.9375;\n  } else {\n    return 7.5625 * ( n -= ( 2.625 / 2.75 ) ) * n + 0.984375;\n  }\n};\n\nexports.inOutBounce = function(n){\n  if (n < .5) return exports.inBounce(n * 2) * .5;\n  return exports.outBounce(n * 2 - 1) * .5 + .5;\n};\n\nexports.inElastic = function(n){\n  var s, a = 0.1, p = 0.4;\n  if ( n === 0 ) return 0;\n  if ( n === 1 ) return 1;\n  if ( !a || a < 1 ) { a = 1; s = p / 4; }\n  else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n  return - ( a * Math.pow( 2, 10 * ( n -= 1 ) ) * Math.sin( ( n - s ) * ( 2 * Math.PI ) / p ) );\n};\n\nexports.outElastic = function(n){\n  var s, a = 0.1, p = 0.4;\n  if ( n === 0 ) return 0;\n  if ( n === 1 ) return 1;\n  if ( !a || a < 1 ) { a = 1; s = p / 4; }\n  else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n  return ( a * Math.pow( 2, - 10 * n) * Math.sin( ( n - s ) * ( 2 * Math.PI ) / p ) + 1 );\n};\n\nexports.inOutElastic = function(n){\n  var s, a = 0.1, p = 0.4;\n  if ( n === 0 ) return 0;\n  if ( n === 1 ) return 1;\n  if ( !a || a < 1 ) { a = 1; s = p / 4; }\n  else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n  if ( ( n *= 2 ) < 1 ) return - 0.5 * ( a * Math.pow( 2, 10 * ( n -= 1 ) ) * Math.sin( ( n - s ) * ( 2 * Math.PI ) / p ) );\n  return a * Math.pow( 2, -10 * ( n -= 1 ) ) * Math.sin( ( n - s ) * ( 2 * Math.PI ) / p ) * 0.5 + 1;\n};\n\n// aliases\n\nexports['in-quad'] = exports.inQuad;\nexports['out-quad'] = exports.outQuad;\nexports['in-out-quad'] = exports.inOutQuad;\nexports['in-cube'] = exports.inCube;\nexports['out-cube'] = exports.outCube;\nexports['in-out-cube'] = exports.inOutCube;\nexports['in-quart'] = exports.inQuart;\nexports['out-quart'] = exports.outQuart;\nexports['in-out-quart'] = exports.inOutQuart;\nexports['in-quint'] = exports.inQuint;\nexports['out-quint'] = exports.outQuint;\nexports['in-out-quint'] = exports.inOutQuint;\nexports['in-sine'] = exports.inSine;\nexports['out-sine'] = exports.outSine;\nexports['in-out-sine'] = exports.inOutSine;\nexports['in-expo'] = exports.inExpo;\nexports['out-expo'] = exports.outExpo;\nexports['in-out-expo'] = exports.inOutExpo;\nexports['in-circ'] = exports.inCirc;\nexports['out-circ'] = exports.outCirc;\nexports['in-out-circ'] = exports.inOutCirc;\nexports['in-back'] = exports.inBack;\nexports['out-back'] = exports.outBack;\nexports['in-out-back'] = exports.inOutBack;\nexports['in-bounce'] = exports.inBounce;\nexports['out-bounce'] = exports.outBounce;\nexports['in-out-bounce'] = exports.inOutBounce;\nexports['in-elastic'] = exports.inElastic;\nexports['out-elastic'] = exports.outElastic;\nexports['in-out-elastic'] = exports.inOutElastic;\n\n\n// WEBPACK FOOTER //\n// ./src/animation/ease.js","import { webAudio } from './webaudio.js';\nimport { eventBus } from '../eventbus.js'\nimport { Util } from '../util.js';\nimport { getSequenceConstraints } from './constraints';\nimport { Point } from '../geometry/vertices.js';\n\nfunction Sequence(sequenceSet, filename) {\n\tthis.sequenceSet = sequenceSet;\n\tthis.shape = undefined;\n\tthis.id = Util.randId();\n\tthis.index = 0;\n\tthis.filename = filename;\n\tthis.shouldLoop = true;\n\tthis.isActive = false;\n\tthis.isLooping = false;\n\tthis.loopIndex = 0;\n\tthis.nBeats = 4;\n\tthis.noteLength = 'quarter';\n\tthis.constraints = getSequenceConstraints();\n\tthis.constraint = this.constraints[0];\n\tthis.currentBeat = webAudio.getCurrentBeat();\n\tthis.sources = [];\n\tthis.previousWidth = undefined;\n\tthis.previousHeight = undefined;\n\tthis.mode = undefined;\n\tthis.animationFrameId = undefined;\n\tthis.subscribe();\n}\n\nSequence.prototype.constructor = Sequence;\n\nSequence.prototype.subscribe = function() {\n\tlet newShapeReadyTopic = eventBus.topicMap.newShapeReady,\n\t\tcanvasResizeTopic = eventBus.topicMap.canvasResize,\n\t\tmodeChangeTopic = eventBus.topicMap.modeChange;\n\teventBus.subscribe(newShapeReadyTopic, this.registerShape.bind(this), this.id);\n\teventBus.subscribe(modeChangeTopic, this.handleModeChange.bind(this));\n\teventBus.subscribe(canvasResizeTopic, this.handleCanvasResize.bind(this));\n}\n\nSequence.prototype.registerShape = function(data) {\n\tlet id = data.sequenceId,\n\t\tshape = data.shape;\n\tif (id !== this.id) return;\n\tif (shape === undefined) {\n\t\tthis.nBeats = 4;\n\t\tthis.noteLength = 'quarter';\n\t\tthis.shape = shape;\n\t\tthis.stopSources();\n\t\treturn;\n\t}\n\tthis.shape = shape;\n\tswitch (shape.identity) {\n\t\tcase 'triangle':\n\t\t\tthis.nBeats = 4;\n\t\t\tthis.noteLength = 'eighthTriplet';\n\t\t\tbreak;\n\t\tcase 'rectangle':\n\t\t\tthis.nBeats = 4;\n\t\t\tthis.noteLength = 'quarter';\n\t\t\tbreak;\n\t\tcase 'circle':\n\t\t\tthis.nBeats = 4;\n\t\t\tthis.noteLength = 'sixteenth';\n\t\t\tbreak;\n\t\tcase 'line':\n\t\t\tthis.nBeats = 4;\n\t\t\tthis.noteLength = 'eighth';\n\t\t\tbreak;\n\t\tcase 'random':\n\t\t\tthis.nBeats = 4;\n\t\t\tthis.noteLength = 'sixteenthTriplet';\n\t\t\tbreak;\n\t}\n}\n\nSequence.prototype.cancelLoop = function() {\n\twindow.cancelAnimationFrame(this.animationFrameId);\n\tthis.stopSources();\n\tthis.isLooping = false;\n}\n\nSequence.prototype.stopSources = function() {\n\tfor (let i=0; i<this.sources.length; i++) {\n\t\ttry {\n\t\t\tthis.sources[i].stop(0);\n\t\t} catch (err) {\n\t\t\tconsole.warn('Could not stop playback.');\n\t\t}\n\t}\n}\n\nSequence.prototype.handleModeChange = function(data) {\n\tthis.mode = data;\n}\n\nSequence.prototype.handleCanvasResize = function(data) {\n\tlet width = data.canvasWidth,\n\t\theight = data.canvasHeight;\n\tif (width === 0 && height === 0) return;\n\tif (this.mode === 'ARRANGEMENT') return;\n\tthis.previousWidth = width;\n\tthis.previousHeight = height;\n}\n\nSequence.prototype.getPercentageCoordinates = function(points, width, height) {\n\tvar coords = [];\n\tfor (let i=0; i<points.length; i++) {\n\t\tlet x = bounder(points[i].x / width),\n\t\t\ty = bounder(points[i].y / height),\n\t\t\tind = points[i].index;\n\t\tcoords.push(new Point(x, y, ind));\n\t}\n\tfunction bounder(a) {\n\t\tif (a < 0) return 0;\n\t\tif (a > 1) return 1;\n\t\treturn a;\n\t}\n\treturn coords;\n}\n\nSequence.prototype.loop = function() {\n\tlet self = this,\n\t\tnewActiveSequenceTopic = eventBus.topicMap.newActiveSequence;\n\n\tthis.currentBeat = webAudio.getCurrentBeat();\n\tthis.shouldLoop = true;\n\tthis.loopIndex = 0;\n\n\t//\tmark that a new active sequence has begun\n\n\teventBus.publish(newActiveSequenceTopic, {\n\t\tsequenceId: this.id,\n\t\tsequenceSetId: this.sequenceSet.id\n\t});\n\n\tconst looper = () => {\n\n\t\tif (!self.shouldLoop) {\n\t\t\treturn;\n\t\t}\n\n\t\tself.isLooping = true;\n\n\t\tlet currentBeat = webAudio.getCurrentBeat(),\n\t\t\tnBeats = self.nBeats,\n\t\t\tloopIndex = self.loopIndex,\n\t\t\tfilename = self.filename,\n\t\t\tnoteLength = self.noteLength,\n\t\t\tshape = self.shape,\n\t\t\tpoints,\n\t\t\tradius,\n\t\t\tnewNotesReadyTopic = eventBus.topicMap.newNoteTimesReady;\n\n\t\tif (shape !== undefined) {\n\t\t\t// points = shape.vertices.copyPoints(shape.points)\n\t\t\tpoints = shape.points;\n\t\t\tif (shape.identity === 'rectangle') {\n\t\t\t\tpoints = [points[loopIndex]];\n\t\t\t} else if (shape.identity === 'circle') {\n\t\t\t\tlet pt = shape.center;\n\t\t\t\tpoints = shape.vertices.repPoint(pt, 4);\n\t\t\t\tradius = [{x: shape.radius, y: shape.radius}];\n\t\t\t} else if (shape.identity === 'random') {\n\t\t\t\tlet pt = shape.points[0];\n\t\t\t\tpoints = shape.vertices.repPoint(pt, 6)\n\t\t\t}\n\t\t}\n\n\t\t//\tunless we've reached the next beat, do not proceed\n\n\t\tif (currentBeat === self.currentBeat) {\n\t\t\tself.animationFrameId = window.requestAnimationFrame(looper);\n\t\t\treturn;\n\t\t}\n\n\t\t//\tOnly calculate properties if we're the active sequence\n\n\t\t// if (this.isActive) {\n\n\t\t// }\n\n\t\t//\totherwise, schedule the appropriate number of notes associated with the\n\t\t//\tcurrent beat, and return the scheduled note times\n\n\t\tlet width, height;\n\n\t\tif (shape !== undefined) {\n\t\t\tlet ratio = window.devicePixelRatio || 1;\n\t\t\tif (self.mode === 'INSTRUMENT') {\n\t\t\t\twidth = shape.canvas.width/ratio;\n\t\t\t\theight = shape.canvas.height/ratio;\n\t\t\t} else if (self.mode === 'ARRANGEMENT') {\n\t\t\t\twidth = self.previousWidth;\n\t\t\t\theight = self.previousHeight;\n\t\t\t}\n\t\t\tif (shape.identity === 'circle') {\n\t\t\t\tradius = self.getPercentageCoordinates(radius, width, height);\n\t\t\t}\n\t\t\tlet coordinates = self.getPercentageCoordinates(points, width, height),\n\t\t\t\tschedule = webAudio.schedulePlay(filename, {\n\t\t\t\t\tnoteLength, \n\t\t\t\t\tsequence:self, \n\t\t\t\t\tcoordinates,\n\t\t\t\t\tidentity: shape.identity,\n\t\t\t\t\tradius\n\t\t\t\t}),\n\t\t\t\tcurrentTime = webAudio.context.currentTime;\n\t\t\t//\tmark self new note times are available\n\t\t\teventBus.publish(newNotesReadyTopic, {\n\t\t\t\tsequenceId: self.id,\n\t\t\t\tsequenceIndex: self.index,\n\t\t\t\tsequenceSetId: self.sequenceSet.id,\n\t\t\t\tnoteTimes: schedule.noteTimes,\n\t\t\t\tnoteDuration: schedule.noteDuration,\n\t\t\t\tcurrentTime, \n\t\t\t\tloopIndex, \n\t\t\t\tshape,\n\t\t\t\tpoints,\n\t\t\t\tcoordinates,\n\t\t\t\tconstraint: self.constraint,\n\t\t\t\tfilename\n\t\t\t});\n\t\t}\n\n\t\tself.previousWidth = width;\n\t\tself.previousHeight = height;\n\n\t\t//\tmark the updated currentBeat\n\n\t\tself.currentBeat = currentBeat;\n\n\t\t//\tif we're on the last beat of the sequence,\n\t\t//\tquit out of the looping function, and alert the parent\n\t\t//\tself it should move to the next sequence\n\n\t\tif (loopIndex === nBeats-1) {\n\t\t\tself.isLooping = false;\n\t\t\teventBus.publish('endOfSequence', {}, self.sequenceSet.id);\n\t\t\treturn;\n\t\t}\n\n\t\t//\totherwise, proceed to the next beat\n\n\t\tself.loopIndex++;\n\n\t\tself.animationFrameId = window.requestAnimationFrame(looper);\n\t}\n\n\tlooper();\n}\n\nexport { Sequence };\n\n\n// WEBPACK FOOTER //\n// ./src/audio/sequence.js","import { eventBus } from '../eventbus.js';\nimport { webAudio } from './webaudio.js';\nimport { Util } from '../util.js';\nimport { Sequence } from './sequence.js';\n\nfunction SequenceSet(filename) {\n\tthis.filename = filename;\n\tthis.sequences = [];\n\tthis.hasEditedSequence = false;\n\tthis.editedSequenceIndex = undefined;\n\tthis.editedSequenceId = undefined;\n\tthis.activeSequenceIndex = undefined;\n\tthis.activeSequenceId = undefined;\n\tthis.id = Util.randId();\n\tthis.mode = undefined;\n\tthis.isLooping = false;\n\tthis.subscribe();\n}\n\nSequenceSet.prototype.constructor = SequenceSet;\n\nSequenceSet.prototype.subscribe = function() {\n\tlet topicNextSequence = eventBus.topicMap.endOfSequence,\n\t\ttopicModeChange = eventBus.topicMap.modeChange,\n\t\ttopicEditedSequence = eventBus.topicMap.newEditedSequence;\n\teventBus.subscribe(topicNextSequence, this.nextSequence.bind(this), this.id);\n\teventBus.subscribe(topicModeChange, this.changeMode.bind(this));\n\teventBus.subscribe(topicEditedSequence, this.handleNewEditedSequence.bind(this));\n}\n\nSequenceSet.prototype.resetLoopIndices = function() {\n\tfor (let i=0; i<this.sequences.length; i++) {\n\t\tif (this.sequences[i] !== undefined) {\n\t\t\tthis.sequences[i].loopIndex = 0;\n\t\t}\n\t}\n}\n\nSequenceSet.prototype.cancelLoop = function() {\n\tthis.isLooping = false;\n\tif (this.sequences.length === 0) return;\n\tthis.sequences[this.activeSequenceIndex].cancelLoop();\n}\n\nSequenceSet.prototype.forceCancelLoop = function() {\n\tthis.isLooping = false;\n\tlet N = this.sequences.length;\n\tif (N === 0 || N === 1) return;\n\tlet nonEditedSequences = this.getNonEditedSequences();\n\tnonEditedSequences.map(function(seq) {\n\t\tseq.cancelLoop();\n\t});\n}\n\nSequenceSet.prototype.forceCancelAllLoops = function() {\n\tthis.isLooping = false;\n\tfor (let i=0; i<this.sequences.length; i++) {\n\t\tthis.sequences[i].cancelLoop();\n\t}\n}\n\nSequenceSet.prototype.loop = function() {\n\tthis.isLooping = true;\n\tif (this.sequences.length === 0) return;\n\t//\tmake sure there aren't any queued loops\n\tlet loopingSequences = this.getLoopingSequences();\n\tif (loopingSequences.length !== 0) {\n\t\t// console.warn('More than 0 - loop');\n\t\treturn;\n\t}\n\tlet currentSequence = this.sequences[this.activeSequenceIndex];\n\tif (currentSequence === undefined) {\n\t\tthis.nextSequence();\n\t\treturn;\n\t}\n\tthis.activeSequenceId = currentSequence.id;\n\tcurrentSequence.loop();\n}\n\nSequenceSet.prototype.nextSequence = function() {\n\tif (this.mode === 'INSTRUMENT') {\n\t\tthis.loop();\n\t\treturn;\n\t}\n\tif (this.activeSequenceIndex === this.sequences.length-1) {\n\t\tthis.activeSequenceIndex = 0;\n\t} else {\n\t\tthis.activeSequenceIndex++;\n\t}\n\tthis.loop();\n}\n\nSequenceSet.prototype.switchToColumn = function(index) {\n\tlet shouldResumeLoop = this.isLooping,\n\t\tshouldCancelLoop = this.sequences.length > 1;\n\t\t// shouldCancelLoop = index !== this.activeSequenceIndex;\n\tif (shouldCancelLoop) {\n\t\tthis.forceCancelAllLoops();\n\t\tthis.activeSequenceIndex = index;\n\t}\n\tif (shouldResumeLoop) this.loop();\n}\n\nSequenceSet.prototype.handleNewEditedSequence = function(data) {\n\tif (data.sequenceSetId !== this.id) {\n\t\tthis.hasEditedSequence = false;\n\t\treturn;\n\t}\n\tlet definedSequences = this.sequences.filter(function(seq) {\n\t\treturn seq !== undefined;\n\t});\n\tthis.hasEditedSequence = true;\n\tlet sequenceId = data.sequenceId;\n\tthis.activeSequenceIndex = this.getIndexOfSequenceId(sequenceId);\n\tthis.editedSequenceIndex = this.activeSequenceIndex;\n\tthis.editedSequenceId = sequenceId;\n\tlet shouldResumeLoop = false;\n\tif (this.isLooping) {\n\t\tshouldResumeLoop = true;\n\t}\n\tif (definedSequences.length > 1) this.forceCancelLoop();\n\tif (shouldResumeLoop) this.loop();\n}\n\nSequenceSet.prototype.getSequenceIds = function() {\n\tlet ids = [];\n\tfor (let i=0; i<this.sequences.length; i++) {\n\t\tif (this.sequences[i] === undefined) {\n\t\t\tids.push(undefined);\n\t\t\tcontinue;\n\t\t}\n\t\tids.push(this.sequences[i].id);\n\t}\n\treturn ids;\n}\n\nSequenceSet.prototype.getNonEditedSequences = function() {\n\tlet self = this;\n\treturn this.sequences.filter(function(seq) {\n\t\treturn seq.id !== self.editedSequenceId;\n\t});\n}\n\nSequenceSet.prototype.getDefinedSequences = function() {\n\treturn this.sequences.filter(function(seq) {\n\t\treturn seq !== undefined;\n\t});\n}\nSequenceSet.prototype.getLoopingSequences = function() {\n\treturn this.sequences.filter(function(seq) {\n\t\treturn seq.isLooping;\n\t});\n}\n\nSequenceSet.prototype.getIndexOfSequenceId = function(id) {\n\tlet ids = this.getSequenceIds();\n\treturn Util.indexOf(ids, id);\n}\n\nSequenceSet.prototype.getSequenceById = function(id) {\n\treturn this.sequences[this.getIndexOfSequenceId(id)];\n}\n\nSequenceSet.prototype.changeMode = function(to) {\n\tthis.mode = to;\n}\n\nSequenceSet.prototype.createSequence = function(filename, index) {\n\tlet sequence = new Sequence(this, filename),\n\t\tsetId = this.id;\n\tif (index === undefined) {\n\t\tindex = this.sequences.length-1;\n\t}\n\tthis.sequences[index] = sequence;\n\tsequence.index = index;\n\tif (this.sequences.length === 1) {\n\t\tthis.activeSequenceIndex = index;\n\t\tthis.activeSequenceId = sequence.id;\n\t}\n\teventBus.publish(eventBus.topicMap.newSequenceCreated, {\n\t\tsequenceId: sequence.id,\n\t\tsequenceSetId: setId,\n\t\tsequenceIndex: index\n\t});\n}\n\nSequenceSet.prototype.deleteLastSequence = function() {\n\tlet wasLooping = this.isLooping;\n\tthis.forceCancelAllLoops();\n\tthis.sequences.splice(this.sequences.length-1, 1);\n\tthis.activeSequenceIndex = 0;\n\tthis.resetLoopIndices();\n\teventBus.publish(eventBus.topicMap.deletedColumn, {});\n\tif (wasLooping) this.loop();\n}\n\nexport { SequenceSet };\n\n\n// WEBPACK FOOTER //\n// ./src/audio/sequenceset.js","import { eventBus } from '../eventbus.js';\nimport { SequenceSet } from './sequenceset.js';\nimport { world } from '../world.js';\n\nfunction SequenceSets() {\n\tthis.sequenceSets = [];\n\tthis.sequenceSetIndex = 0;\n\tthis.editedSequenceId = undefined;\n\tthis.maxNColumns = 4;\n\tthis.isLooping = false;\n}\n\nSequenceSets.prototype.constructor = SequenceSets;\n\nSequenceSets.prototype.createSet = function(filename) {\n\tlet set = new SequenceSet(filename),\n\t\tnewSequenceSetTopicName = eventBus.topicMap.newSequenceSetCreated;\n\teventBus.publish(newSequenceSetTopicName, {sequenceSetId: set.id});\n\tthis.sequenceSets.push(set);\n\treturn set;\n}\n\nSequenceSets.prototype.loop = function() {\n\tif (this.isLooping) return;\n\tfor (let i=0; i<this.sequenceSets.length; i++) {\n\t\tthis.sequenceSets[i].loop();\n\t}\n\tthis.isLooping = true;\n}\n\nSequenceSets.prototype.cancelLoop = function() {\n\tif (!this.isLooping) return;\n\tfor (let i=0; i<this.sequenceSets.length; i++) {\n\t\tthis.sequenceSets[i].cancelLoop();\n\t}\n\tthis.isLooping = false;\n}\n\nSequenceSets.prototype.toggleLoop = function() {\n\tif (this.isLooping) {\n\t\tthis.cancelLoop();\n\t} else {\n\t\tthis.loop();\n\t}\n}\n\nSequenceSets.prototype._toggleSequences = function() {\n\tvar sequenceSetIds = this.sequenceSets.map(function(set) {\n\t\treturn set.id;\n\t});\n\tthis.sequenceSetIndex++;\n\tif (this.sequenceSetIndex > sequenceSetIds.length-1) {\n\t\tthis.sequenceSetIndex = 0;\n\t}\n\tlet currentId = sequenceSetIds[this.sequenceSetIndex];\n\teventBus.publish(eventBus.topicMap.newActiveSequenceSet, {\n\t\tsequenceSetId: currentId\n\t});\n}\n\nSequenceSets.prototype.getSequenceSetById = function(id) {\n\tfor (let i=0; i<this.sequenceSets.length; i++) {\n\t\tlet currentSet = this.sequenceSets[i];\n\t\tif (currentSet.id === id) return currentSet;\n\t}\n\treturn -1;\n}\n\nSequenceSets.prototype.sequenceExistsAtIndex = function(index) {\n\treturn this.sequenceSets.some(function(set) {\n\t\treturn set.sequences.length-1 === index;\n\t});\n}\n\nSequenceSets.prototype.createSequencesAtIndex = function(index) {\n\tfor (let i=0; i<this.sequenceSets.length; i++) {\n\t\tlet set = this.sequenceSets[i];\n\t\tset.createSequence(set.filename, index);\n\t}\n}\n\nSequenceSets.prototype.createNextColumn = function() {\n\tlet index = this.sequenceSets[0].sequences.length-1;\n\tindex++;\n\tthis.createSequencesAtIndex(index);\n}\n\nSequenceSets.prototype.sequenceExists = function(setId, index) {\n\tlet set = this.getSequenceSetById(setId);\n\tif (set.sequences[index] === undefined) return false;\n\treturn true;\n}\n\nSequenceSets.prototype.shapeExists = function(setId, index) {\n\tif (!this.sequenceExists(setId, index)) return false;\n\tlet set = this.getSequenceSetById(setId);\n\tif (set.sequences[index].shape === undefined) return false;\n\treturn true;\n}\n\nSequenceSets.prototype.allShapesExist = function(index) {\n\tfor (let i=0; i<this.sequenceSets.length; i++) {\n\t\tlet set = this.sequenceSets[i],\n\t\t\tsetId = set.id;\n\t\tif (!this.shapeExists(setId, index)) return false;\n\t}\n\treturn true;\n}\n\nSequenceSets.prototype.handleClickedSequence = function(setId, index, store) {\n\tlet set = this.getSequenceSetById(setId);\n\tif (!this.sequenceExists(setId, index)) {\n\t\tset.createSequence(set.filename, index);\n\t}\n\tthis.markActiveSet(setId);\n\tlet sequenceId = set.sequences[index].id;\n\tthis.markEditedSequence(setId, sequenceId);\n\tfor (let i=0; i<this.sequenceSets.length; i++) {\n\t\tthis.sequenceSets[i].switchToColumn(index);\n\t}\n\tthis.editedSequenceId = setId;\n}\n\nSequenceSets.prototype.markActiveSet = function(id) {\n\tlet newActiveSetTopic = eventBus.topicMap.newActiveSequenceSet;\n\teventBus.publish(newActiveSetTopic, {sequenceSetId: id});\n}\n\nSequenceSets.prototype.markEditedSequence = function(sequenceSetId, sequenceId) {\n\tlet newEditedSequenceTopic = eventBus.topicMap.newEditedSequence,\n\t\tsequence = this.getSequenceSetById(sequenceSetId)\n\t\t\t.getSequenceById(sequenceId);\n\teventBus.publish(newEditedSequenceTopic, {\n\t\tsequenceSetId,\n\t\tsequenceId,\n\t\tsequence\n\t});\n}\n\nSequenceSets.prototype.getEditedSequence = function() {\n\tlet set = this.getSequenceSetById(world.activeSequenceSetId);\n\treturn set.getSequenceById(world.editedSequenceId);\n}\n\nSequenceSets.prototype.updateFilename = function(filename) {\n\tlet sequence = this.getEditedSequence();\n\tsequence.filename = filename;\n}\n\nSequenceSets.prototype.updateConstraint = function(constraint) {\n\tlet sequence = this.getEditedSequence();\n\tsequence.constraint = constraint;\n}\n\nSequenceSets.prototype.canAddMoreColumns = function() {\n\tif (this.sequenceSets[0].sequences.length === this.maxNColumns) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\nSequenceSets.prototype.deleteLastColumn = function() {\n\tfor (let i=0; i<this.sequenceSets.length; i++) {\n\t\tthis.sequenceSets[i].deleteLastSequence();\n\t}\n}\n\nexport { SequenceSets };\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/audio/sequencesets.js","import { Vertices, Point } from './vertices.js';\nimport { Shape, Line, Circle } from './shape.js';\nimport { Util } from '../util.js';\n\nfunction Detector(vertices) {\n\tthis.vertices = vertices;\n\tthis.criteria = {\n\t\trectangle: {\n\t\t\taxisRatioThreshold: .5\n\t\t},\n\t\tcircle: {\n\t\t\tglobalThreshold: .5\n\t\t},\n\t\ttriangle: {\n\t\t\tglobalThreshold: 10\n\t\t},\n\t\tline: {\n\t\t\tdistanceThreshold: .4,\n\t\t\tperpDistanceThreshold: .05\n\t\t},\n\t\trandom: {\n\t\t\tglobalThreshold: .5\n\t\t}\n\t}\n\tthis.estimatedVertices = {\n\t\trectangle: [],\n\t\tcircle: [],\n\t\ttriangle: [],\n\t\tline: []\n\t}\n\tthis.identity = undefined;\n}\n\nDetector.prototype.constructor = Detector;\n\n/*\n\tUPDATE ESTIMATED VERTICES\n*/\n\nDetector.prototype.updateEstimatedVertices = function() {\n\tthis.estimatedVertices.rectangle = this.getEstimatedRectVertices();\n\tthis.estimatedVertices.triangle = this.getEstimatedTriangleVertices();\n\tthis.estimatedVertices.circle = this.getEstimatedCircleVertices();\n\tthis.estimatedVertices.line = this.getEstimatedLineVertices();\n}\n\n/*\n\tESTIMATE VERTICES\n*/\n\n\nDetector.prototype.getEstimatedTriangleVertices = function() {\n\tvar verts = this.vertices.hull,\n\t\tpoints = verts.points,\n\t\tinds = [];\n\tfor (var i=0; i<points.length; i++) inds.push(i);\n\tvar area = -Infinity,\n\t\tlargestSet;\n\tinds = Util.combs(inds, 3);\n\tfor (var i=0; i<inds.length; i++) {\n\t\tvar set = inds[i],\n\t\t\tA = points[set[0]],\n\t\t\tB = points[set[1]],\n\t\t\tC = points[set[2]],\n\t\t\ttri = [A, B, C],\n\t\t\tcurrentArea = Math.abs(verts.getArea(tri));\n\t\tif (currentArea > area) {\n\t\t\tlargestSet = [A, B, C];\n\t\t\tarea = currentArea;\n\t\t}\n\t}\n\treturn largestSet\n}\n\nDetector.prototype.getEstimatedRectVertices = function() {\n\n\tvar verts = \t\tthis.vertices.hull,\n\t\tpoints = \t\tverts.points,\n\t\tcentroid = \t\tverts.centroid,\n\t\ttopLeftPts = \tpoints.filter(topLeftFunc),\n\t\ttopRightPts = \tpoints.filter(topRightFunc),\n\t\tbtmLeftPts = \tpoints.filter(btmLeftFunc),\n\t\tbtmRightPts = \tpoints.filter(btmRightFunc),\n\t\tnTopLeft = \t\ttopLeftPts.length,\n\t\tnTopRight = \ttopRightPts.length,\n\t\tnBtmLeft = \t\tbtmLeftPts.length,\n\t\tnBtmRight = \tbtmRightPts.length;\n\n\tif (nTopLeft === 0 || nTopRight === 0 \n\t\t|| nBtmLeft === 0 || nBtmRight === 0) {\n\t\treturn [];\n\t}\n\n\tvar topLeftDistances = \tverts.getDistances(centroid, topLeftPts),\n\t\ttopRightDistances = verts.getDistances(centroid, topRightPts),\n\t\tbtmLeftDistances = \tverts.getDistances(centroid, btmLeftPts),\n\t\tbtmRightDistances = verts.getDistances(centroid, btmRightPts);\n\n\tvar topLeftInd = \tUtil.findMax(topLeftDistances),\n\t\ttopRightInd = \tUtil.findMax(topRightDistances),\n\t\tbtmLeftInd = \tUtil.findMax(btmLeftDistances),\n\t\tbtmRightInd = \tUtil.findMax(btmRightDistances);\n\n\tvar topLeftPt = \ttopLeftPts[topLeftInd],\n\t\ttopRightPt = \ttopRightPts[topRightInd],\n\t\tbtmLeftPt = \tbtmLeftPts[btmLeftInd],\n\t\tbtmRightPt = \tbtmRightPts[btmRightInd];\n\n\treturn [topLeftPt, topRightPt, btmLeftPt, btmRightPt];\n\n\tfunction topLeftFunc(pt) { return pt.x < centroid.x && pt.y > centroid.y; }\n\tfunction topRightFunc(pt) { return pt.x > centroid.x && pt.y > centroid.y; }\n\tfunction btmLeftFunc(pt) { return pt.x < centroid.x && pt.y < centroid.y; }\n\tfunction btmRightFunc(pt) { return pt.x > centroid.x && pt.y < centroid.y; }\n}\n\nDetector.prototype.getEstimatedCircleVertices = function() {\n\tvar verts = this.vertices,\n\t\tpoints = verts.hull.points,\n\t\tcentroid = verts.hull.centroid,\n\t\tdistances = verts.getDistances(centroid, points),\n\t\tsummed = Util.sum(distances),\n\t\tN = distances.length,\n\t\tmean = summed/N;\n\n\tvar radius = new Point(centroid.x, centroid.y+mean, 0);\n\n\treturn [centroid, radius];\n}\n\nDetector.prototype.getEstimatedLineVertices = function() {\n\tvar N = this.vertices.points.length;\n\treturn [this.vertices.points[0], this.vertices.points[N-1]];\n}\n\n/*\n\tASSESS SHAPE LIKELIHOOD\n*/\n\nDetector.prototype.getLikelihoodRect = function() {\n\tvar rectVertices = this.estimatedVertices.rectangle;\n\n\tif (rectVertices.length === 0) return 0;\n\n\tvar hull = \t\t\tthis.vertices.hull,\n\t\ttopLeftPt = \trectVertices[0],\n\t\ttopRightPt = \trectVertices[1],\n\t\tbtmLeftPt = \trectVertices[2],\n\t\tbtmRightPt = \trectVertices[3],\n\t\tcentroid = \t\thull.centroid;\n\n\tvar axis1Ratio = getSlopeRatio(topLeftPt, btmRightPt, centroid),\n\t\taxis2Ratio = getSlopeRatio(btmLeftPt, topRightPt, centroid),\n\t\tthreshold = this.criteria.rectangle.axisRatioThreshold;\n\n\treturn Math.max(axis1Ratio, axis2Ratio);\n\n\tfunction getSlopeRatio(p0, p1, centroid) {\n\t\tvar slopeA = hull.getSlope(p0, centroid),\n\t\t\tslopeB = hull.getSlope(p1, centroid),\n\t\t\tslopeAB = hull.getSlope(p0, p1),\n\t\t\tratio = (slopeA/slopeAB) * (slopeB/slopeAB);\n\t\treturn ratio;\n\t}\n}\n\nDetector.prototype.getLikelihoodCircle = function() {\n\tvar verts = this.vertices,\n\t\thull = verts.hull,\n\t\tvertPoints = verts.points,\n\t\thullPoints = hull.points,\n\t\tnSamples = vertPoints.length,\n\t\tnHull = hullPoints.length,\n\t\tnRatio = nHull / nSamples,\n\t\trealArea = verts.area,\n\t\thullArea = hull.area,\n\t\tareaRatio = realArea / hullArea,\n\t\tperimEfficiency = verts.perimeterEfficiency,\n\t\tconfidence = perimEfficiency * nRatio * areaRatio;\n\n\treturn confidence;\n}\n\nDetector.prototype.getLikelihoodTriangle = function() {\n\tvar triangleVertices = this.estimatedVertices.triangle,\n\t\tarea = this.vertices.hull.area;\n\tif (triangleVertices === undefined) return Infinity;\n\treturn area / Math.abs(this.vertices.getArea(triangleVertices));\n}\n\nDetector.prototype.getLikelihoodLine = function() {\n\tvar verts = this.vertices,\n\t\tpoints = verts.points,\n\t\tpFirst = points[0],\n\t\tpLast = points[points.length-1],\n\t\tperpDistanceRatios = [],\n\t\tdistances = [],\n\t\tlastDistance = verts.getDistance(pFirst, pLast),\n\t\tpDistance;\n\tfor (var i=1; i<points.length-2; i++) {\n\t\tpDistance = verts.getPerpendicularDistance(points[i], pFirst, pLast);\n\t\tperpDistanceRatios.push(pDistance/lastDistance);\n\t}\n\tfor (var i=0; i<points.length-2; i++) {\n\t\tdistances.push(verts.getDistance(points[i], points[i+1]));\n\t}\n\tvar summed = Util.sum(distances),\n\t\tdistRatio = lastDistance / summed,\n\t\tmaxPerpRatio = Math.max(...perpDistanceRatios);\n\n\treturn {\n\t\tdistanceRatio: distRatio,\n\t\tperpDistanceRatio: maxPerpRatio\n\t}\n}\n\nDetector.prototype.getLikelihoodRandom = function() {\n\treturn this.vertices.perimeterEfficiency;\n}\n\n/*\n\tASSIGN SHAPE IDENTITY\n*/\n\nDetector.prototype.isRectangle = function() {\n\tvar estimate = this.getLikelihoodRect(),\n\t\tthresh = this.criteria.rectangle.axisRatioThreshold;\n\treturn Math.abs(estimate - 1) < thresh;\n}\n\nDetector.prototype.isCircle = function() {\n\tvar estimate = this.getLikelihoodCircle(),\n\t\tthresh = this.criteria.circle.globalThreshold;\n\treturn estimate > thresh;\n}\n\nDetector.prototype.isTriangle = function() {\n\tvar estimate = this.getLikelihoodTriangle(),\n\t\tthresh = this.criteria.triangle.globalThreshold;\n\treturn estimate < thresh;\n}\n\nDetector.prototype.isLine = function() {\n\tvar estimates = this.getLikelihoodLine(),\n\t\tdistanceRatio = estimates.distanceRatio,\n\t\tperpRatio = estimates.perpDistanceRatio,\n\t\tdistanceThresh = this.criteria.line.distanceThreshold,\n\t\tperpDistanceThresh = this.criteria.line.perpDistanceThreshold;\n\n\treturn distanceRatio-1 < distanceThresh && perpRatio < perpDistanceThresh;\n}\n\nDetector.prototype.isRandom = function() {\n\tvar estimate = this.getLikelihoodRandom(),\n\t\tthresh = this.criteria.random.globalThreshold;\n\n\treturn estimate < thresh;\n}\n\n/*\n\tMODIFY VERTICES\n*/\n\nDetector.prototype.getAdjustedRectVertices = function() {\n\tvar rectPoints = this.estimatedVertices.rectangle,\n\t\trectVerts = new Vertices(rectPoints),\n\t\tpoints = rectVerts._sortPointsByPolarAngle();\n\tpoints.unshift(rectVerts.anchorPoint);\n\trectVerts.points = points;\n\trectVerts.updateAllExceptHull();\n\tpoints.push(points[0]);\n\tvar distances = rectVerts.getConsecutiveDistances(points),\n\t\tL = Util.mean(distances),\n\t\t// LA = Util.mean([distances[0], distances[2]]),\n\t\t// LB = Util.mean([distances[1], distances[3]]),\n\t\tcentroid = rectVerts.centroid,\n\t\tmidPoint = new Point(L/2, L/2, 0),\n\t\tA = centroid.copy(),\n\t\tB = centroid.copy(),\n\t\tC = centroid.copy(),\n\t\tD = centroid.copy();\n\n\tA.minus(midPoint);\n\tB.x -= midPoint.x;\n\tB.y += midPoint.y;\n\tC.plus(midPoint);\n\tD.x += midPoint.x;\n\tD.y -= midPoint.y;\n\n\tvar recombinedVerts = new Vertices([A, B, C, D]);\n\trecombinedVerts.updateAll();\n\treturn recombinedVerts;\n}\n\nDetector.prototype.getAdjustedTriangleVertices = function() {\n\tvar verts = this.vertices,\n\t\ttriPoints = this.estimatedVertices.triangle,\n\t\tcentroid = verts.hull.centroid,\n\t\tdistances = verts.getDistances(centroid, triPoints),\n\t\tmeanDist = Util.mean(distances) * .9,\n\t\tnewVerts = [];\n\n\tfor (var i=0; i<3; i++) {\n\t\tvar center = centroid.copy();\n\t\tif (i === 0) {\n\t\t\tcenter.y -= meanDist;\n\t\t} else if (i === 1) {\n\t\t\tcenter.y += meanDist;\n\t\t\tcenter.x -= meanDist;\n\t\t} else {\n\t\t\tcenter.y += meanDist;\n\t\t\tcenter.x += meanDist;\n\t\t}\n\t\tnewVerts.push(center);\n\t}\n\tvar vertices = new Vertices(newVerts);\n\tvertices.updateAll();\n\treturn vertices;\n}\n\n/*\n\tGET DETECTED SHAPE\n*/\n\nDetector.prototype.getLine = function() {\n\treturn new Line(this.vertices);\n}\n\nDetector.prototype.getRectangle = function() {\n\tvar verts = this.getAdjustedRectVertices();\n\treturn new Shape(verts, 'rectangle');\n}\n\nDetector.prototype.getTriangle = function() {\n\tvar verts = this.getAdjustedTriangleVertices();\n\treturn new Shape(verts, 'triangle');\n}\n\nDetector.prototype.getCircle = function() {\n\tvar verts = this.vertices,\n\t\testimatedVertices = this.estimatedVertices.circle,\n\t\tcenter = estimatedVertices[0],\n\t\tradius = estimatedVertices[1].y - center.y;\n\treturn new Circle(verts, center, radius);\n}\n\nDetector.prototype.getRandom = function() {\n\tlet N = this.vertices.points.length-1;\n\tthis.vertices.points = [this.vertices.points[N]];\n\tthis.vertices.updateAllExceptHull();\n\treturn new Shape(this.vertices, 'random');\n}\n\nDetector.prototype.getDetectedShape = function() {\n\tswitch (this.identity) {\n\t\tcase 'line':\n\t\t\treturn this.getLine();\n\t\tcase 'rectangle':\n\t\t\treturn this.getRectangle();\n\t\tcase 'circle':\n\t\t\treturn this.getCircle();\n\t\tcase 'triangle':\n\t\t\treturn this.getTriangle();\n\t\tcase 'random':\n\t\t\treturn this.getRandom();\n\t\tdefault:\n\t\t\treturn this.getRandom();\n\t}\n}\n\n/*\n\tIDENTIFY\n*/\n\nDetector.prototype.identify = function() {\n\tvar isRectangle = this.isRectangle(),\n\t\tisCircle = this.isCircle(),\n\t\tisTriangle = this.isTriangle(),\n\t\tisLine = this.isLine(),\n\t\tisRandom = this.isRandom(),\n\t\tidentity;\n\n\tif (isLine) {\n\t\tidentity = 'line';\n\t} else if (isRandom) {\n\t\tidentity = 'random';\n\t} else if (isCircle) {\n\t\tidentity = 'circle';\n\t} else if (isRectangle) {\n\t\tidentity = 'rectangle';\n\t} else if (isTriangle) {\n\t\tidentity = 'triangle';\n\t} else {\n\t\tidentity = undefined;\n\t}\n\n\tthis.identity = identity;\n}\n\nexport { Detector };\n\n\n\n// WEBPACK FOOTER //\n// ./src/geometry/detector.js","import { Util } from './util.js';\nimport { Detector } from './geometry/detector.js';\nimport { Shape, Line, Circle } from './geometry/shape.js';\nimport { Vertices, Point } from './geometry/vertices.js';\nimport { eventBus } from './eventbus.js';\nimport { webAudio } from './audio/webaudio.js';\nimport interact from 'interact.js';\n\nfunction Interaction(world, animator) {\n\tthis.world = world;\n\tthis.animator = animator;\n}\n\nInteraction.prototype.constructor = Interaction;\n\nInteraction.prototype.handleTouch = function() {\n\n\tvar self = this,\t\n\t\tposition,\n\t\tstroke = [],\n\t\tshouldContinue = true,\n\t\tshape,\n\t\tvertex,\n\t\tanimator = this.animator,\n\t\telement = animator.instrumentCanvas,\n\t\tsequenceIdCurrent,\n\t\tsequenceIdOnDown,\n\t\tbounds = animator.style.editedVertices.size;\n\n\tanimator.isRecording = false;\n\n\tinteract(element)\n\t\t.on('down', down)\n\t\t.on('up', up)\n\t\t.on('move', move);\n\n\tfunction move(e) {\n\t\te.preventDefault();\n\t\tposition = correctPosition({x: e.clientX, y: e.clientY});\n\t}\n\tfunction down(e) {\n\t\te.preventDefault();\n\t\tshouldContinue = true;\n\t\twebAudio.playDummySound();\n\t\tposition = correctPosition({x: e.clientX, y: e.clientY});\n\t\tshape = self.world.getEditedShape();\n\t\tsequenceIdOnDown = self.world.editedSequenceId;\n\t\tsequenceIdCurrent = sequenceIdOnDown;\n\t\t//\twe're making a new shape\n\t\tif (shape === undefined) {\n\t\t\tanimator.isRecording = true;\n\t\t\trequestAnimationFrame(record);\n\t\t\treturn;\n\t\t}\n\t\tvar nearbyVertices = shape.getVerticesNear(position, bounds),\n\t\t\tisNearCenter = shape.isNearCenter(position, bounds);\n\t\tif (nearbyVertices.length === 0 && !isNearCenter) {\n\t\t\tself.publishNewShape(undefined);\n\t\t\tanimator.isRecording = true;\n\t\t\trequestAnimationFrame(record);\n\t\t\treturn;\n\t\t}\n\t\tanimator.isRecording = false;\n\t\tif (nearbyVertices.length > 0) {\n\t\t\tvertex = nearbyVertices[0];\n\t\t\trequestAnimationFrame(modifyVertex);\n\t\t} else {\n\t\t\trequestAnimationFrame(modifyCenter);\n\t\t}\n\t}\n\tfunction updateCurrentSequenceId() {\n\t\tsequenceIdCurrent = self.world.editedSequenceId;\n\t}\n\tfunction correctPosition(pos) {\n\t\tlet rect = self.animator.instrumentCanvas.getBoundingClientRect(),\n\t\t\twidth = self.animator.instrumentCanvas.width,\n\t\t\theight = self.animator.instrumentCanvas.height,\n\t\t\tratio = self.animator.ratio,\n\t\t\tx = Math.round((pos.x-rect.left)/(rect.right-rect.left)*width/ratio),\n\t\t\ty = Math.round((pos.y-rect.top)/(rect.bottom-rect.top)*height/ratio);\n\t\treturn {x, y};\n\t}\n\tfunction convertToFractionalCoordinates(pos) {\n\t\tlet rect = self.animator.instrumentCanvas.getBoundingClientRect(),\n\t\t\tpercX = (pos.x - rect.left),\n\t\t\tpercY = (pos.y - rect.top);\n\t\treturn {x: percX, y: percY};\n\t}\n\tfunction up() {\n\t\tshouldContinue = false;\n\t\tupdateCurrentSequenceId();\n\t\tif (!animator.isRecording) return;\n\t\tif (sequenceIdCurrent !== sequenceIdOnDown) return;\n\t\tanimator.isRecording = false;\n\t\tself.handleNewStroke(stroke);\n\t\tstroke = [];\n\t\tanimator.stroke = [];\n\t}\n\tfunction record() {\n\t\tupdateCurrentSequenceId();\n\t\tif (!shouldContinue) return;\n\t\tif (sequenceIdCurrent !== sequenceIdOnDown) return;\n\t\tstroke.push(position);\n\t\tanimator.stroke = stroke;\n\t\trequestAnimationFrame(record);\n\t}\n\tfunction modifyVertex() {\n\t\tupdateCurrentSequenceId();\n\t\tif (!shouldContinue) return;\n\t\tif (sequenceIdCurrent !== sequenceIdOnDown) return;\n\t\tvertex.x = Math.round(position.x);\n\t\tvertex.y = Math.round(position.y);\n\t\tshape.update();\t\t\t\n\t\trequestAnimationFrame(modifyVertex);\n\t}\n\tfunction modifyCenter() {\n\t\tupdateCurrentSequenceId();\n\t\tif (!shouldContinue) return;\n\t\tif (sequenceIdCurrent !== sequenceIdOnDown) return;\n\t\tvar pt = new Point(position.x, position.y, 0);\n\t\tshape.centerOn(pt);\n\t\tshape.update();\n\t\trequestAnimationFrame(modifyCenter);\n\t}\n}\n\nInteraction.prototype.publishNewShape = function(shape) {\n\tlet sequenceId = this.world.editedSequenceId,\n\t\tsequenceSetId = this.world.activeSequenceSetId,\n\t\tnewShapeTopic = eventBus.topicMap.newShapeReady;\n\teventBus.publish(newShapeTopic, {shape, sequenceId, sequenceSetId});\n}\n\nInteraction.prototype.handleNewStroke = function(stroke) {\n\tstroke = Util.unique(Util.resample(stroke, 256));\n\tif (stroke[0] === undefined) {\n\t\tconsole.warn('No shape will be constructed.');\n\t\treturn;\n\t}\n\tlet verts = new Vertices(stroke);\n\tverts.updateAll();\n\tlet detector = new Detector(verts);\n\tdetector.updateEstimatedVertices();\n\tdetector.identify();\n\tlet shape = detector.getDetectedShape();\n\tshape.canvas = this.animator.instrumentCanvas;\n\tthis.publishNewShape(shape);\n}\n\nexport { Interaction };\n\n\n// WEBPACK FOOTER //\n// ./src/interaction.js","import Vue from 'vue'\nimport Vuex from 'vuex'\nimport App from './App'\nimport router from './router'\nimport { eventBus } from './eventbus.js';\nimport { webAudio } from './audio/webaudio.js';\nimport './interface/setup.js';\nimport { sequenceSetManager } from './audio/setup.js';\n\nVue.use(Vuex);\n\nlet startingMode = 'ARRANGEMENT';\n\nconst store = new Vuex.Store({\n\tstate: {\n\t\tsequenceSetManager,\n\t\tmode: startingMode,\n\t\tsoundsAreLoaded: false,\n\t\teditedSequence: undefined,\n\t\tcanAddColumn: false,\n\t\tdidShowPlus: false,\n\t\tcanDeleteColumn: false\n\t},\n\tmutations: {\n\t\tswitchMode(state, to) {\n\t\t\tif (to !== 'ARRANGEMENT' && to !== 'INSTRUMENT') {\n\t\t\t\tthrow new Error(`Unrecognized view mode ${to}`)\n\t\t\t}\n\t\t\tstate.mode = to;\n\t\t\teventBus.publish('modeChange', to);\n\t\t},\n\t\tmarkSoundsAreLoaded(state, to) { state.soundsAreLoaded = to },\n\t\tupdateDidShowPlus(state, to) { state.didShowPlus = to; },\n\t\tupdateColumnAdding(state, to) { state.canAddColumn = to; },\n\t\tupdateColumnDelete(state, to) { state.canDeleteColumn = to; },\n\t\tupdatedEditedSequence(state, to) { state.editedSequence = to; }\n\t}\n});\n\nstore.commit('switchMode', startingMode);\n\nsequenceSetManager.loop();\n\nwindow.addEventListener('keydown', function(evt) {\n\tif (evt.keyCode === 32) sequenceSetManager.toggleLoop();\n});\n\nwebAudio.loadSounds()\n\t.then(function() {\n\t\tstore.commit('markSoundsAreLoaded', true);\n\t});\n\nVue.config.productionTip = false\n\n/* eslint-disable no-new */\nnew Vue({\n\tel: '#app',\n\tstore,\n\trouter,\n\ttemplate: '<App/>',\n\tcomponents: { App }\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0a587290\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Arrangement.vue\")\n  require(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0a587290\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=1!./Arrangement.vue\")\n}\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Arrangement.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0a587290\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Arrangement.vue\"),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-0a587290\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Arrangement.vue\n// module id = 118\n// module chunks = 1","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6f30bcb8\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Cell.vue\")\n  require(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6f30bcb8\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=1!./Cell.vue\")\n}\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Cell.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6f30bcb8\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Cell.vue\"),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-6f30bcb8\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Cell.vue\n// module id = 119\n// module chunks = 1","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2d560100\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Hello.vue\")\n}\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Hello.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2d560100\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Hello.vue\"),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-2d560100\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Hello.vue\n// module id = 120\n// module chunks = 1","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-a9caebae\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Instrument.vue\")\n  require(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-a9caebae\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=1!./Instrument.vue\")\n}\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Instrument.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-a9caebae\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Instrument.vue\"),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-a9caebae\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Instrument.vue\n// module id = 121\n// module chunks = 1","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-f5b7d302\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Sequencer.vue\")\n}\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Sequencer.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-f5b7d302\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Sequencer.vue\"),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  null,\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Sequencer.vue\n// module id = 122\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"container\",\n    style: (_vm.getContainerStyle())\n  }, [(_vm.canAddColumn() || _vm.canDeleteColumn()) ? _c('div', {\n    staticClass: \"row interface\"\n  }, [(_vm.canDeleteColumn()) ? _c('div', {\n    staticClass: \"cell minusCircle\",\n    on: {\n      \"click\": function($event) {\n        _vm.deleteColumn()\n      }\n    }\n  }, [_c('div', {\n    staticClass: \"bar horizontalpx\"\n  })]) : _vm._e(), _vm._v(\" \"), (_vm.canAddColumn()) ? _c('div', {\n    staticClass: \"cell plusCircle\",\n    on: {\n      \"click\": function($event) {\n        _vm.createColumn()\n      }\n    }\n  }, [_c('div', {\n    staticClass: \"bar horizontalpx\"\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"bar verticalpx\"\n  })]) : _vm._e()]) : _vm._e(), _vm._v(\" \"), _vm._l((_vm.sequenceSets), function(set) {\n    return _c('div', {\n      staticClass: \"row interface\"\n    }, _vm._l((set.sequences.length), function(n) {\n      return _c('cell', {\n        key: set.sequences[n - 1].id,\n        attrs: {\n          \"index\": n - 1,\n          \"sequenceId\": set.sequences[n - 1].id,\n          \"sequenceSetId\": set.id\n        }\n      })\n    }))\n  })], 2)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-0a587290\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Arrangement.vue\n// module id = 123\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"hello\"\n  }, [_c('h1', [_vm._v(_vm._s(_vm.msg))]), _vm._v(\" \"), _c('h2', [_vm._v(\"Essential Links\")]), _vm._v(\" \"), _vm._m(0), _vm._v(\" \"), _c('h2', [_vm._v(\"Ecosystem\")]), _vm._v(\" \"), _vm._m(1)])\n},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('ul', [_c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://vuejs.org\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Core Docs\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://forum.vuejs.org\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Forum\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://gitter.im/vuejs/vue\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Gitter Chat\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://twitter.com/vuejs\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Twitter\")])]), _vm._v(\" \"), _c('br'), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://vuejs-templates.github.io/webpack/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Docs for This Template\")])])])\n},function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('ul', [_c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://router.vuejs.org/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"vue-router\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://vuex.vuejs.org/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"vuex\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://vue-loader.vuejs.org/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"vue-loader\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://github.com/vuejs/awesome-vue\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"awesome-vue\")])])])\n}]}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-2d560100\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Hello.vue\n// module id = 124\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"cell\"\n  }, [_c('div', {\n    class: _vm.cellClass,\n    on: {\n      \"click\": function($event) {\n        _vm.switchToSequence()\n      }\n    }\n  }, [_c('canvas', {\n    staticClass: \"instrument__canvas\"\n  })])])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-6f30bcb8\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Cell.vue\n// module id = 125\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"instrument\"\n  }, [_c('div', {\n    staticClass: \"row interface\"\n  }, [_c('div', {\n    staticClass: \"cell\"\n  }, [_c('div', {\n    staticClass: \"circle circle--active\",\n    on: {\n      \"click\": function($event) {\n        _vm.switchToArrangement()\n      }\n    }\n  })]), _vm._v(\" \"), _vm._l((_vm.constraints), function(pattern) {\n    return _c('div', {\n      staticClass: \"cell\"\n    }, [_c('div', {\n      class: _vm.getConstraintClass(pattern),\n      style: (_vm.getConstraintStyle(pattern)),\n      on: {\n        \"click\": function($event) {\n          _vm.updateConstraint(pattern)\n        }\n      }\n    })])\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"cell\"\n  }, [_c('div', {\n    staticClass: \"circle circle--active transportControl\",\n    on: {\n      \"click\": function($event) {\n        _vm.toggleLoop()\n      }\n    }\n  }, [_c('div', {\n    class: _vm.getTransportClass()\n  })])])], 2), _vm._v(\" \"), _c('canvas', {\n    directives: [{\n      name: \"capture-canvas\",\n      rawName: \"v-capture-canvas\",\n      value: ({\n        type: 'INSTRUMENT'\n      }),\n      expression: \"{type: 'INSTRUMENT'}\"\n    }],\n    staticClass: \"instrument__canvas\"\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"row interface\"\n  }, [_c('div', {\n    staticClass: \"cell\"\n  }, [_c('div', {\n    staticClass: \"instrument-cell\",\n    on: {\n      \"click\": function($event) {\n        _vm.clearShape()\n      }\n    }\n  })]), _vm._v(\" \"), _vm._l((_vm.filenames), function(f) {\n    return _c('div', {\n      staticClass: \"cell\"\n    }, [_c('div', {\n      staticClass: \"instrument-cell\",\n      on: {\n        \"click\": function($event) {\n          _vm.updateFilename(f)\n        }\n      }\n    }, [_c('div', {\n      class: _vm.getInstrumentClassNames(f),\n      style: (_vm.getInstrumentStyle(f))\n    })])])\n  })], 2)])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-a9caebae\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Instrument.vue\n// module id = 126\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"app\"\n    }\n  }, [(_vm.soundsAreLoaded()) ? _c('sequencer') : _c('div', [_vm._v(\"\\n\\t\\tLoading ...\\n\\t\")])], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-bd26cd6c\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = 127\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"sequencer\"\n    }\n  }, [_c('instrument', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.modeIsInstrument),\n      expression: \"modeIsInstrument\"\n    }]\n  }), _vm._v(\" \"), _c('arrangement', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (!_vm.modeIsInstrument),\n      expression: \"!modeIsInstrument\"\n    }]\n  })], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-f5b7d302\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Sequencer.vue\n// module id = 128\n// module chunks = 1"],"sourceRoot":""}